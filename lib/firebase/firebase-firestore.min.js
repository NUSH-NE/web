!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(og){"use strict";try{!function(){var l,t,e=(t=og)&&"object"==typeof t&&"default"in t?t:{default:t};function s(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function n(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var i=(new Date).toISOString(),o=u[e];if(!o)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[o].apply(console,s(["["+i+"]  "+t.name+":"],n))}}(ge=l=l||{})[ge.DEBUG=0]="DEBUG",ge[ge.VERBOSE=1]="VERBOSE",ge[ge.INFO=2]="INFO",ge[ge.WARN=3]="WARN",ge[ge.ERROR=4]="ERROR",ge[ge.SILENT=5]="SILENT";var r={debug:l.DEBUG,verbose:l.VERBOSE,info:l.INFO,warn:l.WARN,error:l.ERROR,silent:l.SILENT},i=l.INFO,u=((me={})[l.DEBUG]="log",me[l.VERBOSE]="log",me[l.INFO]="info",me[l.WARN]="warn",me[l.ERROR]="error",me),o=(Object.defineProperty(a.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in l))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),a.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?r[t]:t},Object.defineProperty(a.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),a.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.DEBUG],t)),this._logHandler.apply(this,s([this,l.DEBUG],t))},a.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.VERBOSE],t)),this._logHandler.apply(this,s([this,l.VERBOSE],t))},a.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.INFO],t)),this._logHandler.apply(this,s([this,l.INFO],t))},a.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.WARN],t)),this._logHandler.apply(this,s([this,l.WARN],t))},a.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._userLogHandler&&this._userLogHandler.apply(this,s([this,l.ERROR],t)),this._logHandler.apply(this,s([this,l.ERROR],t))},a);function a(t){this.name=t,this._logLevel=i,this._logHandler=n,this._userLogHandler=null}var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function h(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function y(t,s,u,a){return new(u=u||Promise)(function(n,e){function r(t){try{o(a.next(t))}catch(t){e(t)}}function i(t){try{o(a.throw(t))}catch(t){e(t)}}function o(t){var e;t.done?n(t.value):((e=t.value)instanceof u?e:new u(function(t){t(e)})).then(r,i)}o((a=a.apply(t,s||[])).next())})}function v(n,r){var i,o,s,u={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]},t={next:e(0),throw:e(1),return:e(2)};return"function"==typeof Symbol&&(t[Symbol.iterator]=function(){return this}),t;function e(e){return function(t){return function(e){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(s=2&e[0]?o.return:e[0]?o.throw||((s=o.return)&&s.call(o),0):o.next)&&!(s=s.call(o,e[1])).done)return s;switch(o=0,(e=s?[2&e[0],s.value]:e)[0]){case 0:case 1:s=e;break;case 4:return u.label++,{value:e[1],done:!1};case 5:u.label++,o=e[1],e=[0];continue;case 7:e=u.ops.pop(),u.trys.pop();continue;default:if(!(s=0<(s=u.trys).length&&s[s.length-1])&&(6===e[0]||2===e[0])){u=0;continue}if(3===e[0]&&(!s||e[1]>s[0]&&e[1]<s[3])){u.label=e[1];break}if(6===e[0]&&u.label<s[1]){u.label=s[1],s=e;break}if(s&&u.label<s[2]){u.label=s[2],u.ops.push(e);break}s[2]&&u.ops.pop(),u.trys.pop();continue}e=r.call(n,u)}catch(t){e=[6,t],o=0}finally{i=s=0}if(5&e[0])throw e[1];return{value:e[0]?e[1]:void 0,done:!0}}([e,t])}}}function f(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),i=0,e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function p(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var d,g="FirebaseError",m=(h(b,d=Error),b);function b(t,e,n){return(e=d.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,w.prototype.create),e}var w=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t,t=this.errors[t],t=t?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},A=N||self;function S(){}function x(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function D(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var O="closure_uid_"+(1e9*Math.random()>>>0),k=0;function P(t,e,n){return t.call.apply(t.bind,arguments)}function C(e,n,t){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var t=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(t,r),e.apply(n,t)}}return function(){return e.apply(n,arguments)}}function L(t,e,n){return(L=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?P:C).apply(null,arguments)}function R(e){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function V(){return Date.now()}function M(t,o){function e(){}e.prototype=o.prototype,t.X=o.prototype,t.prototype=new e,(t.prototype.constructor=t).Kb=function(t,e,n){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return o.prototype[e].apply(t,r)}}function U(){this.j=this.j,this.i=this.i}U.prototype.j=!1,U.prototype.ja=function(){!this.j&&(this.j=!0,this.G(),0)&&(Object.prototype.hasOwnProperty.call(this,O)&&this[O]||(this[O]=++k))},U.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var j=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},F=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function q(){return Array.prototype.concat.apply([],arguments)}function B(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function G(t){return/^[\s\xa0]*$/.test(t)}var z=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function H(t,e){return-1!=t.indexOf(e)}function Q(t,e){return t<e?-1:e<t?1:0}var Y=A.navigator;function K(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function X(t){var e,n={};for(e in t)n[e]=t[e];return n}ut=(Y=Y&&Y.userAgent)?Y:"";var W="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function J(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<W.length;i++)e=W[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function Z(t){return Z[" "](t),t}Z[" "]=S;var $,tt=H(ut,"Opera"),et=H(ut,"Trident")||H(ut,"MSIE"),nt=H(ut,"Edge"),rt=nt||et,it=H(ut,"Gecko")&&!(H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge"))&&!(H(ut,"Trident")||H(ut,"MSIE"))&&!H(ut,"Edge"),ot=H(ut.toLowerCase(),"webkit")&&!H(ut,"Edge");function st(){var t=A.document;return t?t.documentMode:void 0}var Y="",ut=(ut=ut,it?/rv:([^\);]+)(\)|;)/.exec(ut):nt?/Edge\/([\d\.]+)/.exec(ut):et?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ut):ot?/WebKit\/(\S+)/.exec(ut):tt?/(?:Version)[ \/]?(\S+)/.exec(ut):void 0);ut&&(Y=ut?ut[1]:""),$=et&&null!=(ut=st())&&ut>parseFloat(Y)?String(ut):Y;var at={};function ct(u){return t=u,e=function(){for(var t=0,e=z(String($)).split("."),n=z(String(u)).split("."),r=Math.max(e.length,n.length),i=0;0==t&&i<r;i++)for(var o=e[i]||"",s=n[i]||"";o=/(\d*)(\D*)(.*)/.exec(o)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],(0!=o[0].length||0!=s[0].length)&&(t=Q(0==o[1].length?0:parseInt(o[1],10),0==s[1].length?0:parseInt(s[1],10))||Q(0==o[2].length,0==s[2].length)||Q(o[2],s[2]),o=o[3],s=s[3],0==t););return 0<=t},n=at,Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e();var t,e,n}var ht=A.document&&et&&(st()||parseInt($,10))||void 0,ft=!et||9<=Number(ht),lt=et&&!ct("9"),pt=function(){if(!A.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{A.addEventListener("test",S,e),A.removeEventListener("test",S,e)}catch(t){}return t}();function dt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function yt(t,e){if(dt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(it){t:{try{Z(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:vt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}dt.prototype.b=function(){this.defaultPrevented=!0},M(yt,dt);var vt={2:"touch",3:"pen",4:"mouse"};yt.prototype.b=function(){yt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,lt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var gt="closure_listenable_"+(1e6*Math.random()|0),mt=0;function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++mt,this.Y=this.Z=!1}function wt(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function _t(t){this.src=t,this.a={},this.b=0}function Et(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=j(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(wt(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function It(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}_t.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=It(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new bt(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var Tt="closure_lm_"+(1e6*Math.random()|0),Nt={};function At(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Lt(r),e&&e[gt]?e.wa(n,r,D(i)?!!i.capture:!!i,o):St(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)At(t,e[o],n,r,i);return null}return n=Lt(n),t&&t[gt]?t.va(e,n,D(r)?!!r.capture:!!r,i):St(t,e,n,!1,r,i)}function St(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=D(i)?!!i.capture:!!i;if(s&&!ft)return null;var u,a,c=Pt(t);if(c||(t[Tt]=c=new _t(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=kt,r=a=ft?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)void 0===(i=pt?i:s)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Dt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function xt(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[gt]?Et(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Dt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Pt(e))?(Et(n,t),0==n.b&&(n.src=null,e[Tt]=null)):wt(t)))}function Dt(t){return t in Nt?Nt[t]:Nt[t]="on"+t}function Ot(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&xt(t),n.call(r,e)}function kt(t,e){if(t.Y)return!0;if(ft)return Ot(t,new yt(e,this));if(!e)t:{e=["window","event"];for(var n=A,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Ot(t,e=new yt(e,this))}function Pt(t){return(t=t[Tt])instanceof _t?t:null}var Ct="__closure_events_fn_"+(1e9*Math.random()>>>0);function Lt(e){return"function"==typeof e?e:(e[Ct]||(e[Ct]=function(t){return e.handleEvent(t)}),e[Ct])}function Rt(){U.call(this),this.c=new _t(this),(this.J=this).C=null}function Vt(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new dt(e,t):e instanceof dt?e.target=e.target||t:(s=e,J(e=new dt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=Mt(o,r,!0,e)&&s;if(s=Mt(o=e.a=t,r,!0,e)&&s,s=Mt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=Mt(o=e.a=n[i],r,!1,e)&&s}function Mt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Et(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}M(Rt,U),Rt.prototype[gt]=!0,(ut=Rt.prototype).addEventListener=function(t,e,n,r){At(this,t,e,n,r)},ut.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=D(i)?!!i.capture:!!i,r=Lt(r),e&&e[gt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=It(s=e.a[n],r,i,o))&&(wt(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Pt(e))&&(n=e.a[n.toString()],(r=(e=-1)<(e=n?It(n,r,i,o):e)?n[e]:null)&&xt(r))}(this,t,e,n,r)},ut.G=function(){if(Rt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)wt(n[r]);delete e.a[t],e.b--}}this.C=null},ut.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},ut.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ut=A.JSON.stringify;function jt(){this.b=this.a=null}var Ft,qt=(Bt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new Bt(function(){return new Gt},function(t){t.reset()}));function Bt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Gt(){this.next=this.b=this.a=null}function zt(t,e){var n;Ft||(n=A.Promise.resolve(void 0),Ft=function(){n.then(Yt)}),Ht||(Ft(),Ht=!0),Qt.add(t,e)}jt.prototype.add=function(t,e){var n=qt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Gt.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Ht=!(Gt.prototype.reset=function(){this.next=this.b=this.a=null}),Qt=new jt;function Yt(){for(var t,e;n=e=void 0,n=null,(e=Qt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){A.setTimeout(function(){throw t},0)}(t)}var n=qt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Ht=!1}function Kt(t,e){Rt.call(this),this.b=t||1,this.a=e||A,this.f=L(this.Za,this),this.g=V()}function Xt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Wt(t,e,n){if("function"==typeof t)n&&(t=L(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=L(t.handleEvent,t)}return 2147483647<Number(e)?-1:A.setTimeout(t,e||0)}M(Kt,Rt),(ut=Kt.prototype).aa=!1,ut.M=null,ut.Za=function(){var t;this.aa&&(0<(t=V()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Vt(this,"tick"),this.aa&&(Xt(this),this.start())))},ut.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=V())},ut.G=function(){Kt.X.G.call(this),Xt(this),delete this.a};var Jt,Zt,$t=(I(Zt=ee,Y=Jt=U),Zt.prototype=null===Y?Object.create(Y):(te.prototype=Y.prototype,new te),ee.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Wt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ee.prototype.G=function(){Jt.prototype.G.call(this),this.a&&(A.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ee);function te(){this.constructor=Zt}function ee(t,e){var n=Jt.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function ne(t){U.call(this),this.b=t,this.a={}}M(ne,U);var re=[];function ie(t,e,n,r){Array.isArray(n)||(n&&(re[0]=n.toString()),n=re);for(var i=0;i<n.length;i++){var o=At(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function oe(t){K(t.a,function(t,e){this.a.hasOwnProperty(e)&&xt(t)},t),t.a={}}function se(){this.a=!0}function ue(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ut(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}ne.prototype.G=function(){ne.X.G.call(this),oe(this)},ne.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},se.prototype.info=function(){};var ae={},ce=null;function he(){return ce=ce||new Rt}function fe(t){dt.call(this,ae.Fa,t)}function le(){var t=he();Vt(t,new fe(t))}function pe(t,e){dt.call(this,ae.STAT_EVENT,t),this.stat=e}function de(t){var e=he();Vt(e,new pe(e,t))}function ye(t){dt.call(this,ae.Ga,t)}function ve(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return A.setTimeout(function(){t()},e)}ae.Fa="serverreachability",M(fe,dt),ae.STAT_EVENT="statevent",M(pe,dt),ae.Ga="timingevent",M(ye,dt);var ge={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},me={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function be(){}function we(t){var e;return(e=t.a)?e:t.a={}}function _e(){}be.prototype.a=null;N={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Ee(){dt.call(this,"d")}function Ie(){dt.call(this,"c")}function Te(){}function Ne(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new ne(this),this.P=Se,t=rt?125:void 0,this.R=new Kt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}M(Ee,dt),M(Ie,dt),M(Te,be);var Ae=new Te,Se=45e3,xe={},De={};function Oe(t,e,n){t.H=1,t.i=Je(He(e)),t.j=n,t.I=!0,ke(t,null)}function ke(t,e){t.u=V(),Ce(t),t.l=He(t.i);var s,u,a,c,h,f,n=t.l,r=t.S;Array.isArray(r)||(r=[String(r)]),fn(n.b,"t",r),t.D=0,t.a=ir(t.g,t.g.C?e:null),0<t.O&&(t.F=new $t(L(t.Ca,t,t.a),t.O)),ie(t.J,t.a,"readystatechange",t.Xa),e=t.B?X(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),le(),s=t.c,u=t.m,a=t.l,c=t.f,h=t.S,f=t.j,s.info(function(){if(s.a)if(f)for(var t="",e=f.split("&"),n=0;n<e.length;n++){var r,i,o=e[n].split("=");1<o.length&&(r=o[0],o=o[1],t=2<=(i=r.split("_")).length&&"type"==i[1]?t+(r+"=")+o+"&":t+(r+"=redacted&"))}else t=null;else t=f;return"XMLHTTP REQ ("+c+") [attempt "+h+"]: "+u+"\n"+a+"\n"+t})}function Pe(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?De:(i=Number(u.substring(i,o)),isNaN(i)?xe:(o+=1)+i>u.length?De:(u=u.substr(o,i),r.D=o+i,u)));if(u==De){4==e&&(t.h=4,de(14),s=!1),ue(t.c,t.f,null,"[Incomplete Response]");break}if(u==xe){t.h=4,de(15),ue(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}ue(t.c,t.f,u,null),Ue(t,u)}4==e&&0==n.length&&(t.h=1,de(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Wn(e),e.F=!0,de(11))):(ue(t.c,t.f,n,"[Invalid Chunked Response]"),Me(t),Ve(t))}function Ce(t){t.T=V()+t.P,Le(t,t.P)}function Le(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=ve(L(t.Va,t),e)}function Re(t){t.o&&(A.clearTimeout(t.o),t.o=null)}function Ve(t){0==t.g.v||t.A||$n(t.g,t)}function Me(t){Re(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Xt(t.R),oe(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Ue(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||mn(u.b,t)))if(u.I=t.N,!t.C&&mn(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;Zn(u),qn(u)}Xn(u),de(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=ve(L(u.Sa,u),6e3));if(gn(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else er(u,11)}else if(!t.C&&u.a!=t||Zn(u),!G(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(H(r,"spdy")||H(r,"quic")||H(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(bn(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,We(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=V()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=rr(n,n.C?n.ga:null,n.fa),i.C?(wn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(Re(o),Ce(o)),n.a=i):Kn(n),0<u.g.length&&zn(u)):"stop"!=c[0]&&"close"!=c[0]||er(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?er(u,7):Fn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);le()}catch(t){}}function je(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(x(t)||"string"==typeof t)F(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(x(t)||"string"==typeof t)for(var n=[],r=t.length,i=0;i<r;i++)n.push(i);else for(i in n=[],r=0,t)n[r++]=i;for(var i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(x(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length,o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function Fe(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof Fe)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function qe(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Be(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){for(var i={},n=e=0;e<t.a.length;)Be(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Be(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(ut=Ne.prototype).setTimeout=function(t){this.P=t},ut.Xa=function(t){t=t.target;var e=this.F;e&&3==Vn(t)?e.f():this.Ca(t)},ut.Ca=function(t){try{if(t==this.a)t:{var e=Vn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!rt&&!this.a.$())){this.A||4!=e||7==n||le(),Re(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,r=this.c,a=this.m,c=this.l,h=this.f,f=this.S,l=e,p=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+f+"]: "+a+"\n"+c+"\n"+l+" "+p}),this.b){if(this.U&&!this.C){e:{if(this.a){var s=this.a;if((s=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,de(12),Me(this),Ve(this);break t}ue(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ue(this,u)}this.I?(Pe(this,e,o),rt&&this.b&&3==e&&(ie(this.J,this.R,"tick",this.Wa),this.R.start())):(ue(this.c,this.f,o,null),Ue(this,o)),4==e&&Me(this),this.b&&!this.A&&(4==e?$n(this.g,this):(this.b=!1,Ce(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,de(12)):(this.h=0,de(13)),Me(this),Ve(this)}}}catch(t){}var a,c,h,f,l,p},ut.Wa=function(){var t,e;this.a&&(t=Vn(this.a),e=this.a.$(),this.D<e.length&&(Re(this),Pe(this,t,e),this.b&&4!=t&&Ce(this)))},ut.cancel=function(){this.A=!0,Me(this)},ut.Va=function(){this.o=null;var t,e,n=V();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(le(),de(17)),Me(this),this.h=2,Ve(this)):Le(this,this.T-n)},(ut=Fe.prototype).K=function(){qe(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},ut.L=function(){return qe(this),this.a.concat()},ut.get=function(t,e){return Be(this.b,t)?this.b[t]:e},ut.set=function(t,e){Be(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},ut.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ge=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function ze(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof ze?(this.a=void 0!==e?e:t.a,Qe(this,t.f),this.j=t.j,Ye(this,t.c),Ke(this,t.h),this.g=t.g,e=t.b,(n=new un).c=e.c,e.a&&(n.a=new Fe(e.a),n.b=e.b),Xe(this,n),this.i=t.i):t&&(n=String(t).match(Ge))?(this.a=!!e,Qe(this,n[1]||"",!0),this.j=Ze(n[2]||""),Ye(this,n[3]||"",!0),Ke(this,n[4]),this.g=Ze(n[5]||"",!0),Xe(this,n[6]||"",!0),this.i=Ze(n[7]||"")):(this.a=!!e,this.b=new un(null,this.a))}function He(t){return new ze(t)}function Qe(t,e,n){t.f=n?Ze(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Ye(t,e,n){t.c=n?Ze(e,!0):e}function Ke(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function Xe(t,e,n){var r,i;e instanceof un?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(an(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(cn(this,e),fn(this,n,t))},r)),r.f=i):(n||(e=$e(e,on)),t.b=new un(e,t.a))}function We(t,e,n){t.b.set(e,n)}function Je(t){return We(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^V()).toString(36)),t}function Ze(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function $e(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,tn),n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function tn(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}ze.prototype.toString=function(){var t=[],e=this.f;e&&t.push($e(e,en,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push($e(e,en,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push($e(n,"/"==n.charAt(0)?rn:nn,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",$e(n,sn)),t.join("")};var en=/[#\/\?@]/g,nn=/[#\?:]/g,rn=/[#\?]/g,on=/[#\?@]/g,sn=/#/g;function un(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function an(o){o.a||(o.a=new Fe,o.b=0,o.c&&function(t){if(t){t=t.split("&");for(var e=0;e<t.length;e++){var n,r=t[e].indexOf("="),i=null;0<=r?(n=t[e].substring(0,r),i=t[e].substring(r+1)):n=t[e],r=n,i=i?decodeURIComponent(i.replace(/\+/g," ")):"",o.add(decodeURIComponent(r.replace(/\+/g," ")),i)}}}(o.c))}function cn(t,e){an(t),e=ln(t,e),Be(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Be((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&qe(t)))}function hn(t,e){return an(t),e=ln(t,e),Be(t.a.b,e)}function fn(t,e,n){cn(t,e),0<n.length&&(t.c=null,t.a.set(ln(t,e),B(n)),t.b+=n.length)}function ln(t,e){return e=String(e),t.f?e.toLowerCase():e}(ut=un.prototype).add=function(t,e){an(this),this.c=null,t=ln(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},ut.forEach=function(n,r){an(this),this.a.forEach(function(t,e){F(t,function(t){n.call(r,t,e,this)},this)},this)},ut.L=function(){an(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},ut.K=function(t){an(this);var e=[];if("string"==typeof t)hn(this,t)&&(e=q(e,this.a.get(ln(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=q(e,t[n])}return e},ut.set=function(t,e){return an(this),this.c=null,hn(this,t=ln(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},ut.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},ut.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),r=this.K(r),o=0;o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};function pn(t,e){this.b=t,this.a=e}function dn(t){this.g=t||yn,t=A.PerformanceNavigationTiming?0<(t=A.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(A.ia&&A.ia.ya&&A.ia.ya()&&A.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var yn=10;function vn(t){return t.b||t.a&&t.a.size>=t.f}function gn(t){return t.b?1:t.a?t.a.size:0}function mn(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function bn(t,e){t.a?t.a.add(e):t.b=e}function wn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function _n(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return B(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next())var s=o.value,r=r.concat(s.s)}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function En(){}function In(){this.a=new En}function Tn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}dn.prototype.cancel=function(){var t,e;if(this.c=_n(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},En.prototype.stringify=function(t){return A.JSON.stringify(t,void 0)},En.prototype.parse=function(t){return A.JSON.parse(t,void 0)};var Nn=A.JSON.parse;function An(t){Rt.call(this),this.headers=new Fe,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=Sn,this.D=this.F=!1}M(An,Rt);var Sn="",xn=/^https?$/i,Dn=["POST","PUT"];function On(t){return"content-type"==t.toLowerCase()}function kn(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Pn(t),Ln(t)}function Pn(t){t.u||(t.u=!0,Vt(t,"complete"),Vt(t,"error"))}function Cn(t){if(t.b&&(!t.s[1]||4!=Vn(t)||2!=t.W()))if(t.l&&4==Vn(t))Wt(t.za,0,t);else if(Vt(t,"readystatechange"),4==Vn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ge)[1]||null)&&A.self&&A.self.location&&(i=(r=A.self.location.protocol).substr(0,r.length-1)),n=!xn.test(i?i.toLowerCase():"")),e=n),e)Vt(t,"complete"),Vt(t,"success");else{t.h=6;try{var u=2<Vn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Pn(t)}}finally{Ln(t)}}}function Ln(t,e){if(t.a){Rn(t);var n=t.a,r=t.s[0]?S:null;t.a=null,t.s=null,e||Vt(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Rn(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(A.clearTimeout(t.m),t.m=null)}function Vn(t){return t.a?t.a.readyState:0}function Mn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",K(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):We(t,e,n))}function Un(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function jn(t){this.pa=0,this.g=[],this.c=new se,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=Un("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=Un("baseRetryDelayMs",5e3,t),this.Ra=Un("retryDelaySeedMs",1e4,t),this.Ma=Un("forwardChannelMaxRetries",2,t),this.ma=Un("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new dn(t&&t.concurrentRequestLimit),this.ka=new In,this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Fn(t){var e,n;Bn(t),3==t.v&&(e=t.R++,We(n=He(t.B),"SID",t.J),We(n,"RID",e),We(n,"TYPE","terminate"),Qn(t,n),(e=new Ne(t,t.c,e,void 0)).H=2,e.i=Je(He(n)),n=!1,!(n=A.navigator&&A.navigator.sendBeacon?A.navigator.sendBeacon(e.i.toString(),""):n)&&A.Image&&((new Image).src=e.i,n=!0),n||(e.a=ir(e.g,null),e.a.ba(e.i)),e.u=V(),Ce(e)),nr(t)}function qn(t){t.a&&(Wn(t),t.a.cancel(),t.a=null)}function Bn(t){qn(t),t.j&&(A.clearTimeout(t.j),t.j=null),Zn(t),t.b.cancel(),t.h&&("number"==typeof t.h&&A.clearTimeout(t.h),t.h=null)}function Gn(t,e){t.g.push(new pn(t.Oa++,e)),3==t.v&&zn(t)}function zn(t){vn(t.b)||t.h||(t.h=!0,zt(t.Ba,t),t.u=0)}function Hn(t,e){var n=e?e.f:t.R++,r=He(t.B);We(r,"SID",t.J),We(r,"RID",n),We(r,"AID",t.P),Qn(t,r),t.i&&t.l&&Mn(r,t.i,t.l),n=new Ne(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Yn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),bn(t.b,n),Oe(n,r,e)}function Qn(t,n){t.f&&je({},function(t,e){We(n,e,t)})}function Yn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?L(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,r){var i="req"+c+"_"||"";try{je(t,function(t,e){var n=t;D(t)&&(n=Ut(t)),r.push(i+e+"="+encodeURIComponent(n))})}catch(t){throw r.push(i+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Kn(t){t.a||t.j||(t.T=1,zt(t.Aa,t),t.o=0)}function Xn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=ve(L(t.Aa,t),tr(t,t.o)),t.o++,1)}function Wn(t){null!=t.s&&(A.clearTimeout(t.s),t.s=null)}function Jn(t){t.a=new Ne(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=He(t.la);We(e,"RID","rpc"),We(e,"SID",t.J),We(e,"CI",t.H?"0":"1"),We(e,"AID",t.P),Qn(t,e),We(e,"TYPE","xmlhttp"),t.i&&t.l&&Mn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=Je(He(e)),n.j=null,n.I=!0,ke(n,t)}function Zn(t){null!=t.m&&(A.clearTimeout(t.m),t.m=null)}function $n(t,e){var n,r,i,o=null;if(t.a==e){Zn(t),Wn(t),t.a=null;var s=2}else{if(!mn(t.b,e))return;o=e.s,wn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=V()-e.u,n=t.u,Vt(s=he(),new ye(s)),zn(t)):Kn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,gn((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=ve(L(r.Ba,r,i),tr(r,r.u)),r.u++,0))))&&(2!=s||!Xn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:er(t,5);break;case 4:er(t,10);break;case 3:er(t,6);break;default:er(t,2)}}function tr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function er(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=L(t.Ya,t),r||(r=new ze("//www.google.com/images/cleardot.gif"),A.location&&"http"==A.location.protocol||Qe(r,"https"),Je(r)),n=r.toString(),r=o,o=new se,A.Image?((i=new Image).onload=R(Tn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=R(Tn,o,i,"TestLoadImage: error",!1,r),i.onabort=R(Tn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=R(Tn,o,i,"TestLoadImage: timeout",!1,r),A.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):de(2),t.v=0,t.f&&t.f.ra(e),nr(t),Bn(t)}function nr(t){t.v=0,t.I=-1,t.f&&(0==_n(t.b).length&&0==t.g.length||(t.b.c.length=0,B(t.g),t.g.length=0),t.f.qa())}function rr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof ze?He(s):new ze(s,void 0);return""!=a.c?(e&&Ye(a,e+"."+a.c),Ke(a,a.h)):(r=(u=A.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new ze(null,void 0),r&&Qe(u,r),i&&Ye(u,i),o&&Ke(u,o),s&&(u.g=s),a=u),t.V&&K(t.V,function(t,e){We(a,e,t)}),e=t.A,n=t.na,e&&n&&We(a,e,n),We(a,"VER",t.ha),Qn(t,a),a}function ir(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new An(t.Na)).F=t.C,e}function or(){}function sr(){if(et&&!(10<=Number(ht)))throw Error("Environmental error: no available transport.")}function ur(t,e){Rt.call(this),this.a=new jn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!G(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!G(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new hr(this)}function ar(t){Ee.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function cr(){Ie.call(this),this.status=1}function hr(t){this.a=t}(ut=An.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?we(this.H):we(Ae),this.a.onreadystatechange=L(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void kn(this,t)}t=n||"";var i,o=new Fe(this.headers);r&&je(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=On,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=A.FormData&&t instanceof A.FormData,0<=j(Dn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=(i=this.a,et&&ct(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=L(this.xa,this)):this.m=Wt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){kn(this,t)}},ut.xa=function(){this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Vt(this,"timeout"),this.abort(8))},ut.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Vt(this,"complete"),Vt(this,"abort"),Ln(this))},ut.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Ln(this,!0)),An.X.G.call(this)},ut.za=function(){this.j||(this.A||this.l||this.g?Cn(this):this.Ua())},ut.Ua=function(){Cn(this)},ut.W=function(){try{return 2<Vn(this)?this.a.status:-1}catch(t){return-1}},ut.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},ut.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),Nn(e)}},ut.ua=function(){return this.h},ut.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(ut=jn.prototype).ha=8,ut.v=1,ut.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Ne(this,this.c,t,void 0),r=this.l;if(this.O&&(r?J(r=X(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Yn(this,n,e),We(i=He(this.B),"RID",t),We(i,"CVER",22),this.A&&We(i,"X-HTTP-Session-Id",this.A),Qn(this,i),this.i&&r&&Mn(i,this.i,r),bn(this.b,n),this.Ia&&We(i,"TYPE","init"),this.da?(We(i,"$req",e),We(i,"SID","null"),n.U=!0,Oe(n,i,null)):Oe(n,i,e),this.v=2}}else 3==this.v&&(t?Hn(this,t):0==this.g.length||vn(this.b)||Hn(this))},ut.Aa=function(){var t;this.j=null,Jn(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=ve(L(this.Ta,this),t))},ut.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,de(10),qn(this),Jn(this))},ut.Sa=function(){null!=this.m&&(this.m=null,qn(this),Xn(this),de(19))},ut.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),de(2)):(this.c.info("Failed to ping google.com"),de(1))},(ut=or.prototype).ta=function(){},ut.sa=function(){},ut.ra=function(){},ut.qa=function(){},ut.Ja=function(){},sr.prototype.a=function(t,e){return new ur(t,e)},M(ur,Rt),ur.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;de(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=rr(t,null,t.fa),zn(t)},ur.prototype.close=function(){Fn(this.a)},ur.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Gn(this.a,e)):this.l?((e={}).__data__=Ut(t),Gn(this.a,e)):Gn(this.a,t)},ur.prototype.G=function(){this.a.f=null,delete this.f,Fn(this.a),delete this.a,ur.X.G.call(this)},M(ar,Ee),M(cr,Ie),M(hr,or),hr.prototype.ta=function(){Vt(this.a,"a")},hr.prototype.sa=function(t){Vt(this.a,new ar(t))},hr.prototype.ra=function(t){Vt(this.a,new cr)},hr.prototype.qa=function(){Vt(this.a,"b")},sr.prototype.createWebChannel=sr.prototype.a,ur.prototype.send=ur.prototype.h,ur.prototype.open=ur.prototype.g,ge.NO_ERROR=0,ge.TIMEOUT=8,ge.HTTP_ERROR=6,me.COMPLETE="complete",(_e.EventType=N).OPEN="a",N.CLOSE="b",N.ERROR="c",N.MESSAGE="d",Rt.prototype.listen=Rt.prototype.va,An.prototype.listenOnce=An.prototype.wa,An.prototype.getLastError=An.prototype.Qa,An.prototype.getLastErrorCode=An.prototype.ua,An.prototype.getStatus=An.prototype.W,An.prototype.getResponseJson=An.prototype.Pa,An.prototype.getResponseText=An.prototype.$,An.prototype.send=An.prototype.ba;var fr=he,lr=ge,pr=me,dr=ae,yr=_e,vr=An,gr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},mr=(Object.defineProperty(wr.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),wr.prototype.isEqual=function(t){return t instanceof wr&&t.projectId===this.projectId&&t.database===this.database},wr),br=new o("@firebase/firestore");function wr(t,e){this.projectId=t,this.database=e||"(default)"}function _r(){return br.logLevel}function Er(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=l.DEBUG&&(e=n.map(Nr),br.debug.apply(br,f(["Firestore (8.2.10): "+t],e)))}function Ir(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=l.ERROR&&(e=n.map(Nr),br.error.apply(br,f(["Firestore (8.2.10): "+t],e)))}function Tr(t){for(var e,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];br.logLevel<=l.WARN&&(e=n.map(Nr),br.warn.apply(br,f(["Firestore (8.2.10): "+t],e)))}function Nr(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}function Ar(t){throw Ir(t="FIRESTORE (8.2.10) INTERNAL ASSERTION FAILED: "+(void 0===t?"Unexpected state":t)),new Error(t)}function Sr(t){t||Ar()}var xr=(Dr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),e=new Uint8Array(40);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(e);else for(var n=0;n<40;n++)e[n]=Math.floor(256*Math.random());return e}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Dr);function Dr(){}function Or(t,e){return t<e?-1:e<t?1:0}function kr(t,n,r){return t.length===n.length&&t.every(function(t,e){return r(t,n[e])})}function Pr(t){return t+"\0"}var Cr=(Lr.fromBase64String=function(t){return new Lr(atob(t))},Lr.fromUint8Array=function(t){return new Lr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Lr.prototype.toBase64=function(){return t=this.h,btoa(t);var t},Lr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},Lr.prototype.l=function(){return 2*this.h.length},Lr.prototype._=function(t){return Or(this.h,t.h)},Lr.prototype.isEqual=function(t){return this.h===t.h},Lr);function Lr(t){this.h=t}Cr.T=new Cr("");var Rr,Vr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Mr=(h(Br,Rr=Error),Br),Ur=(qr.fromBase64String=function(t){try{return new qr(Cr.fromBase64String(t))}catch(t){throw new Mr(Vr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},qr.fromUint8Array=function(t){return new qr(Cr.fromUint8Array(t))},qr.prototype.toBase64=function(){return this.I.toBase64()},qr.prototype.toUint8Array=function(){return this.I.toUint8Array()},qr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},qr.prototype.isEqual=function(t){return this.I.isEqual(t.I)},qr),jr=(Fr.prototype.m=function(){return null!=this.uid},Fr.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},Fr.prototype.isEqual=function(t){return t.uid===this.uid},Fr);function Fr(t){this.uid=t}function qr(t){this.I=t}function Br(t,e){var n=this;return(n=Rr.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}function Gr(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t}jr.UNAUTHENTICATED=new jr(null),jr.R=new jr("google-credentials-uid"),jr.P=new jr("first-party-uid");var zr=($r.prototype.getToken=function(){return Promise.resolve(null)},$r.prototype.p=function(){},$r.prototype.v=function(t){(this.V=t)(jr.UNAUTHENTICATED)},$r.prototype.S=function(){this.V=null},$r),Hr=(Zr.prototype.getToken=function(){var e=this,n=this.N,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(function(t){return e.N!==n?(Er("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):t?(Sr("string"==typeof t.accessToken),new Gr(t.accessToken,e.currentUser)):null}):Promise.resolve(null)},Zr.prototype.p=function(){this.forceRefresh=!0},Zr.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},Zr.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},Zr.prototype.$=function(){var t=this.auth&&this.auth.getUid();return Sr(null===t||"string"==typeof t),new jr(t)},Zr),Qr=(Object.defineProperty(Jr.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),Jr),Yr=(Wr.prototype.getToken=function(){return Promise.resolve(new Qr(this.F,this.O))},Wr.prototype.v=function(t){t(jr.P)},Wr.prototype.S=function(){},Wr.prototype.p=function(){},Wr),Kr=(Xr.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Xr.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},Xr);function Xr(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}function Wr(t,e){this.F=t,this.O=e}function Jr(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=jr.P}function Zr(t){var e=this;this.D=null,this.currentUser=jr.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then(function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)},function(){}))}function $r(){this.V=null}Kr.q=-1;var ti,ei,ni=(pi.now=function(){return pi.fromMillis(Date.now())},pi.fromDate=function(t){return pi.fromMillis(t.getTime())},pi.fromMillis=function(t){var e=Math.floor(t/1e3);return new pi(e,1e6*(t-1e3*e))},pi.prototype.toDate=function(){return new Date(this.toMillis())},pi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},pi.prototype.U=function(t){return this.seconds===t.seconds?Or(this.nanoseconds,t.nanoseconds):Or(this.seconds,t.seconds)},pi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},pi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},pi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},pi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},pi),ri=(li.K=function(t){return new li(t)},li.min=function(){return new li(new ni(0,0))},li.prototype._=function(t){return this.timestamp.U(t.timestamp)},li.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},li.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},li.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},li.prototype.j=function(){return this.timestamp},li),me=(Object.defineProperty(fi.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),fi.prototype.isEqual=function(t){return 0===fi.H(this,t)},fi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof fi?t.forEach(function(t){e.push(t)}):e.push(t),this.J(e)},fi.prototype.limit=function(){return this.offset+this.length},fi.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},fi.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},fi.prototype.Z=function(){return this.segments[this.offset]},fi.prototype.tt=function(){return this.get(this.length-1)},fi.prototype.get=function(t){return this.segments[this.offset+t]},fi.prototype.et=function(){return 0===this.length},fi.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},fi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},fi.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},fi.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},fi),ii=(h(hi,ei=me),hi.prototype.J=function(t,e,n){return new hi(t,e,n)},hi.prototype.rt=function(){return this.it().join("/")},hi.prototype.toString=function(){return this.rt()},hi.ot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new hi(n)},hi.ct=function(){return new hi([])},hi),oi=/^[_a-zA-Z][_a-zA-Z0-9]*$/,si=(h(ci,ti=me),ci.prototype.J=function(t,e,n){return new ci(t,e,n)},ci.at=function(t){return oi.test(t)},ci.prototype.rt=function(){return this.it().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ci.at(t)?t:"`"+t+"`"}).join(".")},ci.prototype.toString=function(){return this.rt()},ci.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},ci.ht=function(){return new ci(["__name__"])},ci.lt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Mr(Vr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Mr(Vr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Mr(Vr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new ci(e)},ci.ct=function(){return new ci([])},ci),ui=(ai._t=function(t){return new ai(ii.ot(t))},ai.ft=function(t){return new ai(ii.ot(t).Y(5))},ai.prototype.dt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},ai.prototype.isEqual=function(t){return null!==t&&0===ii.H(this.path,t.path)},ai.prototype.toString=function(){return this.path.toString()},ai.H=function(t,e){return ii.H(t.path,e.path)},ai.wt=function(t){return t.length%2==0},ai.Et=function(t){return new ai(new ii(t.slice()))},ai);function ai(t){this.path=t}function ci(){return null!==ti&&ti.apply(this,arguments)||this}function hi(){return null!==ei&&ei.apply(this,arguments)||this}function fi(t,e,n){void 0===e?e=0:e>t.length&&Ar(),void 0===n?n=t.length-e:n>t.length-e&&Ar(),this.segments=t,this.offset=e,this.G=n}function li(t){this.timestamp=t}function pi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Mr(Vr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function di(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function yi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function vi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var gi=(bi.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},bi.prototype.isEqual=function(t){return kr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},bi),mi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function bi(t){(this.fields=t).sort(si.H)}function wi(t){if(Sr(!!t),"string"!=typeof t)return{seconds:_i(t.seconds),nanos:_i(t.nanos)};var e=0,n=mi.exec(t);return Sr(!!n),n[1]&&(n=(n[1]+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function _i(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ei(t){return"string"==typeof t?Cr.fromBase64String(t):Cr.fromUint8Array(t)}function Ii(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ti(t){return t=wi(t.mapValue.fields.__local_write_time__.timestampValue),new ni(t.seconds,t.nanos)}function Ni(t){return null==t}function Ai(t){return 0===t&&1/t==-1/0}function Si(t){return"number"==typeof t&&Number.isInteger(t)&&!Ai(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function xi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ii(t)?4:10:Ar()}function Di(r,i){var t,e,n=xi(r);if(n!==xi(i))return!1;switch(n){case 0:return!0;case 1:return r.booleanValue===i.booleanValue;case 4:return Ti(r).isEqual(Ti(i));case 3:return function(t){if("string"==typeof r.timestampValue&&"string"==typeof t.timestampValue&&r.timestampValue.length===t.timestampValue.length)return r.timestampValue===t.timestampValue;var e=wi(r.timestampValue),t=wi(t.timestampValue);return e.seconds===t.seconds&&e.nanos===t.nanos}(i);case 5:return r.stringValue===i.stringValue;case 6:return e=i,Ei(r.bytesValue).isEqual(Ei(e.bytesValue));case 7:return r.referenceValue===i.referenceValue;case 8:return t=i,_i((e=r).geoPointValue.latitude)===_i(t.geoPointValue.latitude)&&_i(e.geoPointValue.longitude)===_i(t.geoPointValue.longitude);case 2:return e=i,"integerValue"in(t=r)&&"integerValue"in e?_i(t.integerValue)===_i(e.integerValue):"doubleValue"in t&&"doubleValue"in e&&((t=_i(t.doubleValue))===(e=_i(e.doubleValue))?Ai(t)===Ai(e):isNaN(t)&&isNaN(e));case 9:return kr(r.arrayValue.values||[],i.arrayValue.values||[],Di);case 10:return function(){var t,e=r.mapValue.fields||{},n=i.mapValue.fields||{};if(di(e)!==di(n))return!1;for(t in e)if(e.hasOwnProperty(t)&&(void 0===n[t]||!Di(e[t],n[t])))return!1;return!0}();default:return Ar()}}function Oi(t,e){return void 0!==(t.values||[]).find(function(t){return Di(t,e)})}function ki(t,e){var n,r,i,o,s=xi(t),u=xi(e);if(s!==u)return Or(s,u);switch(s){case 0:return 0;case 1:return Or(t.booleanValue,e.booleanValue);case 2:return n=e,(r=_i(t.integerValue||t.doubleValue))<(n=_i(n.integerValue||n.doubleValue))?-1:n<r?1:r===n?0:isNaN(r)?isNaN(n)?0:-1:1;case 3:return Pi(t.timestampValue,e.timestampValue);case 4:return Pi(Ti(t),Ti(e));case 5:return Or(t.stringValue,e.stringValue);case 6:return i=t.bytesValue,o=e.bytesValue,i=Ei(i),o=Ei(o),i._(o);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Or(n[i],r[i]);if(0!==o)return o}return Or(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return o=t.geoPointValue,r=e.geoPointValue,0!==(n=Or(_i(o.latitude),_i(r.latitude)))?n:Or(_i(o.longitude),_i(r.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=ki(n[i],r[i]);if(o)return o}return Or(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Or(r[s],o[s]);if(0!==u)return u;if(0!==(u=ki(n[r[s]],i[o[s]])))return u}return Or(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Ar()}}function Pi(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Or(t,e);var n=wi(t),t=wi(e);return 0!==(e=Or(n.seconds,t.seconds))?e:Or(n.nanos,t.nanos)}function Ci(t){return function s(i){return"nullValue"in i?"null":"booleanValue"in i?""+i.booleanValue:"integerValue"in i?""+i.integerValue:"doubleValue"in i?""+i.doubleValue:"timestampValue"in i?"time("+(t=wi(t=i.timestampValue)).seconds+","+t.nanos+")":"stringValue"in i?i.stringValue:"bytesValue"in i?Ei(i.bytesValue).toBase64():"referenceValue"in i?(e=i.referenceValue,ui.ft(e).toString()):"geoPointValue"in i?"geo("+(e=i.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in i?function(){for(var t="[",e=!0,n=0,r=i.arrayValue.values||[];n<r.length;n++)e?e=!1:t+=",",t+=s(r[n]);return t+"]"}():"mapValue"in i?function(t){for(var e="{",n=!0,r=0,i=Object.keys(t.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:e+=",",e+=o+":"+s(t.fields[o])}return e+"}"}(i.mapValue):Ar();var t,e}(t)}function Li(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function Ri(t){return t&&"integerValue"in t}function Vi(t){return!!t&&"arrayValue"in t}function Mi(t){return t&&"nullValue"in t}function Ui(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function ji(t){return t&&"mapValue"in t}var Fi=(Gi.empty=function(){return new Gi({mapValue:{}})},Gi.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!ji(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},Gi.prototype.isEqual=function(t){return Di(this.proto,t.proto)},Gi),qi=(Bi.prototype.set=function(t,e){return this.Rt(t,e),this},Bi.prototype.delete=function(t){return this.Rt(t,null),this},Bi.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r)var i=t.get(r),o=n.get(i),n=(o instanceof Map||(o=o&&10===xi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o);n.set(t.tt(),e)},Bi.prototype.Pt=function(){var t=this.yt(si.ct(),this.At);return null!=t?new Fi(t):this.It},Bi.prototype.yt=function(r,t){var i=this,o=!1,e=this.It.field(r),s=ji(e)?Object.assign({},e.mapValue.fields):{};return t.forEach(function(t,e){var n;t instanceof Map?null!=(n=i.yt(r.child(e),t))&&(s[e]=n,o=!0):null!==t?(s[e]=t,o=!0):s.hasOwnProperty(e)&&(delete s[e],o=!0)}),o?{mapValue:{fields:s}}:null},Bi);function Bi(t){void 0===t&&(t=Fi.empty()),this.It=t,this.At=new Map}function Gi(t){this.proto=t}var zi,Hi,Qi,Yi=(h($i,Qi=o=function(t,e){this.key=t,this.version=e}),$i.prototype.field=function(t){return this.gt.field(t)},$i.prototype.data=function(){return this.gt},$i.prototype.bt=function(){return this.gt.proto},$i.prototype.isEqual=function(t){return t instanceof $i&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},$i.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty($i.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),$i),Ki=(h(Zi,Hi=o),Zi.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(Zi.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),Zi.prototype.isEqual=function(t){return t instanceof Zi&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Zi),Xi=(h(Ji,zi=o),Ji.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty(Ji.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),Ji.prototype.isEqual=function(t){return t instanceof Ji&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},Ji),Wi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function Ji(){return null!==zi&&zi.apply(this,arguments)||this}function Zi(t,e,n){var r=this;return(r=Hi.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function $i(t,e,n,r){var i=this;return(i=Qi.call(this,t,e)||this).gt=n,i.Vt=!!r.Vt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function to(t,e,n,r,i,o,s){return new Wi(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function eo(t){var e=t;return null===e.vt&&(t=e.path.rt(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return t.field.rt()+t.op.toString()+Ci(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return t.field.rt()+t.dir}).join(","),Ni(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=ko(e.startAt)),e.endAt&&(t+="|ub:",t+=ko(e.endAt)),e.vt=t),e.vt}function no(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!Di(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Lo(t.startAt,e.startAt)&&Lo(t.endAt,e.endAt)}function ro(t){return ui.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var io,oo=(h(so,io=function(){}),so.create=function(t,e,n){return t.ut()?"in"===e||"not-in"===e?this.St(t,e,n):new ho(t,e,n):"array-contains"===e?new Eo(t,n):"in"===e?new Io(t,n):"not-in"===e?new To(t,n):"array-contains-any"===e?new No(t,n):new so(t,e,n)},so.St=function(t,e,n){return new("in"===e?fo:lo)(t,n)},so.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Dt(ki(t,this.value)):null!==t&&xi(this.value)===xi(t)&&this.Dt(ki(t,this.value))},so.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Ar()}},so.prototype.Ct=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},so);function so(t,e,n){var r=this;return(r=io.call(this)||this).field=t,r.op=e,r.value=n,r}var uo,ao,co,ho=(h(vo,co=oo),vo.prototype.matches=function(t){return t=ui.H(t.key,this.key),this.Dt(t)},vo),fo=(h(yo,ao=oo),yo.prototype.matches=function(e){return this.keys.some(function(t){return t.isEqual(e.key)})},yo),lo=(h(po,uo=oo),po.prototype.matches=function(e){return!this.keys.some(function(t){return t.isEqual(e.key)})},po);function po(t,e){var n=this;return(n=uo.call(this,t,"not-in",e)||this).keys=go(0,e),n}function yo(t,e){var n=this;return(n=ao.call(this,t,"in",e)||this).keys=go(0,e),n}function vo(t,e,n){var r=this;return(r=co.call(this,t,e,n)||this).key=ui.ft(n.referenceValue),r}function go(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ui.ft(t.referenceValue)})}var mo,bo,wo,_o,Eo=(h(Oo,_o=oo),Oo.prototype.matches=function(t){return Vi(t=t.field(this.field))&&Oi(t.arrayValue,this.value)},Oo),Io=(h(Do,wo=oo),Do.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Oi(this.value.arrayValue,t)},Do),To=(h(xo,bo=oo),xo.prototype.matches=function(t){return!Oi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Oi(this.value.arrayValue,t))},xo),No=(h(So,mo=oo),So.prototype.matches=function(t){var e=this;return!(!Vi(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Oi(e.value.arrayValue,t)})},So),Ao=function(t,e){this.position=t,this.before=e};function So(t,e){return mo.call(this,t,"array-contains-any",e)||this}function xo(t,e){return bo.call(this,t,"not-in",e)||this}function Do(t,e){return wo.call(this,t,"in",e)||this}function Oo(t,e){return _o.call(this,t,"array-contains",e)||this}function ko(t){return(t.before?"b":"a")+":"+t.position.map(Ci).join(",")}var Po=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Co(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i],r=o.field.ut()?ui.H(ui.ft(s.referenceValue),n.key):ki(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Lo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!Di(t.position[n],e.position[n]))return!1;return!0}var Ro=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Vo(t,e,n,r,i,o,s,u){return new Ro(t,e,n,r,i,o,s,u)}function Mo(t){return new Ro(t)}function Uo(t){return!Ni(t.limit)&&"F"===t.limitType}function jo(t){return!Ni(t.limit)&&"L"===t.limitType}function Fo(t){return 0<t.xt.length?t.xt[0].field:null}function qo(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function Bo(t){return null!==t.collectionGroup}function Go(t){var e=t;if(null===e.Nt){e.Nt=[];var n=qo(e),t=Fo(e);if(null!==n&&null===t)n.ut()||e.Nt.push(new Po(n)),e.Nt.push(new Po(si.ht(),"asc"));else{for(var r=!1,i=0,o=e.xt;i<o.length;i++){var s=o[i];e.Nt.push(s),s.field.ut()&&(r=!0)}r||(n=0<e.xt.length?e.xt[e.xt.length-1].dir:"asc",e.Nt.push(new Po(si.ht(),n)))}}return e.Nt}function zo(t){var e=t;if(!e.$t)if("F"===e.limitType)e.$t=to(e.path,e.collectionGroup,Go(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Go(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Po(o.field,s))}var u=e.endAt?new Ao(e.endAt.position,!e.endAt.before):null,t=e.startAt?new Ao(e.startAt.position,!e.startAt.before):null;e.$t=to(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.$t}function Ho(t,e,n){return new Ro(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Qo(t,e){return no(zo(t),zo(e))&&t.limitType===e.limitType}function Yo(t){return eo(zo(t))+"|lt:"+t.limitType}function Ko(t){return"Query(target="+(n=(e=zo(t)).path.rt(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return t.field.rt()+" "+t.op+" "+Ci(t.value)}).join(", ")+"]"),Ni(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return t.field.rt()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+ko(e.startAt)),e.endAt&&(n+=", endAt: "+ko(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Xo(i,t){return e=i,n=t.key.path,(null!==e.collectionGroup?t.key.dt(e.collectionGroup)&&e.path.nt(n):ui.wt(e.path)?e.path.isEqual(n):e.path.st(n))&&function(t){for(var e=0,n=i.xt;e<n.length;e++){var r=n[e];if(!r.field.ut()&&null===t.field(r.field))return}return 1}(t)&&function(t){for(var e=0,n=i.filters;e<n.length;e++)if(!n[e].matches(t))return;return 1}(t)&&(n=t,(!(t=i).startAt||Co(t.startAt,Go(t),n))&&(!t.endAt||!Co(t.endAt,Go(t),n)));var e,n}function Wo(u){return function(t,e){for(var n=!1,r=0,i=Go(u);r<i.length;r++){var o=i[r],s=function(t,e,n){var r,i=t.field.ut()?ui.H(e.key,n.key):(r=t.field,n=n,e=e.field(r),r=n.field(r),null!==e&&null!==r?ki(e,r):Ar());switch(t.dir){case"asc":return i;case"desc":return-1*i;default:return Ar()}}(o,t,e);if(0!==s)return s;n=n||o.field.ut()}return 0}}var Jo=(Zo.prototype.kt=function(t){return new Zo(this.target,this.targetId,this.Ft,t,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},Zo.prototype.Mt=function(t,e){return new Zo(this.target,this.targetId,this.Ft,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},Zo.prototype.Lt=function(t){return new Zo(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,t,this.resumeToken)},Zo);function Zo(t,e,n,r,i,o,s){void 0===i&&(i=ri.min()),void 0===o&&(o=ri.min()),void 0===s&&(s=Cr.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function $o(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ai(e)?"-0":e}}function ts(t){return{integerValue:""+t}}function es(t,e){return Si(e)?ts(e):$o(t,e)}function ns(t,e){return t instanceof ys?Ri(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var rs,is,os=(h(as,is=me=function(){this.qt=void 0}),as),ss=(h(us,rs=me),us);function us(t){var e=this;return(e=rs.call(this)||this).elements=t,e}function as(){return null!==is&&is.apply(this,arguments)||this}function cs(t,e){for(var n=ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n.some(function(t){return Di(t,e)})||n.push(e)}(i[r]);return{arrayValue:{values:n}}}var hs,fs=(h(ls,hs=me),ls);function ls(t){var e=this;return(e=hs.call(this)||this).elements=t,e}function ps(t,e){for(var n=ms(e),r=0,i=t.elements;r<i.length;r++)!function(e){n=n.filter(function(t){return!Di(t,e)})}(i[r]);return{arrayValue:{values:n}}}var ds,ys=(h(vs,ds=me),vs);function vs(t,e){var n=this;return(n=ds.call(this)||this).Qt=t,n.Ut=e,n}function gs(t){return _i(t.integerValue||t.doubleValue)}function ms(t){return Vi(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function bs(t,e){this.version=t,this.transformResults=e}var ws=function(t,e){this.field=t,this.transform=e},_s=(Es.Kt=function(){return new Es},Es.exists=function(t){return new Es(void 0,t)},Es.updateTime=function(t){return new Es(t)},Object.defineProperty(Es.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Es.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Es);function Es(t,e){this.updateTime=t,this.exists=e}function Is(t,e){return void 0!==t.updateTime?e instanceof Yi&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Yi}function Ts(t,e,n){return t instanceof Ds?function(t,e,n){if(!Is(t.jt,e))return e;var r=t.value,n=Rs(t.fieldTransforms,n,e),r=Vs(t.fieldTransforms,r,n),e=As(e);return new Yi(t.key,e,r,{Vt:!0})}(t,e,n):t instanceof Os?function(t,e,n){if(!Is(t.jt,e))return e;var r=As(e),e=Cs(t,e,Rs(t.fieldTransforms,n,e));return new Yi(t.key,r,e,{Vt:!0})}(t,e,n):Is(t.jt,e)?new Ki(t.key,ri.min()):e}function Ns(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&kr(n,r,function(t,e){return t.field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof ss&&e instanceof ss||t instanceof fs&&e instanceof fs?kr(t.elements,e.elements,Di):t instanceof ys&&e instanceof ys?Di(t.Ut,e.Ut):t instanceof os&&e instanceof os)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt));var n,r}function As(t){return t instanceof Yi?t.version:ri.min()}var Ss,xs,Ds=(h(Ps,xs=o=function(){}),Ps),Os=(h(ks,Ss=o),ks);function ks(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=Ss.call(this)||this).key=t,o.data=e,o.Gt=n,o.jt=r,o.fieldTransforms=i,o.type=1,o}function Ps(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=xs.call(this)||this).key=t,i.value=e,i.jt=n,i.fieldTransforms=r,i.type=0,i}function Cs(t,e,n){var r,i,o=t;return e=e instanceof Yi?e.data():Fi.empty(),i=new qi(e),o.Gt.fields.forEach(function(t){var e;t.et()||(null!==(e=o.data.field(t))?i.set(t,e):i.delete(t))}),r=i.Pt(),Vs(t.fieldTransforms,r,n)}function Ls(t,e,n){var r=[];Sr(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Yi&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof ss?cs(o,s):o instanceof fs?ps(o,s):u))}return r}function Rs(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Yi&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,a instanceof os?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof ss?cs(a,r):a instanceof fs?ps(a,r):(r=gs(a=ns(c=a,r))+gs(c.Ut),Ri(a)&&Ri(c.Ut)?ts(r):$o(c.Qt,r))))}return i}function Vs(t,e,n){for(var r=new qi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}function Ms(t){this.count=t}var Us,js,Fs,qs=(h(zs,Fs=o),zs),Bs=(h(Gs,js=o),Gs);function Gs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.jt=e,n.type=3,n.fieldTransforms=[],n}function zs(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.jt=e,n.type=2,n.fieldTransforms=[],n}function Hs(t){switch(t){case Vr.OK:return Ar(),0;case Vr.CANCELLED:case Vr.UNKNOWN:case Vr.DEADLINE_EXCEEDED:case Vr.RESOURCE_EXHAUSTED:case Vr.INTERNAL:case Vr.UNAVAILABLE:case Vr.UNAUTHENTICATED:return;case Vr.INVALID_ARGUMENT:case Vr.NOT_FOUND:case Vr.ALREADY_EXISTS:case Vr.PERMISSION_DENIED:case Vr.FAILED_PRECONDITION:case Vr.ABORTED:case Vr.OUT_OF_RANGE:case Vr.UNIMPLEMENTED:case Vr.DATA_LOSS:return 1;default:return Ar(),0}}function Qs(t){if(void 0===t)return Ir("GRPC error has no .code"),Vr.UNKNOWN;switch(t){case Us.OK:return Vr.OK;case Us.CANCELLED:return Vr.CANCELLED;case Us.UNKNOWN:return Vr.UNKNOWN;case Us.DEADLINE_EXCEEDED:return Vr.DEADLINE_EXCEEDED;case Us.RESOURCE_EXHAUSTED:return Vr.RESOURCE_EXHAUSTED;case Us.INTERNAL:return Vr.INTERNAL;case Us.UNAVAILABLE:return Vr.UNAVAILABLE;case Us.UNAUTHENTICATED:return Vr.UNAUTHENTICATED;case Us.INVALID_ARGUMENT:return Vr.INVALID_ARGUMENT;case Us.NOT_FOUND:return Vr.NOT_FOUND;case Us.ALREADY_EXISTS:return Vr.ALREADY_EXISTS;case Us.PERMISSION_DENIED:return Vr.PERMISSION_DENIED;case Us.FAILED_PRECONDITION:return Vr.FAILED_PRECONDITION;case Us.ABORTED:return Vr.ABORTED;case Us.OUT_OF_RANGE:return Vr.OUT_OF_RANGE;case Us.UNIMPLEMENTED:return Vr.UNIMPLEMENTED;case Us.DATA_LOSS:return Vr.DATA_LOSS;default:return Ar()}}(me=Us={})[me.OK=0]="OK",me[me.CANCELLED=1]="CANCELLED",me[me.UNKNOWN=2]="UNKNOWN",me[me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",me[me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",me[me.NOT_FOUND=5]="NOT_FOUND",me[me.ALREADY_EXISTS=6]="ALREADY_EXISTS",me[me.PERMISSION_DENIED=7]="PERMISSION_DENIED",me[me.UNAUTHENTICATED=16]="UNAUTHENTICATED",me[me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",me[me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",me[me.ABORTED=10]="ABORTED",me[me.OUT_OF_RANGE=11]="OUT_OF_RANGE",me[me.UNIMPLEMENTED=12]="UNIMPLEMENTED",me[me.INTERNAL=13]="INTERNAL",me[me.UNAVAILABLE=14]="UNAVAILABLE",me[me.DATA_LOSS=15]="DATA_LOSS";var Ys=(Zs.prototype.zt=function(t,e){return new Zs(this.H,this.root.zt(t,e,this.H).copy(null,null,Xs.Ht,null,null))},Zs.prototype.remove=function(t){return new Zs(this.H,this.root.remove(t,this.H).copy(null,null,Xs.Ht,null,null))},Zs.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Zs.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Zs.prototype.et=function(){return this.root.et()},Object.defineProperty(Zs.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Zs.prototype.Jt=function(){return this.root.Jt()},Zs.prototype.Yt=function(){return this.root.Yt()},Zs.prototype.Xt=function(t){return this.root.Xt(t)},Zs.prototype.forEach=function(n){this.Xt(function(t,e){return n(t,e),!1})},Zs.prototype.toString=function(){var n=[];return this.Xt(function(t,e){return n.push(t+":"+e),!1}),"{"+n.join(", ")+"}"},Zs.prototype.Zt=function(t){return this.root.Zt(t)},Zs.prototype.te=function(){return new Ks(this.root,null,this.H,!1)},Zs.prototype.ee=function(t){return new Ks(this.root,t,this.H,!1)},Zs.prototype.ne=function(){return new Ks(this.root,null,this.H,!0)},Zs.prototype.se=function(t){return new Ks(this.root,t,this.H,!0)},Zs),Ks=(Js.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},Js.prototype.ce=function(){return 0<this.re.length},Js.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},Js),Xs=(Ws.prototype.copy=function(t,e,n,r,i){return new Ws(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ws.prototype.et=function(){return!1},Ws.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},Ws.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},Ws.prototype.min=function(){return this.left.et()?this:this.left.min()},Ws.prototype.Jt=function(){return this.min().key},Ws.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},Ws.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},Ws.prototype.he=function(){if(this.left.et())return Ws.EMPTY;var t=this;return(t=(t=t.left.le()||t.left.left.le()?t:t._e()).copy(null,null,null,t.left.he(),null)).ue()},Ws.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=r.left.et()||r.left.le()||r.left.left.le()?r:r._e()).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=(r=r.left.le()?r.fe():r).right.et()||r.right.le()||r.right.left.le()?r:r.de()).key)){if(r.right.et())return Ws.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.he())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.ue()},Ws.prototype.le=function(){return this.color},Ws.prototype.ue=function(){var t=this;return(t=(t=t.right.le()&&!t.left.le()?t.we():t).left.le()&&t.left.left.le()?t.fe():t).left.le()&&t.right.le()?t.Ee():t},Ws.prototype._e=function(){var t=this.Ee();return t.right.left.le()?(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee():t},Ws.prototype.de=function(){var t=this.Ee();return t.left.left.le()?(t=t.fe()).Ee():t},Ws.prototype.we=function(){var t=this.copy(null,null,Ws.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ws.prototype.fe=function(){var t=this.copy(null,null,Ws.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ws.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ws.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},Ws.prototype.Ie=function(){if(this.le()&&this.left.le())throw Ar();if(this.right.le())throw Ar();var t=this.left.Ie();if(t!==this.right.Ie())throw Ar();return t+(this.le()?0:1)},Ws);function Ws(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ws.RED,this.left=null!=r?r:Ws.EMPTY,this.right=null!=i?i:Ws.EMPTY,this.size=this.left.size+1+this.right.size}function Js(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}function Zs(t,e){this.H=t,this.root=e||Xs.EMPTY}function $s(){this.size=0}Xs.EMPTY=null,Xs.RED=!0,Xs.Ht=!1,Xs.EMPTY=(Object.defineProperty($s.prototype,"key",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"value",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"color",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"left",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"right",{get:function(){throw Ar()},enumerable:!1,configurable:!0}),$s.prototype.copy=function(t,e,n,r,i){return this},$s.prototype.zt=function(t,e,n){return new Xs(t,e)},$s.prototype.remove=function(t,e){return this},$s.prototype.et=function(){return!0},$s.prototype.Xt=function(t){return!1},$s.prototype.Zt=function(t){return!1},$s.prototype.Jt=function(){return null},$s.prototype.Yt=function(){return null},$s.prototype.le=function(){return!1},$s.prototype.Te=function(){return!0},$s.prototype.Ie=function(){return 0},new $s);var tu=(iu.prototype.has=function(t){return null!==this.data.get(t)},iu.prototype.first=function(){return this.data.Jt()},iu.prototype.last=function(){return this.data.Yt()},Object.defineProperty(iu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),iu.prototype.indexOf=function(t){return this.data.indexOf(t)},iu.prototype.forEach=function(n){this.data.Xt(function(t,e){return n(t),!1})},iu.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(0<=this.H(r.key,t[1]))return;e(r.key)}},iu.prototype.Ae=function(t,e){for(var n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},iu.prototype.Re=function(t){return(t=this.data.ee(t)).ce()?t.oe().key:null},iu.prototype.te=function(){return new eu(this.data.te())},iu.prototype.ee=function(t){return new eu(this.data.ee(t))},iu.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},iu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},iu.prototype.et=function(){return this.data.et()},iu.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},iu.prototype.isEqual=function(t){if(!(t instanceof iu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.te(),n=t.data.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(0!==this.H(r,i))return!1}return!0},iu.prototype.it=function(){var e=[];return this.forEach(function(t){e.push(t)}),e},iu.prototype.toString=function(){var e=[];return this.forEach(function(t){return e.push(t)}),"SortedSet("+e.toString()+")"},iu.prototype.copy=function(t){var e=new iu(this.H);return e.data=t,e},iu),eu=(ru.prototype.oe=function(){return this.ye.oe().key},ru.prototype.ce=function(){return this.ye.ce()},ru),nu=new Ys(ui.H);function ru(t){this.ye=t}function iu(t){this.H=t,this.data=new Ys(this.H)}var ou=new Ys(ui.H),su=new Ys(ui.H),uu=new tu(ui.H);function au(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=uu,r=0,i=t;r<i.length;r++)var o=i[r],n=n.add(o);return n}var cu=new tu(Or),hu=(Au.pe=function(t){return new Au(t.H)},Au.prototype.has=function(t){return null!=this.ge.get(t)},Au.prototype.get=function(t){return this.ge.get(t)},Au.prototype.first=function(){return this.Ve.Jt()},Au.prototype.last=function(){return this.Ve.Yt()},Au.prototype.et=function(){return this.Ve.et()},Au.prototype.indexOf=function(t){return(t=this.ge.get(t))?this.Ve.indexOf(t):-1},Object.defineProperty(Au.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),Au.prototype.forEach=function(n){this.Ve.Xt(function(t,e){return n(t),!1})},Au.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},Au.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},Au.prototype.isEqual=function(t){if(!(t instanceof Au))return!1;if(this.size!==t.size)return!1;for(var e=this.Ve.te(),n=t.Ve.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(!r.isEqual(i))return!1}return!0},Au.prototype.toString=function(){var e=[];return this.forEach(function(t){e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},Au.prototype.copy=function(t,e){var n=new Au;return n.H=this.H,n.ge=t,n.Ve=e,n},Au),fu=(Nu.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);!n||0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):Ar()},Nu.prototype.ve=function(){var n=[];return this.be.Xt(function(t,e){n.push(e)}),n},Nu),lu=(Tu.Ne=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Tu(t,e,hu.pe(e),i,n,r,!0,!1)},Object.defineProperty(Tu.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),Tu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Qo(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Tu),pu=(Iu.Me=function(t,e){var n=new Map;return n.set(t,du.Le(t,e)),new Iu(ri.min(),n,cu,nu,au())},Iu),du=(Eu.Le=function(t,e){return new Eu(Cr.T,e,au(),au(),au())},Eu),yu=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},vu=function(t,e){this.targetId=t,this.je=e},gu=function(t,e,n,r){void 0===n&&(n=Cr.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},mu=(Object.defineProperty(_u.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),_u.prototype.tn=function(t){0<t.l()&&(this.Ye=!0,this.He=t)},_u.prototype.en=function(){var n=au(),r=au(),i=au();return this.ze.forEach(function(t,e){switch(e){case 0:n=n.add(t);break;case 2:r=r.add(t);break;case 1:i=i.add(t);break;default:Ar()}}),new du(this.He,this.Je,n,r,i)},_u.prototype.nn=function(){this.Ye=!1,this.ze=xu()},_u.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},_u.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},_u.prototype.on=function(){this.Ge+=1},_u.prototype.cn=function(){--this.Ge},_u.prototype.an=function(){this.Ye=!0,this.Je=!0},_u),bu=(wu.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof Yi?this.wn(r,t.We):t.We instanceof Ki&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},wu.prototype.Tn=function(n){var r=this;this.In(n,function(t){var e=r.mn(t);switch(n.state){case 0:r.An(t)&&e.tn(n.resumeToken);break;case 1:e.cn(),e.Xe||e.nn(),e.tn(n.resumeToken);break;case 2:e.cn(),e.Xe||r.removeTarget(t);break;case 3:r.An(t)&&(e.an(),e.tn(n.resumeToken));break;case 4:r.An(t)&&(r.Rn(t),e.tn(n.resumeToken));break;default:Ar()}})},wu.prototype.In=function(t,n){var r=this;0<t.targetIds.length?t.targetIds.forEach(n):this.hn.forEach(function(t,e){r.An(e)&&n(e)})},wu.prototype.Pn=function(t){var e=t.targetId,n=t.je.count;(t=this.yn(e))&&(ro(t=t.target)?0===n?(t=new ui(t.path),this.En(e,t,new Ki(t,ri.min()))):Sr(1===n):this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e)))},wu.prototype.Vn=function(r){var i=this,o=new Map;this.hn.forEach(function(t,e){var n=i.yn(e);n&&(t.Be&&ro(n.target)&&(n=new ui(n.target.path),null!==i.ln.get(n)||i.pn(e,n)||i.En(e,n,new Ki(n,r))),t.Ze&&(o.set(e,t.en()),t.nn()))});var s=au();this._n.forEach(function(t,e){var n=!0;e.Ae(function(t){return!(t=i.yn(t))||2===t.Ft||(n=!1)}),n&&(s=s.add(t))});var t=new pu(r,o,this.fn,this.ln,s);return this.ln=nu,this._n=Su(),this.fn=new tu(Or),t},wu.prototype.wn=function(t,e){var n;this.An(t)&&(n=this.pn(t,e.key)?2:0,this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t)))},wu.prototype.En=function(t,e,n){var r;this.An(t)&&(r=this.mn(t),this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n)))},wu.prototype.removeTarget=function(t){this.hn.delete(t)},wu.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},wu.prototype.on=function(t){this.mn(t).on()},wu.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new mu,this.hn.set(t,e)),e},wu.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new tu(Or),this._n=this._n.zt(t,e)),e},wu.prototype.An=function(t){var e=null!==this.yn(t);return e||Er("WatchChangeAggregator","Detected inactive target",t),e},wu.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},wu.prototype.Rn=function(e){var n=this;this.hn.set(e,new mu),this.un.vn(e).forEach(function(t){n.En(e,t,null)})},wu.prototype.pn=function(t,e){return this.un.vn(t).has(e)},wu);function wu(t){this.un=t,this.hn=new Map,this.ln=nu,this._n=Su(),this.fn=new tu(Or)}function _u(){this.Ge=0,this.ze=xu(),this.He=Cr.T,this.Je=!1,this.Ye=!0}function Eu(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}function Iu(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}function Tu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}function Nu(){this.be=new Ys(ui.H)}function Au(n){this.H=n?function(t,e){return n(t,e)||ui.H(t.key,e.key)}:function(t,e){return ui.H(t.key,e.key)},this.ge=ou,this.Ve=new Ys(this.H)}function Su(){return new Ys(ui.H)}function xu(){return new Ys(ui.H)}var Du={asc:"ASCENDING",desc:"DESCENDING"},Ou={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ku=function(t,e){this.t=t,this.Bt=e};function Pu(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cu(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function Lu(t){return Sr(!!t),ri.K((t=wi(t),new ni(t.seconds,t.nanos)))}function Ru(t,e){return new ii(["projects",t.projectId,"databases",t.database]).child("documents").child(e).rt()}function Vu(t){return Sr(ta(t=ii.ot(t))),t}function Mu(t,e){return Ru(t.t,e.path)}function Uu(t,e){if((e=Vu(e)).get(1)!==t.t.projectId)throw new Mr(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Mr(Vr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ui(Bu(e))}function ju(t,e){return Ru(t.t,e)}function Fu(t){return 4===(t=Vu(t)).length?ii.ct():Bu(t)}function qu(t){return new ii(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Bu(t){return Sr(4<t.length&&"documents"===t.get(4)),t.Y(5)}function Gu(t,e,n){return{name:Mu(t,e),fields:n.proto.mapValue.fields}}function zu(t,e,n){var r=Uu(t,e.name),t=Lu(e.updateTime),e=new Fi({mapValue:{fields:e.fields}});return new Yi(r,t,e,{hasCommittedMutations:!!n})}function Hu(t,e){var n,r,i;if(e instanceof Ds)n={update:Gu(t,e.key,e.value)};else if(e instanceof qs)n={delete:Mu(t,e.key)};else if(e instanceof Os)n={update:Gu(t,e.key,e.data),updateMask:(i=e.Gt,r=[],i.fields.forEach(function(t){return r.push(t.rt())}),{fieldPaths:r})};else{if(!(e instanceof Bs))return Ar();n={verify:Mu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof os)return{fieldPath:t.field.rt(),setToServerValue:"REQUEST_TIME"};if(e instanceof ss)return{fieldPath:t.field.rt(),appendMissingElements:{values:e.elements}};if(e instanceof fs)return{fieldPath:t.field.rt(),removeAllFromArray:{values:e.elements}};if(e instanceof ys)return{fieldPath:t.field.rt(),increment:e.Ut};throw Ar()})),e.jt.Wt||(n.currentDocument=void 0!==(i=e.jt).updateTime?{updateTime:Pu(e=t,(t=i.updateTime).j())}:void 0!==i.exists?{exists:i.exists}:Ar()),n}function Qu(i,t){var e=t.currentDocument?void 0!==(s=t.currentDocument).updateTime?_s.updateTime(Lu(s.updateTime)):void 0!==s.exists?_s.exists(s.exists):_s.Kt():_s.Kt(),n=t.updateTransforms?t.updateTransforms.map(function(t){return e=i,r=null,"setToServerValue"in(t=t)?(Sr("REQUEST_TIME"===t.setToServerValue),r=new os):"appendMissingElements"in t?(n=t.appendMissingElements.values||[],r=new ss(n)):"removeAllFromArray"in t?(n=t.removeAllFromArray.values||[],r=new fs(n)):"increment"in t?r=new ys(e,t.increment):Ar(),t=si.lt(t.fieldPath),new ws(t,r);var e,n,r}):[];if(t.update){t.update.name;var r=Uu(i,t.update.name),o=new Fi({mapValue:{fields:t.update.fields}});if(t.updateMask){var s=(s=t.updateMask.fieldPaths||[],new gi(s.map(function(t){return si.lt(t)})));return new Os(r,o,s,e,n)}return new Ds(r,o,e,n)}return t.delete?(n=Uu(i,t.delete),new qs(n,e)):t.verify?(t=Uu(i,t.verify),new Bs(t,e)):Ar()}function Yu(t,e){return{documents:[ju(t,e.path)]}}function Ku(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=ju(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ju(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Ui(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NAN"}};if(Mi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Ui(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NOT_NAN"}};if(Mi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zu(t.field),op:(e=t.op,Ou[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:Zu(t.field),direction:(t=t.dir,Du[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Bt||Ni(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Wu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Wu(e.endAt)),n}function Xu(t){var e=Fu(t.parent),n=t.structuredQuery,r=null;0<(s=n.from?n.from.length:0)&&(Sr(1===s),(u=n.from[0]).allDescendants?r=u.collectionId:e=e.child(u.collectionId));var i=[];n.where&&(i=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=$u(t.unaryFilter.field);return oo.create(e,"==",{doubleValue:NaN});case"IS_NULL":return e=$u(t.unaryFilter.field),oo.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=$u(t.unaryFilter.field);return oo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return n=$u(t.unaryFilter.field),oo.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Ar()}}(e)]:void 0!==e.fieldFilter?[(n=e,oo.create($u(n.fieldFilter.field),function(){switch(n.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Ar()}}(),n.fieldFilter.value))]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(t).reduce(function(t,e){return t.concat(e)}):Ar():[];var n}(n.where));var o=[],t=null,s=null,u=null;return Vo(e,r,o=n.orderBy?n.orderBy.map(function(t){return new Po($u((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}):o,i,t=n.limit?Ni(i="object"==typeof(i=n.limit)?i.value:i)?null:i:t,"F",s=n.startAt?Ju(n.startAt):s,u=n.endAt?Ju(n.endAt):u)}function Wu(t){return{before:t.before,values:t.position}}function Ju(t){var e=!!t.before,t=t.values||[];return new Ao(t,e)}function Zu(t){return{fieldPath:t.rt()}}function $u(t){return si.lt(t.fieldPath)}function ta(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var ea,na=function(){var n=this;this.promise=new Promise(function(t,e){n.resolve=t,n.reject=e})},ra=(la.prototype.catch=function(t){return this.next(void 0,t)},la.prototype.next=function(r,i){var o=this;return this.Nn&&Ar(),this.Nn=!0,this.xn?this.error?this.$n(i,this.error):this.Fn(r,this.result):new la(function(e,n){o.Dn=function(t){o.Fn(r,t).next(e,n)},o.Cn=function(t){o.$n(i,t).next(e,n)}})},la.prototype.On=function(){var n=this;return new Promise(function(t,e){n.next(t,e)})},la.prototype.kn=function(t){try{var e=t();return e instanceof la?e:la.resolve(e)}catch(t){return la.reject(t)}},la.prototype.Fn=function(t,e){return t?this.kn(function(){return t(e)}):la.resolve(e)},la.prototype.$n=function(t,e){return t?this.kn(function(){return t(e)}):la.reject(e)},la.resolve=function(n){return new la(function(t,e){t(n)})},la.reject=function(n){return new la(function(t,e){e(n)})},la.Mn=function(t){return new la(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},la.Ln=function(t){for(var n=la.resolve(!1),e=0,r=t;e<r.length;e++)!function(e){n=n.next(function(t){return t?la.resolve(t):e()})}(r[e]);return n},la.forEach=function(t,n){var r=this,i=[];return t.forEach(function(t,e){i.push(n.call(r,t,e))}),this.Mn(i)},la),ia=(fa.open=function(t,e,n,r){try{return new fa(e,t.transaction(r,n))}catch(t){throw new ua(e,t)}},Object.defineProperty(fa.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),fa.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(Er("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},fa.prototype.store=function(t){return t=this.transaction.objectStore(t),new da(t)},fa),oa=(ha.delete=function(t){return Er("SimpleDb","Removing database:",t),va(window.indexedDB.deleteDatabase(t)).On()},ha.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(ha.Wn())return!0;var t=p(),e=0<(n=ha.Qn(t))&&n<10,n=0<(n=ha.jn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},ha.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},ha.zn=function(t,e){return t.store(e)},ha.Qn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},ha.jn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},ha.prototype.Hn=function(o){return y(this,void 0,void 0,function(){var e,i=this;return v(this,function(t){switch(t.label){case 0:return this.db?[3,2]:(Er("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,n){var r=indexedDB.open(i.name,i.version);r.onsuccess=function(t){t=t.target.result,e(t)},r.onblocked=function(){n(new ua(o,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=function(t){"VersionError"===(t=t.target.error).name?n(new Mr(Vr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):n(new ua(o,t))},r.onupgradeneeded=function(t){Er("SimpleDb",'Database "'+i.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;i.Un.Jn(e,r.transaction,t.oldVersion,i.version).next(function(){Er("SimpleDb","Database upgrade to version "+i.version+" complete")})}})]);case 1:e.db=t.sent(),t.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return i.Yn(t)}),this.db)]}})})},ha.prototype.Xn=function(e){this.Yn=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},ha.prototype.runTransaction=function(u,n,a,c){return y(this,void 0,void 0,function(){var i,o,s,e;return v(this,function(t){switch(t.label){case 0:i="readonly"===n,o=0,e=function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:++o,t.label=1;case 1:return t.trys.push([1,4,,5]),[4,s.Hn(u)];case 2:return s.db=t.sent(),e=ia.open(s.db,u,i?"readonly":"readwrite",a),n=c(e).catch(function(t){return e.abort(t),ra.reject(t)}).On(),r={},n.catch(function(){}),[4,e.qn];case 3:return[2,(r.value=(t.sent(),n),r)];case 4:return n=t.sent(),r="FirebaseError"!==n.name&&o<3,Er("SimpleDb","Transaction failed with error:",n.message,"Retrying:",r),s.close(),r?[3,5]:[2,{value:Promise.reject(n)}];case 5:return[2]}})},s=this,t.label=1;case 1:return[5,e()];case 2:if("object"==typeof(e=t.sent()))return[2,e.value];t.label=3;case 3:return[3,1];case 4:return[2]}})})},ha.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ha),sa=(Object.defineProperty(ca.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),ca.prototype.done=function(){this.ts=!0},ca.prototype.ss=function(t){this.es=t},ca.prototype.delete=function(){return va(this.Zn.delete())},ca),ua=(h(aa,ea=Mr),aa);function aa(t,e){var n=this;return(n=ea.call(this,Vr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ca(t){this.Zn=t,this.ts=!1,this.es=null}function ha(t,e,n){this.name=t,this.version=e,this.Un=n,12.2===ha.Qn(p())&&Ir("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function fa(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.Bn=new na,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){t.error?n.Bn.reject(new ua(e,t.error)):n.Bn.resolve()},this.transaction.onerror=function(t){t=ma(t.target.error),n.Bn.reject(new ua(e,t))}}function la(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t(function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)},function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)})}function pa(t){return"IndexedDbTransactionError"===t.name}var da=(ya.prototype.put=function(t,e){return va(t=void 0!==e?(Er("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Er("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},ya.prototype.add=function(t){return Er("SimpleDb","ADD",this.store.name,t,t),va(this.store.add(t))},ya.prototype.get=function(e){var n=this;return va(this.store.get(e)).next(function(t){return void 0===t&&(t=null),Er("SimpleDb","GET",n.store.name,e,t),t})},ya.prototype.delete=function(t){return Er("SimpleDb","DELETE",this.store.name,t),va(this.store.delete(t))},ya.prototype.count=function(){return Er("SimpleDb","COUNT",this.store.name),va(this.store.count())},ya.prototype.rs=function(t,e){var e=this.cursor(this.options(t,e)),n=[];return this.os(e,function(t,e){n.push(e)}).next(function(){return n})},ya.prototype.cs=function(t,e){return Er("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).us=!1,e=this.cursor(e),this.os(e,function(t,e,n){return n.delete()})},ya.prototype.hs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.os(n,e)},ya.prototype.ls=function(r){var t=this.cursor({});return new ra(function(n,e){t.onerror=function(t){t=ma(t.target.error),e(t)},t.onsuccess=function(t){var e=t.target.result;e?r(e.primaryKey,e.value).next(function(t){t?e.continue():n()}):n()}})},ya.prototype.os=function(t,i){var o=[];return new ra(function(r,e){t.onerror=function(t){e(t.target.error)},t.onsuccess=function(t){var e,n=t.target.result;n?(e=new sa(n),(t=i(n.primaryKey,n.value,e))instanceof ra&&(t=t.catch(function(t){return e.done(),ra.reject(t)}),o.push(t)),e.xn?r():null===e.ns?n.continue():n.continue(e.ns)):r()}}).next(function(){return ra.Mn(o)})},ya.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ya.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ya);function ya(t){this.store=t}function va(t){return new ra(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=ma(t.target.error),n(t)}})}var ga=!1;function ma(t){var e=oa.Qn(p());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Mr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ga||(ga=!0,setTimeout(function(){throw n},0)),n}return t}var ba=(wa.Ts=function(t,e,n,r,i){return(i=new wa(t,e,Date.now()+n,r,i)).start(n),i},wa.prototype.start=function(t){var e=this;this.Is=setTimeout(function(){return e.As()},t)},wa.prototype.Rs=function(){return this.As()},wa.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new Mr(Vr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},wa.prototype.As=function(){var e=this;this._s.Ps(function(){return null!==e.Is?(e.clearTimeout(),e.op().then(function(t){return e.Es.resolve(t)})):Promise.resolve()})},wa.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},wa);function wa(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new na,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}function _a(t,e){if(Ir("AsyncQueue",e+": "+t),pa(t))return new Mr(Vr.UNAVAILABLE,e+": "+t);throw t}var Ea="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",o=(Ia.prototype.gs=function(t){this.ys.push(t)},Ia.prototype.Vs=function(){this.ys.forEach(function(t){return t()})},Ia);function Ia(){this.ys=[]}function Ta(t){for(var o="",e=0;e<t.length;e++)0<o.length&&(o=Na(o)),o=function(t){for(var e=o,n=t.length,r=0;r<n;r++){var i=t.charAt(r);switch(i){case"\0":e+="";break;case"":e+="";break;default:e+=i}}return e}(t.get(e));return Na(o)}function Na(t){return t+""}function Aa(t){var e=t.length;if(Sr(2<=e),2===e)return Sr(""===t.charAt(0)&&""===t.charAt(1)),ii.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Ar(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Ar()}o=s+2}return new ii(r)}function Sa(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var xa=function(t,e){this.seconds=t,this.nanoseconds=e};function Da(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}function Oa(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}Sa.store="owner",Sa.key="owner",Da.store="mutationQueues",Da.keyPath="userId",Oa.store="mutations",Oa.keyPath="batchId",Oa.userMutationsIndex="userMutationsIndex",Oa.userMutationsKeyPath=["userId","batchId"];var ka=(Pa.prefixForUser=function(t){return[t]},Pa.prefixForPath=function(t,e){return[t,Ta(e)]},Pa.key=function(t,e,n){return[t,Ta(e),n]},Pa);function Pa(){}function Ca(t,e){this.path=t,this.readTime=e}function La(t,e){this.path=t,this.version=e}ka.store="documentMutations",ka.PLACEHOLDER=new ka;var Ra=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};function Va(t){this.byteSize=t}function Ma(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Ra.store="remoteDocuments",Ra.readTimeIndex="readTimeIndex",Ra.readTimeIndexPath="readTime",Ra.collectionReadTimeIndex="collectionReadTimeIndex",Ra.collectionReadTimeIndexPath=["parentPath","readTime"],Va.store="remoteDocumentGlobal",Va.key="remoteDocumentGlobalKey",Ma.store="targets",Ma.keyPath="targetId",Ma.queryTargetsIndexName="queryTargetsIndex",Ma.queryTargetsKeyPath=["canonicalId","targetId"];var Ua=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};function ja(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function Fa(t,e){this.collectionId=t,this.parent=e}function qa(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}function Ba(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}function Ga(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}Ua.store="targetDocuments",Ua.keyPath=["targetId","path"],Ua.documentTargetsIndex="documentTargetsIndex",Ua.documentTargetsKeyPath=["path","targetId"],ja.key="targetGlobalKey",ja.store="targetGlobal",Fa.store="collectionParents",Fa.keyPath=["collectionId","parent"],qa.store="clientMetadata",qa.keyPath="clientId",Ba.store="bundles",Ba.keyPath="bundleId",Ga.store="namedQueries",Ga.keyPath="name";var za,Ha=f(f(f(f([Da.store,Oa.store,ka.store,Ra.store,Ma.store,Sa.store,ja.store,Ua.store],[qa.store]),[Va.store]),[Fa.store]),[Ba.store,Ga.store]),Qa=(h(Ya,za=o),Ya);function Ya(t,e){var n=this;return(n=za.call(this)||this).ps=t,n.bs=e,n}function Ka(t,e){return oa.zn(t.ps,e)}var Xa=($a.prototype.Ss=function(t,e,n){for(var r,i,o,s,u,a,c=n.Ds,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,s=e,i=c[h],f=a=u=void 0,e=r instanceof Ds?(u=i,a=(o=r).value,f=Ls(o.fieldTransforms,s,u.transformResults),a=Vs(o.fieldTransforms,a,f),new Yi(o.key,u.version,a,{hasCommittedMutations:!0})):r instanceof Os?(u=s,a=i,Is((s=r).jt,u)?(u=Cs(s,u,Ls(s.fieldTransforms,u,a.transformResults)),new Yi(s.key,a.version,u,{hasCommittedMutations:!0})):new Xi(s.key,a.version)):new Ki(r.key,i.version,{hasCommittedMutations:!0}))}return e},$a.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Ts(i,e,this.vs));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Ts(i,e,this.vs));return e},$a.prototype.xs=function(n){var r=this,i=n;return this.mutations.forEach(function(t){var e=r.Cs(t.key,n.get(t.key));e&&(i=i.zt(t.key,e))}),i},$a.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},au())},$a.prototype.isEqual=function(t){return this.batchId===t.batchId&&kr(this.mutations,t.mutations,Ns)&&kr(this.baseMutations,t.baseMutations,Ns)},$a),Wa=(Za.from=function(t,e,n){Sr(t.mutations.length===n.length);for(var r=su,i=t.mutations,o=0;o<i.length;o++)r=r.zt(i[o].key,n[o].version);return new Za(t,e,n,r)},Za),Ja=function(t){this.Fs=t};function Za(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}function $a(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}function tc(t,e){if(e.document)return zu(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ui.Et(e.noDocument.path),r=oc(e.noDocument.readTime);return new Ki(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=ui.Et(e.unknownDocument.path),r=oc(e.unknownDocument.version),new Xi(n,r)):Ar()}function ec(t,e,n){var r=nc(n),n=e.key.path.X().it();if(e instanceof Yi){var i={name:Mu(o=t.Fs,(s=e).key),fields:s.bt().mapValue.fields,updateTime:Pu(o,s.version.j())},o=e.hasCommittedMutations;return new Ra(null,null,i,o,r,n)}if(e instanceof Ki){var s=e.key.path.it(),i=ic(e.version),o=e.hasCommittedMutations;return new Ra(null,new Ca(s,i),null,o,r,n)}return e instanceof Xi?(o=e.key.path.it(),e=ic(e.version),new Ra(new La(o,e),null,null,!0,r,n)):Ar()}function nc(t){return[(t=t.j()).seconds,t.nanoseconds]}function rc(t){return t=new ni(t[0],t[1]),ri.K(t)}function ic(t){return t=t.j(),new xa(t.seconds,t.nanoseconds)}function oc(t){return t=new ni(t.seconds,t.nanoseconds),ri.K(t)}function sc(e,t){for(var n=(t.baseMutations||[]).map(function(t){return Qu(e.Fs,t)}),r=0;r<t.mutations.length-1;++r){var i,o=t.mutations[r];r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform&&(i=t.mutations[r+1],o.updateTransforms=i.transform.fieldTransforms,t.mutations.splice(r+1,1),++r)}var s=t.mutations.map(function(t){return Qu(e.Fs,t)}),u=ni.fromMillis(t.localWriteTimeMs);return new Xa(t.batchId,u,n,s)}function uc(t){var e=oc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?oc(t.lastLimboFreeSnapshotVersion):ri.min(),r=void 0!==t.query.documents?(Sr(1===(r=t.query).documents.length),zo(Mo(Fu(r.documents[0])))):zo(Xu(t.query));return new Jo(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Cr.fromBase64String(t.resumeToken))}function ac(t,e){var n=ic(e.Ot),r=ic(e.lastLimboFreeSnapshotVersion),i=(ro(e.target)?Yu:Ku)(t.Fs,e.target),t=e.resumeToken.toBase64();return new Ma(e.targetId,eo(e.target),n,t,e.sequenceNumber,r,i)}function cc(t){var e=Xu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Ho(e,e.limit,"L"):e}var hc=(fc.prototype.Os=function(t,e){return lc(t).get(e).next(function(t){if(t)return{id:t.bundleId,createTime:oc(t.createTime),version:t.version}})},fc.prototype.ks=function(t,e){return lc(t).put({bundleId:e.id,createTime:ic(Lu(e.createTime)),version:e.version})},fc.prototype.Ms=function(t,e){return pc(t).get(e).next(function(t){if(t)return{name:t.name,query:cc(t.bundledQuery),readTime:oc(t.readTime)}})},fc.prototype.Ls=function(t,e){return pc(t).put({name:e.name,readTime:ic(Lu(e.readTime)),bundledQuery:e.bundledQuery})},fc);function fc(){}function lc(t){return Ka(t,Ba.store)}function pc(t){return Ka(t,Ga.store)}var dc=(bc.prototype.qs=function(t,e){return this.Bs.add(e),ra.resolve()},bc.prototype.Us=function(t,e){return ra.resolve(this.Bs.getEntries(e))},bc),yc=(mc.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new tu(ii.H),t=!r.has(n);return this.index[e]=r.add(n),t},mc.prototype.has=function(t){var e=t.tt(),t=t.X();return(e=this.index[e])&&e.has(t)},mc.prototype.getEntries=function(t){return(this.index[t]||new tu(ii.H)).it()},mc),vc=(gc.prototype.qs=function(t,e){var n=this;if(this.Qs.has(e))return ra.resolve();var r=e.tt(),i=e.X();return t.gs(function(){n.Qs.add(e)}),i={collectionId:r,parent:Ta(i)},wc(t).put(i)},gc.prototype.Us=function(t,i){var o=[],e=IDBKeyRange.bound([i,""],[Pr(i),""],!1,!0);return wc(t).rs(e).next(function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(r.collectionId!==i)break;o.push(Aa(r.parent))}return o})},gc);function gc(){this.Qs=new yc}function mc(){this.index={}}function bc(){this.Bs=new yc}function wc(t){return Ka(t,Fa.store)}var _c={Ks:!1,Ws:0,js:0,Gs:0},Ec=(Ic.Ys=function(t){return new Ic(t,Ic.Xs,Ic.Zs)},Ic);function Ic(t,e,n){this.zs=t,this.Hs=e,this.Js=n}function Tc(e){return y(this,void 0,void 0,function(){return v(this,function(t){if(e.code!==Vr.FAILED_PRECONDITION||e.message!==Ea)throw e;return Er("LocalStore","Unexpectedly lost primary lease"),[2]})})}Ec.Xs=10,Ec.Zs=1e3,Ec.ti=new Ec(41943040,Ec.Xs,Ec.Zs),Ec.ei=new Ec(-1,0,0);var Nc=(Sc.prototype.get=function(t){var e=this.ni(t);if(void 0!==(e=this.ii[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.si(i,t))return o}},Sc.prototype.has=function(t){return void 0!==this.get(t)},Sc.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},Sc.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},Sc.prototype.forEach=function(s){yi(this.ii,function(t,e){for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];s(i,o)}})},Sc.prototype.et=function(){return vi(this.ii)},Sc),me=(Ac.prototype.ci=function(t){return(t=this.ri.get(t))?t.readTime:ri.min()},Ac.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},Ac.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},Ac.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?ra.resolve(n.hi):this.fi(t,e)},Ac.prototype.getEntries=function(t,e){return this.di(t,e)},Ac.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},Ac.prototype.ui=function(){},Ac);function Ac(){this.ri=new Nc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.oi=!1}function Sc(t,e){this.ni=t,this.si=e,this.ii={}}function xc(t,e,n){var r=t.store(Oa.store),i=t.store(ka.store),o=[],t=IDBKeyRange.only(n.batchId),s=0,t=r.hs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Sr(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=ka.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ra.Mn(o).next(function(){return u})}function Dc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Ar();e=t.noDocument}return JSON.stringify(e).length}var Oc=(kc.mi=function(t,e,n,r){return Sr(""!==t.uid),new kc(t.m()?t.uid:"",e,n,r)},kc.prototype.Ai=function(t){var r=!0,e=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cc(t).hs({index:Oa.userMutationsIndex,range:e},function(t,e,n){r=!1,n.done()}).next(function(){return r})},kc.prototype.Ri=function(d,y,v,g){var m=this,b=Lc(d),w=Cc(d);return w.add({}).next(function(t){Sr("number"==typeof t);for(var e,n,r,i,o,s=new Xa(t,y,v,g),u=(e=m.Qt,n=m.userId,i=(r=s).baseMutations.map(function(t){return Hu(e.Fs,t)}),o=r.mutations.map(function(t){return Hu(e.Fs,t)}),new Oa(n,r.batchId,r.vs.toMillis(),i,o)),a=[],c=new tu(function(t,e){return Or(t.rt(),e.rt())}),h=0,f=g;h<f.length;h++){var l=f[h],p=ka.key(m.userId,l.key.path,t),c=c.add(l.key.path.X());a.push(w.put(u)),a.push(b.put(p,ka.PLACEHOLDER))}return c.forEach(function(t){a.push(m.Ei.qs(d,t))}),d.gs(function(){m.Ii[t]=s.keys()}),ra.Mn(a).next(function(){return s})})},kc.prototype.Pi=function(t,e){var n=this;return Cc(t).get(e).next(function(t){return t?(Sr(t.userId===n.userId),sc(n.Qt,t)):null})},kc.prototype.yi=function(t,e){var n=this;return this.Ii[e]?ra.resolve(this.Ii[e]):this.Pi(t,e).next(function(t){return t?(t=t.keys(),n.Ii[e]=t):null})},kc.prototype.gi=function(t,e){var r=this,i=e+1,e=IDBKeyRange.lowerBound([this.userId,i]),o=null;return Cc(t).hs({index:Oa.userMutationsIndex,range:e},function(t,e,n){e.userId===r.userId&&(Sr(e.batchId>=i),o=sc(r.Qt,e)),n.done()}).next(function(){return o})},kc.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return Cc(t).hs({index:Oa.userMutationsIndex,range:e,reverse:!0},function(t,e,n){r=e.batchId,n.done()}).next(function(){return r})},kc.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Cc(t).rs(Oa.userMutationsIndex,n).next(function(t){return t.map(function(t){return sc(e.Qt,t)})})},kc.prototype.bi=function(o,s){var u=this,t=ka.prefixForPath(this.userId,s.path),t=IDBKeyRange.lowerBound(t),a=[];return Lc(o).hs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Aa(i);if(r===u.userId&&s.path.isEqual(i))return Cc(o).get(t).next(function(t){if(!t)throw Ar();Sr(t.userId===u.userId),a.push(sc(u.Qt,t))});n.done()}).next(function(){return a})},kc.prototype.vi=function(e,t){var s=this,u=new tu(Or),n=[];return t.forEach(function(o){var t=ka.prefixForPath(s.userId,o.path),t=IDBKeyRange.lowerBound(t),t=Lc(e).hs({range:t},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Aa(i);r===s.userId&&o.path.isEqual(i)?u=u.add(t):n.done()});n.push(t)}),ra.Mn(n).next(function(){return s.Si(e,u)})},kc.prototype.Di=function(t,e){var o=this,s=e.path,u=s.length+1,e=ka.prefixForPath(this.userId,s),e=IDBKeyRange.lowerBound(e),a=new tu(Or);return Lc(t).hs({range:e},function(t,e,n){var r=t[0],i=t[1],t=t[2],i=Aa(i);r===o.userId&&s.nt(i)?i.length===u&&(a=a.add(t)):n.done()}).next(function(){return o.Si(t,a)})},kc.prototype.Si=function(e,t){var n=this,r=[],i=[];return t.forEach(function(t){i.push(Cc(e).get(t).next(function(t){if(null===t)throw Ar();Sr(t.userId===n.userId),r.push(sc(n.Qt,t))}))}),ra.Mn(i).next(function(){return r})},kc.prototype.Ci=function(e,n){var r=this;return xc(e.ps,this.userId,n).next(function(t){return e.gs(function(){r.xi(n.batchId)}),ra.forEach(t,function(t){return r.Ti.Ni(e,t)})})},kc.prototype.xi=function(t){delete this.Ii[t]},kc.prototype.$i=function(e){var i=this;return this.Ai(e).next(function(t){if(!t)return ra.resolve();var t=IDBKeyRange.lowerBound(ka.prefixForUser(i.userId)),r=[];return Lc(e).hs({range:t},function(t,e,n){t[0]===i.userId?(t=Aa(t[1]),r.push(t)):n.done()}).next(function(){Sr(0===r.length)})})},kc.prototype.Fi=function(t,e){return Pc(t,this.userId,e)},kc.prototype.Oi=function(t){var e=this;return Rc(t).get(this.userId).next(function(t){return t||new Da(e.userId,-1,"")})},kc);function kc(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}function Pc(t,o,e){var s=(e=ka.prefixForPath(o,e.path))[1],e=IDBKeyRange.lowerBound(e),u=!1;return Lc(t).hs({range:e,us:!0},function(t,e,n){var r=t[0],i=t[1];t[2],r===o&&i===s&&(u=!0),n.done()}).next(function(){return u})}function Cc(t){return Ka(t,Oa.store)}function Lc(t){return Ka(t,ka.store)}function Rc(t){return Ka(t,Da.store)}var Vc=(jc.prototype.next=function(){return this.ki+=2,this.ki},jc.Mi=function(){return new jc(0)},jc.Li=function(){return new jc(-1)},jc),Mc=(Uc.prototype.Bi=function(n){var r=this;return this.qi(n).next(function(t){var e=new Vc(t.highestTargetId);return t.highestTargetId=e.next(),r.Ui(n,t).next(function(){return t.highestTargetId})})},Uc.prototype.Qi=function(t){return this.qi(t).next(function(t){return ri.K(new ni(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Uc.prototype.Ki=function(t){return this.qi(t).next(function(t){return t.highestListenSequenceNumber})},Uc.prototype.Wi=function(e,n,r){var i=this;return this.qi(e).next(function(t){return t.highestListenSequenceNumber=n,r&&(t.lastRemoteSnapshotVersion=r.j()),n>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=n),i.Ui(e,t)})},Uc.prototype.ji=function(e,n){var r=this;return this.Gi(e,n).next(function(){return r.qi(e).next(function(t){return t.targetCount+=1,r.zi(n,t),r.Ui(e,t)})})},Uc.prototype.Hi=function(t,e){return this.Gi(t,e)},Uc.prototype.Ji=function(e,t){var n=this;return this.Yi(e,t.targetId).next(function(){return Fc(e).delete(t.targetId)}).next(function(){return n.qi(e)}).next(function(t){return Sr(0<t.targetCount),--t.targetCount,n.Ui(e,t)})},Uc.prototype.Xi=function(n,r,i){var o=this,s=0,u=[];return Fc(n).hs(function(t,e){(e=uc(e)).sequenceNumber<=r&&null===i.get(e.targetId)&&(s++,u.push(o.Ji(n,e)))}).next(function(){return ra.Mn(u)}).next(function(){return s})},Uc.prototype.In=function(t,n){return Fc(t).hs(function(t,e){e=uc(e),n(e)})},Uc.prototype.qi=function(t){return qc(t).get(ja.key).next(function(t){return Sr(null!==t),t})},Uc.prototype.Ui=function(t,e){return qc(t).put(ja.key,e)},Uc.prototype.Gi=function(t,e){return Fc(t).put(ac(this.Qt,e))},Uc.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Uc.prototype.Zi=function(t){return this.qi(t).next(function(t){return t.targetCount})},Uc.prototype.tr=function(t,r){var e=eo(r),e=IDBKeyRange.bound([e,Number.NEGATIVE_INFINITY],[e,Number.POSITIVE_INFINITY]),i=null;return Fc(t).hs({range:e,index:Ma.queryTargetsIndexName},function(t,e,n){e=uc(e),no(r,e.target)&&(i=e,n.done())}).next(function(){return i})},Uc.prototype.er=function(n,t,r){var i=this,o=[],s=Bc(n);return t.forEach(function(t){var e=Ta(t.path);o.push(s.put(new Ua(r,e))),o.push(i.Ti.nr(n,r,t))}),ra.Mn(o)},Uc.prototype.sr=function(n,t,r){var i=this,o=Bc(n);return ra.forEach(t,function(t){var e=Ta(t.path);return ra.Mn([o.delete([r,e]),i.Ti.ir(n,r,t)])})},Uc.prototype.Yi=function(t,e){return t=Bc(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Uc.prototype.rr=function(t,e){var e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Bc(t),r=au();return t.hs({range:e,us:!0},function(t,e,n){t=Aa(t[1]),t=new ui(t),r=r.add(t)}).next(function(){return r})},Uc.prototype.Fi=function(t,e){var e=Ta(e.path),e=IDBKeyRange.bound([e],[Pr(e)],!1,!0),i=0;return Bc(t).hs({index:Ua.documentTargetsIndex,us:!0,range:e},function(t,e,n){var r=t[0];t[1],0!==r&&(i++,n.done())}).next(function(){return 0<i})},Uc.prototype.Sn=function(t,e){return Fc(t).get(e).next(function(t){return t?uc(t):null})},Uc);function Uc(t,e){this.Ti=t,this.Qt=e}function jc(t){this.ki=t}function Fc(t){return Ka(t,Ma.store)}function qc(t){return Ka(t,ja.store)}function Bc(t){return Ka(t,Ua.store)}function Gc(t,e){var n=t[0],r=t[1],t=e[0],e=e[1];return 0===(t=Or(n,t))?Or(r,e):t}var zc=(Jc.prototype.ur=function(){return++this.ar},Jc.prototype.hr=function(t){var e=[t,this.ur()];this.buffer.size<this.cr?this.buffer=this.buffer.add(e):Gc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Jc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Jc),Hc=(Wc.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},Wc.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(Wc.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),Wc.prototype.wr=function(n){var t=this,e=this._r?3e5:6e4;Er("LruGarbageCollector","Garbage collection scheduled in "+e+"ms"),this.dr=this._s.Tr("lru_garbage_collection",e,function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:this.dr=null,this._r=!0,t.label=1;case 1:return t.trys.push([1,3,,7]),[4,n.Ir(this.lr)];case 2:return t.sent(),[3,7];case 3:return pa(e=t.sent())?(Er("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Tc(e)];case 5:t.sent(),t.label=6;case 6:return[3,7];case 7:return[4,this.wr(n)];case 8:return t.sent(),[2]}})})})},Wc),Qc=(Xc.prototype.Ar=function(t,e){return this.mr.Rr(t).next(function(t){return Math.floor(e/100*t)})},Xc.prototype.Pr=function(t,e){var n=this;if(0===e)return ra.resolve(Kr.q);var r=new zc(e);return this.mr.In(t,function(t){return r.hr(t.sequenceNumber)}).next(function(){return n.mr.yr(t,function(t){return r.hr(t)})}).next(function(){return r.maxValue})},Xc.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},Xc.prototype.gr=function(t,e){return this.mr.gr(t,e)},Xc.prototype.Vr=function(e,n){var r=this;return-1===this.params.zs?(Er("LruGarbageCollector","Garbage collection skipped; disabled"),ra.resolve(_c)):this.pr(e).next(function(t){return t<r.params.zs?(Er("LruGarbageCollector","Garbage collection skipped; Cache size "+t+" is lower than threshold "+r.params.zs),_c):r.br(e,n)})},Xc.prototype.pr=function(t){return this.mr.pr(t)},Xc.prototype.br=function(e,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ar(e,this.params.Hs).next(function(t){return i=t>h.params.Js?(Er("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Js+" from "+t),h.params.Js):t,s=Date.now(),h.Pr(e,i)}).next(function(t){return r=t,u=Date.now(),h.Xi(e,r,n)}).next(function(t){return o=t,a=Date.now(),h.gr(e,r)}).next(function(t){return c=Date.now(),_r()<=l.DEBUG&&Er("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ra.resolve({Ks:!0,Ws:i,js:o,Gs:t})})},Xc),Yc=(Kc.prototype.Rr=function(t){var n=this.vr(t);return this.db.Sr().Zi(t).next(function(e){return n.next(function(t){return e+t})})},Kc.prototype.vr=function(t){var e=0;return this.yr(t,function(t){e++}).next(function(){return e})},Kc.prototype.In=function(t,e){return this.db.Sr().In(t,e)},Kc.prototype.yr=function(t,n){return this.Dr(t,function(t,e){return n(e)})},Kc.prototype.nr=function(t,e,n){return Zc(t,n)},Kc.prototype.ir=function(t,e,n){return Zc(t,n)},Kc.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},Kc.prototype.Ni=Zc,Kc.prototype.Cr=function(t,e){return r=e,i=!1,Rc(n=t).ls(function(t){return Pc(n,t,r).next(function(t){return t&&(i=!0),ra.resolve(!t)})}).next(function(){return i});var n,r,i},Kc.prototype.gr=function(n,r){var i=this,o=this.db.$r().Nr(),s=[],u=0;return this.Dr(n,function(e,t){t<=r&&(t=i.Cr(n,e).next(function(t){if(!t)return u++,o._i(n,e).next(function(){return o.li(e),Bc(n).delete([0,Ta(e.path)])})}),s.push(t))}).next(function(){return ra.Mn(s)}).next(function(){return o.apply(n)}).next(function(){return u})},Kc.prototype.removeTarget=function(t,e){return e=e.kt(t.bs),this.db.Sr().Hi(t,e)},Kc.prototype.Fr=Zc,Kc.prototype.Dr=function(t,r){var i,t=Bc(t),o=Kr.q;return t.hs({index:Ua.documentTargetsIndex},function(t,e){var n=t[0],t=(t[1],e.path),e=e.sequenceNumber;0===n?(o!==Kr.q&&r(new ui(Aa(i)),o),o=e,i=t):o=Kr.q}).next(function(){o!==Kr.q&&r(new ui(Aa(i)),o)})},Kc.prototype.pr=function(t){return this.db.$r().Or(t)},Kc);function Kc(t,e){this.db=t,this.lr=new Qc(this,e)}function Xc(t,e){this.mr=t,this.params=e}function Wc(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}function Jc(t){this.cr=t,this.buffer=new tu(Gc),this.ar=0}function Zc(t,e){return Bc(t).put((t=t.bs,new Ua(0,Ta(e.path),t)))}var $c,th=(rh.prototype.ai=function(t,e,n){return oh(t).put(sh(e),n)},rh.prototype.li=function(t,e){return t=oh(t),e=sh(e),t.delete(e)},rh.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(t){return t.byteSize+=n,r.kr(e,t)})},rh.prototype._i=function(t,e){var n=this;return oh(t).get(sh(e)).next(function(t){return n.Mr(t)})},rh.prototype.Lr=function(t,e){var n=this;return oh(t).get(sh(e)).next(function(t){var e=n.Mr(t);return e?{hi:e,size:Dc(t)}:null})},rh.prototype.getEntries=function(t,e){var n=this,r=nu;return this.Br(t,e,function(t,e){e=n.Mr(e),r=r.zt(t,e)}).next(function(){return r})},rh.prototype.qr=function(t,e){var r=this,i=nu,o=new Ys(ui.H);return this.Br(t,e,function(t,e){var n=r.Mr(e);o=n?(i=i.zt(t,n),o.zt(t,Dc(e))):(i=i.zt(t,null),o.zt(t,0))}).next(function(){return{Ur:i,Qr:o}})},rh.prototype.Br=function(t,e,i){if(e.et())return ra.resolve();var n=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),o=e.te(),s=o.oe();return oh(t).hs({range:n},function(t,e,n){for(var r=ui.Et(t);s&&ui.H(s,r)<0;)i(s,null),s=o.oe();s&&s.isEqual(r)&&(i(s,e),s=o.ce()?o.oe():null),s?n.ss(s.path.it()):n.done()}).next(function(){for(;s;)i(s,null),s=o.ce()?o.oe():null})},rh.prototype.Kr=function(t,r,e){var n,i=this,o=ou,s=r.path.length+1,u={};return e.isEqual(ri.min())?(n=r.path.it(),u.range=IDBKeyRange.lowerBound(n)):(n=r.path.it(),e=nc(e),u.range=IDBKeyRange.lowerBound([n,e],!0),u.index=Ra.collectionReadTimeIndex),oh(t).hs(u,function(t,e,n){t.length===s&&(e=tc(i.Qt,e),r.path.nt(e.key.path)?e instanceof Yi&&Xo(r,e)&&(o=o.zt(e.key,e)):n.done())}).next(function(){return o})},rh.prototype.Nr=function(t){return new eh(this,!!t&&t.Wr)},rh.prototype.Or=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},rh.prototype.getMetadata=function(t){return ih(t).get(Va.key).next(function(t){return Sr(!!t),t})},rh.prototype.kr=function(t,e){return ih(t).put(Va.key,e)},rh.prototype.Mr=function(t){return!t||(t=tc(this.Qt,t))instanceof Ki&&t.version.isEqual(ri.min())?null:t},rh),eh=(h(nh,$c=me),nh.prototype.wi=function(i){var o=this,s=[],u=0,a=new tu(function(t,e){return Or(t.rt(),e.rt())});return this.ri.forEach(function(t,e){var n,r=o.Gr.get(t);e.hi?(n=ec(o.jr.Qt,e.hi,o.ci(t)),a=a.add(t.path.X()),e=Dc(n),u+=e-r,s.push(o.jr.ai(i,t,n))):(u-=r,o.Wr?(r=ec(o.jr.Qt,new Ki(t,ri.min()),o.ci(t)),s.push(o.jr.ai(i,t,r))):s.push(o.jr.li(i,t)))}),a.forEach(function(t){s.push(o.jr.Ei.qs(i,t))}),s.push(this.jr.updateMetadata(i,u)),ra.Mn(s)},nh.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next(function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)})},nh.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next(function(t){var e=t.Ur;return t.Qr.forEach(function(t,e){n.Gr.set(t,e)}),e})},nh);function nh(t,e){var n=this;return(n=$c.call(this)||this).jr=t,n.Wr=e,n.Gr=new Nc(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function rh(t,e){this.Qt=t,this.Ei=e}function ih(t){return Ka(t,Va.store)}function oh(t){return Ka(t,Ra.store)}function sh(t){return t.path.it()}var uh=(ah.prototype.Jn=function(e,n,t,r){var i=this;Sr(t<r&&0<=t&&r<=11);var o=new ia("createOrUpgrade",n);t<1&&1<=r&&(e.createObjectStore(Sa.store),(s=e).createObjectStore(Da.store,{keyPath:Da.keyPath}),s.createObjectStore(Oa.store,{keyPath:Oa.keyPath,autoIncrement:!0}).createIndex(Oa.userMutationsIndex,Oa.userMutationsKeyPath,{unique:!0}),s.createObjectStore(ka.store),ch(e),e.createObjectStore(Ra.store));var s,u=ra.resolve();return t<3&&3<=r&&(0!==t&&((s=e).deleteObjectStore(Ua.store),s.deleteObjectStore(Ma.store),s.deleteObjectStore(ja.store),ch(e)),u=u.next(function(){return t=o.store(ja.store),e=new ja(0,0,ri.min().j(),0),t.put(ja.key,e);var t,e})),t<4&&4<=r&&(u=(u=0!==t?u.next(function(){return n=e,(r=o).store(Oa.store).rs().next(function(t){n.deleteObjectStore(Oa.store),n.createObjectStore(Oa.store,{keyPath:Oa.keyPath,autoIncrement:!0}).createIndex(Oa.userMutationsIndex,Oa.userMutationsKeyPath,{unique:!0});var e=r.store(Oa.store),t=t.map(function(t){return e.put(t)});return ra.Mn(t)});var n,r}):u).next(function(){e.createObjectStore(qa.store,{keyPath:qa.keyPath})})),t<5&&5<=r&&(u=u.next(function(){return i.zr(o)})),t<6&&6<=r&&(u=u.next(function(){return e.createObjectStore(Va.store),i.Hr(o)})),t<7&&7<=r&&(u=u.next(function(){return i.Jr(o)})),t<8&&8<=r&&(u=u.next(function(){return i.Yr(e,o)})),t<9&&9<=r&&(u=u.next(function(){var t;(t=e).objectStoreNames.contains("remoteDocumentChanges")&&t.deleteObjectStore("remoteDocumentChanges"),(t=n.objectStore(Ra.store)).createIndex(Ra.readTimeIndex,Ra.readTimeIndexPath,{unique:!1}),t.createIndex(Ra.collectionReadTimeIndex,Ra.collectionReadTimeIndexPath,{unique:!1})})),t<10&&10<=r&&(u=u.next(function(){return i.Xr(o)})),t<11&&11<=r?u.next(function(){e.createObjectStore(Ba.store,{keyPath:Ba.keyPath}),e.createObjectStore(Ga.store,{keyPath:Ga.keyPath})}):u},ah.prototype.Hr=function(e){var n=0;return e.store(Ra.store).hs(function(t,e){n+=Dc(e)}).next(function(){var t=new Va(n);return e.store(Va.store).put(Va.key,t)})},ah.prototype.zr=function(n){var r=this,t=n.store(Da.store),i=n.store(Oa.store);return t.rs().next(function(t){return ra.forEach(t,function(e){var t=IDBKeyRange.bound([e.userId,-1],[e.userId,e.lastAcknowledgedBatchId]);return i.rs(Oa.userMutationsIndex,t).next(function(t){return ra.forEach(t,function(t){return Sr(t.userId===e.userId),t=sc(r.Qt,t),xc(n,e.userId,t).next(function(){})})})})})},ah.prototype.Jr=function(t){var o=t.store(Ua.store),e=t.store(Ra.store);return t.store(ja.store).get(ja.key).next(function(r){var i=[];return e.hs(function(t,e){var n=new ii(t),t=[0,Ta(n)];i.push(o.get(t).next(function(t){return t?ra.resolve():o.put(new Ua(0,Ta(n),r.highestListenSequenceNumber))}))}).next(function(){return ra.Mn(i)})})},ah.prototype.Yr=function(t,e){function r(t){if(i.add(t)){var e=t.tt(),t=t.X();return n.put({collectionId:e,parent:Ta(t)})}}t.createObjectStore(Fa.store,{keyPath:Fa.keyPath});var n=e.store(Fa.store),i=new yc;return e.store(Ra.store).hs({us:!0},function(t,e){return r((t=new ii(t)).X())}).next(function(){return e.store(ka.store).hs({us:!0},function(t,e){t[0];var n=t[1];return r((n=(t[2],Aa(n))).X())})})},ah.prototype.Xr=function(t){var n=this,r=t.store(Ma.store);return r.hs(function(t,e){return e=uc(e),e=ac(n.Qt,e),r.put(e)})},ah);function ah(t){this.Qt=t}function ch(t){t.createObjectStore(Ua.store,{keyPath:Ua.keyPath}).createIndex(Ua.documentTargetsIndex,Ua.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ma.store,{keyPath:Ma.keyPath}).createIndex(Ma.queryTargetsIndexName,Ma.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(ja.store)}var hh="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",fh=(lh.prototype.start=function(){var e=this;return this.To().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new Mr(Vr.FAILED_PRECONDITION,hh);return e.Io(),e.mo(),e.Ao(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(t){return e._o.Ki(t)})}).then(function(t){e.so=new Kr(t,e.eo)}).then(function(){e.io=!0}).catch(function(t){return e.lo&&e.lo.close(),Promise.reject(t)})},lh.prototype.Ro=function(n){var t=this;return this.uo=function(e){return y(t,void 0,void 0,function(){return v(this,function(t){return this.Er?[2,n(e)]:[2]})})},n(this.isPrimary)},lh.prototype.Po=function(n){var t=this;this.lo.Xn(function(e){return y(t,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return null===e.newVersion?[4,n()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})},lh.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},lh.prototype.To=function(){var n=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return dh(e).put(new qa(n.clientId,Date.now(),n.networkEnabled,n.inForeground)).next(function(){if(n.isPrimary)return n.Vo(e).next(function(t){t||(n.isPrimary=!1,n.Zr.po(function(){return n.uo(!1)}))})}).next(function(){return n.bo(e)}).next(function(t){return n.isPrimary&&!t?n.vo(e).next(function(){return!1}):!!t&&n.So(e).next(function(){return!0})})}).catch(function(t){if(pa(t))return Er("IndexedDbPersistence","Failed to extend owner lease: ",t),n.isPrimary;if(!n.allowTabSynchronization)throw t;return Er("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(function(t){n.isPrimary!==t&&n.Zr.po(function(){return n.uo(t)}),n.isPrimary=t})},lh.prototype.Vo=function(t){var e=this;return ph(t).get(Sa.key).next(function(t){return ra.resolve(e.Do(t))})},lh.prototype.Co=function(t){return dh(t).delete(this.clientId)},lh.prototype.xo=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o=this;return v(this,function(t){switch(t.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var r=Ka(t,qa.store);return r.rs().next(function(t){var e=o.$o(t,18e5),n=t.filter(function(t){return-1===e.indexOf(t)});return ra.forEach(n,function(t){return r.delete(t.clientId)}).next(function(){return n})})}).catch(function(){return[]})]);case 1:if(e=t.sent(),this.Eo)for(n=0,r=e;n<r.length;n++)i=r[n],this.Eo.removeItem(this.Fo(i.clientId));t.label=2;case 2:return[2]}})})},lh.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,function(){return t.To().then(function(){return t.xo()}).then(function(){return t.Ao()})})},lh.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},lh.prototype.bo=function(e){var r=this;return this.no?ra.resolve(!0):ph(e).get(Sa.key).next(function(t){if(null!==t&&r.No(t.leaseTimestampMs,5e3)&&!r.Oo(t.ownerId)){if(r.Do(t)&&r.networkEnabled)return!0;if(!r.Do(t)){if(!t.allowTabSynchronization)throw new Mr(Vr.FAILED_PRECONDITION,hh);return!1}}return!(!r.networkEnabled||!r.inForeground)||dh(e).rs().next(function(t){return void 0===r.$o(t,5e3).find(function(t){if(r.clientId!==t.clientId){var e=!r.networkEnabled&&t.networkEnabled,n=!r.inForeground&&t.inForeground,t=r.networkEnabled===t.networkEnabled;if(e||n&&t)return!0}return!1})})}).next(function(t){return r.isPrimary!==t&&Er("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},lh.prototype.ko=function(){return y(this,void 0,void 0,function(){var n=this;return v(this,function(t){switch(t.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[Sa.store,qa.store],function(t){var e=new Qa(t,Kr.q);return n.vo(e).next(function(){return n.Co(e)})})];case 1:return t.sent(),this.lo.close(),this.qo(),[2]}})})},lh.prototype.$o=function(t,e){var n=this;return t.filter(function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)})},lh.prototype.Uo=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(t){return dh(t).rs().next(function(t){return e.$o(t,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(lh.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),lh.prototype.Qo=function(t){return Oc.mi(t,this.Qt,this.Ei,this.Ti)},lh.prototype.Sr=function(){return this._o},lh.prototype.$r=function(){return this.fo},lh.prototype.Ko=function(){return this.Ei},lh.prototype.Wo=function(){return this.wo},lh.prototype.runTransaction=function(e,n,r){var i=this;Er("IndexedDbPersistence","Starting transaction:",e);var o,t="readonly"===n?"readonly":"readwrite";return this.lo.runTransaction(e,t,Ha,function(t){return o=new Qa(t,i.so?i.so.next():Kr.q),"readwrite-primary"===n?i.Vo(o).next(function(t){return!!t||i.bo(o)}).next(function(t){if(!t)throw Ir("Failed to obtain primary lease for action '"+e+"'."),i.isPrimary=!1,i.Zr.po(function(){return i.uo(!1)}),new Mr(Vr.FAILED_PRECONDITION,Ea);return r(o)}).next(function(t){return i.So(o).next(function(){return t})}):i.jo(o).next(function(){return r(o)})}).then(function(t){return o.Vs(),t})},lh.prototype.jo=function(t){var e=this;return ph(t).get(Sa.key).next(function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Mr(Vr.FAILED_PRECONDITION,hh)})},lh.prototype.So=function(t){var e=new Sa(this.clientId,this.allowTabSynchronization,Date.now());return ph(t).put(Sa.key,e)},lh.Kn=function(){return oa.Kn()},lh.prototype.vo=function(t){var e=this,n=ph(t);return n.get(Sa.key).next(function(t){return e.Do(t)?(Er("IndexedDbPersistence","Releasing primary lease."),n.delete(Sa.key)):ra.resolve()})},lh.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Ir("Detected an update time that is in the future: "+t+" > "+n),1))},lh.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps(function(){return t.inForeground="visible"===t.document.visibilityState,t.To()})},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},lh.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},lh.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps(function(){return e.ko()})},this.window.addEventListener("unload",this.ro))},lh.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},lh.prototype.Oo=function(t){try{var e=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return Er("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Ir("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},lh.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){Ir("Failed to set zombie client id.",t)}},lh.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},lh.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},lh);function lh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Zr=i,this.window=o,this.document=s,this.eo=a,this.no=c,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!lh.Kn())throw new Mr(Vr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new Yc(this,r),this.ho=e+"main",this.Qt=new Ja(u),this.lo=new oa(this.ho,11,new uh(this.Qt)),this._o=new Mc(this.Ti,this.Qt),this.Ei=new vc,this.fo=(e=this.Qt,u=this.Ei,new th(e,u)),this.wo=new hc,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===c&&Ir("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function ph(t){return Ka(t,Sa.store)}function dh(t){return Ka(t,qa.store)}function yh(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}function vh(t,e){this.progress=t,this.Go=e}var gh=(Th.prototype.Ho=function(e,n){var r=this;return this.zo.bi(e,n).next(function(t){return r.Jo(e,n,t)})},Th.prototype.Jo=function(t,r,i){return this.fo._i(t,r).next(function(t){for(var e=0,n=i;e<n.length;e++)t=n[e].Cs(r,t);return t})},Th.prototype.Yo=function(t,e,i){var o=nu;return e.forEach(function(t,e){for(var n=0,r=i;n<r.length;n++)e=r[n].Cs(t,e);o=o.zt(t,e)}),o},Th.prototype.Xo=function(e,t){var n=this;return this.fo.getEntries(e,t).next(function(t){return n.Zo(e,t)})},Th.prototype.Zo=function(e,r){var i=this;return this.zo.vi(e,r).next(function(t){var t=i.Yo(e,r,t),n=nu;return t.forEach(function(t,e){e=e||new Ki(t,ri.min()),n=n.zt(t,e)}),n})},Th.prototype.Kr=function(t,e,n){return r=e,ui.wt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.tc(t,e.path):Bo(e)?this.ec(t,e,n):this.nc(t,e,n);var r},Th.prototype.tc=function(t,e){return this.Ho(t,new ui(e)).next(function(t){var e=ou;return t instanceof Yi?e.zt(t.key,t):e})},Th.prototype.ec=function(n,r,i){var o=this,s=r.collectionGroup,u=ou;return this.Ei.Us(n,s).next(function(t){return ra.forEach(t,function(t){var e=(e=r,t=t.child(s),new Ro(t,null,e.xt.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt));return o.nc(n,e,i).next(function(t){t.forEach(function(t,e){u=u.zt(t,e)})})}).next(function(){return u})})},Th.prototype.nc=function(e,n,t){var a,c,r=this;return this.fo.Kr(e,n,t).next(function(t){return a=t,r.zo.Di(e,n)}).next(function(t){return c=t,r.sc(e,c,a).next(function(t){a=t;for(var e=0,n=c;e<n.length;e++)for(var r=n[e],i=0,o=r.mutations;i<o.length;i++){var s=o[i],u=s.key;a=(s=Ts(s,a.get(u),r.vs))instanceof Yi?a.zt(u,s):a.remove(u)}})}).next(function(){return a.forEach(function(t,e){Xo(n,e)||(a=a.remove(t))}),a})},Th.prototype.sc=function(t,e,n){for(var r=au(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof Os&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Yi&&(c=c.zt(t,e))}),c})},Th),mh=(Ih.oc=function(t,e){for(var n=au(),r=au(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new Ih(t,e.fromCache,n,r)},Ih),bh=(Eh.prototype.cc=function(t){this.ac=t},Eh.prototype.Kr=function(e,r,i,o){var s=this;return 0===r.filters.length&&null===r.limit&&null==r.startAt&&null==r.endAt&&(0===r.xt.length||1===r.xt.length&&r.xt[0].field.ut())||i.isEqual(ri.min())?this.uc(e,r):this.ac.Xo(e,o).next(function(t){var n=s.hc(r,t);return(Uo(r)||jo(r))&&s.lc(r.limitType,n,o,i)?s.uc(e,r):(_r()<=l.DEBUG&&Er("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),Ko(r)),s.ac.Kr(e,r,i).next(function(e){return n.forEach(function(t){e=e.zt(t.key,t)}),e}))})},Eh.prototype.hc=function(n,t){var r=new tu(Wo(n));return t.forEach(function(t,e){e instanceof Yi&&Xo(n,e)&&(r=r.add(e))}),r},Eh.prototype.lc=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version._(r))},Eh.prototype.uc=function(t,e){return _r()<=l.DEBUG&&Er("QueryEngine","Using full collection scan to execute query:",Ko(e)),this.ac.Kr(t,e,ri.min())},Eh),wh=(_h.prototype.Ir=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(t){return e.Vr(t,n.fc)})},_h);function _h(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Ys(Or),this.dc=new Nc(eo,no),this.wc=ri.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new gh(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}function Eh(){}function Ih(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}function Th(t,e,n){this.fo=t,this.zo=e,this.Ei=n}function Nh(t,e,n,r){return new wh(t,e,n,r)}function Ah(i,o){return y(this,void 0,void 0,function(){var e,n,m,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).zo,m=e.Tc,[4,e.persistence.runTransaction("Handle user change","readonly",function(v){var g;return e.zo.pi(v).next(function(t){return g=t,n=e.persistence.Qo(o),m=new gh(e.Ec,n,e.persistence.Ko()),n.pi(v)}).next(function(t){for(var e=[],n=[],r=au(),i=0,o=g;i<o.length;i++){var s=o[i];e.push(s.batchId);for(var u=0,a=s.mutations;u<a.length;u++)var c=a[u],r=r.add(c.key)}for(var h=0,f=t;h<f.length;h++){var l=f[h];n.push(l.batchId);for(var p=0,d=l.mutations;p<d.length;p++){var y=d[p];r=r.add(y.key)}}return m.Xo(v,r).next(function(t){return{Ic:t,mc:e,Ac:n}})})})];case 1:return r=t.sent(),[2,(e.zo=n,e.Tc=m,e._c.cc(e.Tc),r)]}})})}function Sh(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e._o.Qi(t)})}function xh(t,s,e,u,a){var n=au();return e.forEach(function(t){return n=n.add(t)}),s.getEntries(t,n).next(function(i){var o=nu;return e.forEach(function(t,e){var n=i.get(t),r=(null==a?void 0:a.get(t))||u;e instanceof Ki&&e.version.isEqual(ri.min())?(s.li(t,r),o=o.zt(t,e)):null==n||0<e.version._(n.version)||0===e.version._(n.version)&&n.hasPendingWrites?(s.ai(e,r),o=o.zt(t,e)):Er("LocalStore","Ignoring outdated watch update for ",t,". Current version:",n.version," Watch version:",e.version)}),o})}function Dh(t,r){var i=t;return i.persistence.runTransaction("Allocate target","readwrite",function(e){var n;return i._o.tr(e,r).next(function(t){return t?(n=t,ra.resolve(n)):i._o.Bi(e).next(function(t){return n=new Jo(r,t,0,e.bs),i._o.ji(e,n).next(function(){return n})})})}).then(function(t){var e=i.fc.get(t.targetId);return(null===e||0<t.Ot._(e.Ot))&&(i.fc=i.fc.zt(t.targetId,t),i.dc.set(r,t.targetId)),t})}function Oh(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:n=(e=i).fc.get(o),r=s?"readwrite":"readwrite-primary",t.label=1;case 1:return t.trys.push([1,4,,5]),s?[3,3]:[4,e.persistence.runTransaction("Release target",r,function(t){return e.persistence.Ti.removeTarget(t,n)})];case 2:t.sent(),t.label=3;case 3:return[3,5];case 4:if(!pa(r=t.sent()))throw r;return Er("LocalStore","Failed to update sequence numbers for target "+o+": "+r),[3,5];case 5:return e.fc=e.fc.remove(o),e.dc.delete(n.target),[2]}})})}function kh(t,o,s){var u=t,a=ri.min(),c=au();return u.persistence.runTransaction("Execute query","readonly",function(e){return t=u,n=e,r=zo(o),(void 0!==(t=(i=t).dc.get(r))?ra.resolve(i.fc.get(t)):i._o.tr(n,r)).next(function(t){if(t)return a=t.lastLimboFreeSnapshotVersion,u._o.rr(e,t.targetId).next(function(t){c=t})}).next(function(){return u._c.Kr(e,o,s?a:ri.min(),s?c:au())}).next(function(t){return{documents:t,Rc:c}});var t,n,r,i})}function Ph(t,e){var n=t,r=n._o;return(t=n.fc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Sn(t,e).next(function(t){return t?t.target:null})})}function Ch(t){var s=t;return s.persistence.runTransaction("Get new document changes","readonly",function(t){return e=s.Ec,n=t,t=s.wc,r=e,i=nu,o=nc(t),t=oh(n),n=IDBKeyRange.lowerBound(o,!0),t.hs({index:Ra.readTimeIndex,range:n},function(t,e){var n=tc(r.Qt,e);i=i.zt(n.key,n),o=e.readTime}).next(function(){return{Go:i,readTime:rc(o)}});var e,n,r,i,o}).then(function(t){var e=t.Go,t=t.readTime;return s.wc=t,e})}var Lh,Rh,Vh=(ef.prototype.Os=function(t,e){return ra.resolve(this.Vc.get(e))},ef.prototype.ks=function(t,e){return this.Vc.set(e.id,{id:e.id,version:e.version,createTime:Lu(e.createTime)}),ra.resolve()},ef.prototype.Ms=function(t,e){return ra.resolve(this.bc.get(e))},ef.prototype.Ls=function(t,e){return this.bc.set(e.name,{name:e.name,query:cc(e.bundledQuery),readTime:Lu(e.readTime)}),ra.resolve()},ef),Mh=(tf.prototype.et=function(){return this.vc.et()},tf.prototype.nr=function(t,e){e=new Uh(t,e),this.vc=this.vc.add(e),this.Dc=this.Dc.add(e)},tf.prototype.xc=function(t,e){var n=this;t.forEach(function(t){return n.nr(t,e)})},tf.prototype.ir=function(t,e){this.Nc(new Uh(t,e))},tf.prototype.$c=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},tf.prototype.Fc=function(t){var e=this,n=new ui(new ii([])),r=new Uh(n,t),t=new Uh(n,t+1),i=[];return this.Dc.me([r,t],function(t){e.Nc(t),i.push(t.key)}),i},tf.prototype.Oc=function(){var e=this;this.vc.forEach(function(t){return e.Nc(t)})},tf.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},tf.prototype.kc=function(t){var e=new ui(new ii([])),n=new Uh(e,t),t=new Uh(e,t+1),r=au();return this.Dc.me([n,t],function(t){r=r.add(t.key)}),r},tf.prototype.Fi=function(t){var e=new Uh(t,0);return null!==(e=this.vc.Re(e))&&t.isEqual(e.key)},tf),Uh=($h.Sc=function(t,e){return ui.H(t.key,e.key)||Or(t.Mc,e.Mc)},$h.Cc=function(t,e){return Or(t.Mc,e.Mc)||ui.H(t.key,e.key)},$h),jh=(Zh.prototype.Ai=function(t){return ra.resolve(0===this.zo.length)},Zh.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,0<this.zo.length&&this.zo[this.zo.length-1],n=new Xa(i,e,n,r),this.zo.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Bc=this.Bc.add(new Uh(u.key,i)),this.Ei.qs(t,u.key.path.X())}return ra.resolve(n)},Zh.prototype.Pi=function(t,e){return ra.resolve(this.qc(e))},Zh.prototype.gi=function(t,e){return e+=1,e=(e=this.Uc(e))<0?0:e,ra.resolve(this.zo.length>e?this.zo[e]:null)},Zh.prototype.Vi=function(){return ra.resolve(0===this.zo.length?-1:this.Lc-1)},Zh.prototype.pi=function(t){return ra.resolve(this.zo.slice())},Zh.prototype.bi=function(t,e){var n=this,r=new Uh(e,0),e=new Uh(e,Number.POSITIVE_INFINITY),i=[];return this.Bc.me([r,e],function(t){t=n.qc(t.Mc),i.push(t)}),ra.resolve(i)},Zh.prototype.vi=function(t,e){var n=this,r=new tu(Or);return e.forEach(function(t){var e=new Uh(t,0),t=new Uh(t,Number.POSITIVE_INFINITY);n.Bc.me([e,t],function(t){r=r.add(t.Mc)})}),ra.resolve(this.Qc(r))},Zh.prototype.Di=function(t,e){var n=e.path,r=n.length+1,e=n;ui.wt(e)||(e=e.child(""));var e=new Uh(new ui(e),0),i=new tu(Or);return this.Bc.Ae(function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(i=i.add(t.Mc)),!0)},e),ra.resolve(this.Qc(i))},Zh.prototype.Qc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.qc(t))&&n.push(t)}),n},Zh.prototype.Ci=function(n,r){var i=this;Sr(0===this.Kc(r.batchId,"removed")),this.zo.shift();var o=this.Bc;return ra.forEach(r.mutations,function(t){var e=new Uh(t.key,r.batchId);return o=o.delete(e),i.Ti.Ni(n,t.key)}).next(function(){i.Bc=o})},Zh.prototype.xi=function(t){},Zh.prototype.Fi=function(t,e){var n=new Uh(e,0),n=this.Bc.Re(n);return ra.resolve(e.isEqual(n&&n.key))},Zh.prototype.$i=function(t){return this.zo.length,ra.resolve()},Zh.prototype.Kc=function(t,e){return this.Uc(t)},Zh.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},Zh.prototype.qc=function(t){return(t=this.Uc(t))<0||t>=this.zo.length?null:this.zo[t]},Zh),Fh=(Jh.prototype.ai=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:o,readTime:n}),this.size+=o-i,this.Ei.qs(t,r.path.X())},Jh.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Jh.prototype._i=function(t,e){return e=this.docs.get(e),ra.resolve(e?e.hi:null)},Jh.prototype.getEntries=function(t,e){var n=this,r=nu;return e.forEach(function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)}),ra.resolve(r)},Jh.prototype.Kr=function(t,e,n){for(var r=ou,i=new ui(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=(u=o.oe()).key,u=(a=u.value).hi,a=a.readTime;if(!e.path.nt(s.path))break;a._(n)<=0||u instanceof Yi&&Xo(e,u)&&(r=r.zt(u.key,u))}return ra.resolve(r)},Jh.prototype.jc=function(t,e){return ra.forEach(this.docs,function(t){return e(t)})},Jh.prototype.Nr=function(t){return new qh(this)},Jh.prototype.Or=function(t){return ra.resolve(this.size)},Jh),qh=(h(Wh,Rh=me),Wh.prototype.wi=function(n){var r=this,i=[];return this.ri.forEach(function(t,e){e&&e.hi?i.push(r.jr.ai(n,e.hi,r.ci(t))):r.jr.li(t)}),ra.Mn(i)},Wh.prototype.fi=function(t,e){return this.jr._i(t,e)},Wh.prototype.di=function(t,e){return this.jr.getEntries(t,e)},Wh),Bh=(Xh.prototype.In=function(t,n){return this.Gc.forEach(function(t,e){return n(e)}),ra.resolve()},Xh.prototype.Qi=function(t){return ra.resolve(this.lastRemoteSnapshotVersion)},Xh.prototype.Ki=function(t){return ra.resolve(this.zc)},Xh.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),ra.resolve(this.highestTargetId)},Xh.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),ra.resolve()},Xh.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new Vc(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},Xh.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,ra.resolve()},Xh.prototype.Hi=function(t,e){return this.Gi(e),ra.resolve()},Xh.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),--this.targetCount,ra.resolve()},Xh.prototype.Xi=function(n,r,i){var o=this,s=0,u=[];return this.Gc.forEach(function(t,e){e.sequenceNumber<=r&&null===i.get(e.targetId)&&(o.Gc.delete(t),u.push(o.Yi(n,e.targetId)),s++)}),ra.Mn(u).next(function(){return s})},Xh.prototype.Zi=function(t){return ra.resolve(this.targetCount)},Xh.prototype.tr=function(t,e){return e=this.Gc.get(e)||null,ra.resolve(e)},Xh.prototype.er=function(t,e,n){return this.Hc.xc(e,n),ra.resolve()},Xh.prototype.sr=function(e,t,n){this.Hc.$c(t,n);var r=this.persistence.Ti,i=[];return r&&t.forEach(function(t){i.push(r.Ni(e,t))}),ra.Mn(i)},Xh.prototype.Yi=function(t,e){return this.Hc.Fc(e),ra.resolve()},Xh.prototype.rr=function(t,e){return e=this.Hc.kc(e),ra.resolve(e)},Xh.prototype.Fi=function(t,e){return ra.resolve(this.Hc.Fi(e))},Xh),Gh=(Kh.prototype.start=function(){return Promise.resolve()},Kh.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(Kh.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),Kh.prototype.Po=function(){},Kh.prototype.yo=function(){},Kh.prototype.Ko=function(){return this.Ei},Kh.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new jh(this.Ei,this.Ti),this.Yc[t.A()]=e),e},Kh.prototype.Sr=function(){return this._o},Kh.prototype.$r=function(){return this.fo},Kh.prototype.Wo=function(){return this.wo},Kh.prototype.runTransaction=function(t,e,n){var r=this;Er("MemoryPersistence","Starting transaction:",t);var i=new zh(this.so.next());return this.Ti.Zc(),n(i).next(function(t){return r.Ti.ta(i).next(function(){return t})}).On().then(function(t){return i.Vs(),t})},Kh.prototype.ea=function(e,n){return ra.Ln(Object.values(this.Yc).map(function(t){return function(){return t.Fi(e,n)}}))},Kh),zh=(h(Yh,Lh=o),Yh),Hh=(Qh.ia=function(t){return new Qh(t)},Object.defineProperty(Qh.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw Ar()},enumerable:!1,configurable:!0}),Qh.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),ra.resolve()},Qh.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),ra.resolve()},Qh.prototype.Ni=function(t,e){return this.ra.add(e.toString()),ra.resolve()},Qh.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach(function(t){return n.ra.add(t.toString())});var r=this.persistence.Sr();return r.rr(t,e.targetId).next(function(t){t.forEach(function(t){return n.ra.add(t.toString())})}).next(function(){return r.Ji(t,e)})},Qh.prototype.Zc=function(){this.sa=new Set},Qh.prototype.ta=function(n){var r=this,i=this.persistence.$r().Nr();return ra.forEach(this.ra,function(t){var e=ui._t(t);return r.oa(n,e).next(function(t){t||i.li(e)})}).next(function(){return r.sa=null,i.apply(n)})},Qh.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next(function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())})},Qh.prototype.Xc=function(t){return 0},Qh.prototype.oa=function(t,e){var n=this;return ra.Ln([function(){return ra.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},Qh);function Qh(t){this.persistence=t,this.na=new Mh,this.sa=null}function Yh(t){var e=this;return(e=Lh.call(this)||this).bs=t,e}function Kh(t,e){var n=this;this.Yc={},this.so=new Kr(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new Bh(this),this.Ei=new dc,this.fo=(t=this.Ei,new Fh(t,function(t){return n.Ti.Xc(t)})),this.Qt=new Ja(e),this.wo=new Vh(this.Qt)}function Xh(t){this.persistence=t,this.Gc=new Nc(eo,no),this.lastRemoteSnapshotVersion=ri.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Mh,this.targetCount=0,this.Jc=Vc.Mi()}function Wh(t){var e=this;return(e=Rh.call(this)||this).jr=t,e}function Jh(t,e){this.Ei=t,this.Wc=e,this.docs=new Ys(ui.H),this.size=0}function Zh(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new tu(Uh.Sc)}function $h(t,e){this.key=t,this.Mc=e}function tf(){this.vc=new tu(Uh.Sc),this.Dc=new tu(Uh.Cc)}function ef(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}function nf(t,e){return"firestore_clients_"+t+"_"+e}function rf(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.m()&&(n+="_"+e.uid),n}function of(t,e){return"firestore_targets_"+t+"_"+e}var sf,uf=(Of.ca=function(t,e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Mr(i.error.code,i.error.message)),o?new Of(t,e,i.state,r):(Ir("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Of.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Of),af=(Df.ca=function(t,e){var n,r=JSON.parse(e),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new Mr(r.error.code,r.error.message)),i?new Df(t,r.state,n):(Ir("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Df.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Df),cf=(xf.ca=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=cu,o=0;r&&o<n.activeTargetIds.length;++o)r=Si(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new xf(t,i):(Ir("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},xf),hf=(Sf.ca=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Sf(e.clientId,e.onlineState):(Ir("SharedClientState","Failed to parse online state: "+t),null)},Sf),ff=(Af.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},Af.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},Af.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},Af),lf=(Nf.Kn=function(t){return!(!t||!t.localStorage)},Nf.prototype.start=function(){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f=this;return v(this,function(t){switch(t.label){case 0:return[4,this._a.Uo()];case 1:for(s=t.sent(),e=0,n=s;e<n.length;e++)(r=n[e])!==this.la&&(i=this.getItem(nf(this.persistenceKey,r)))&&(o=cf.ca(r,i))&&(this.Ea=this.Ea.zt(o.clientId,o));for(this.Va(),(s=this.storage.getItem(this.ya))&&(u=this.pa(s))&&this.ba(u),a=0,c=this.Ta;a<c.length;a++)h=c[a],this.wa(h);return this.Ta=[],this.window.addEventListener("unload",function(){return f.ko()}),this.Er=!0,[2]}})})},Nf.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},Nf.prototype.va=function(){return this.Sa(this.Ea)},Nf.prototype.Da=function(n){var r=!1;return this.Ea.forEach(function(t,e){e.activeTargetIds.has(n)&&(r=!0)}),r},Nf.prototype.Ca=function(t){this.xa(t,"pending")},Nf.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},Nf.prototype.Fa=function(t){var e,n="not-current";return this.Da(t)&&(!(e=this.storage.getItem(of(this.persistenceKey,t)))||(e=af.ca(t,e))&&(n=e.state)),this.Oa.ua(t),this.Va(),n},Nf.prototype.ka=function(t){this.Oa.ha(t),this.Va()},Nf.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},Nf.prototype.La=function(t){this.removeItem(of(this.persistenceKey,t))},Nf.prototype.Ba=function(t,e,n){this.qa(t,e,n)},Nf.prototype.Ua=function(t,e,n){var r=this;e.forEach(function(t){r.$a(t)}),this.currentUser=t,n.forEach(function(t){r.Ca(t)})},Nf.prototype.Qa=function(t){this.Ka(t)},Nf.prototype.Wa=function(){this.ja()},Nf.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},Nf.prototype.getItem=function(t){var e=this.storage.getItem(t);return Er("SharedClientState","READ",t,e),e},Nf.prototype.setItem=function(t,e){Er("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Nf.prototype.removeItem=function(t){Er("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Nf.prototype.wa=function(t){var e=this,o=t;o.storageArea===this.storage&&(Er("SharedClientState","EVENT",o.key,o.newValue),o.key!==this.Ia?this.Zr.po(function(){return y(e,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){if(this.Er){if(null!==o.key)if(this.Aa.test(o.key)){if(null==o.newValue)return e=this.Ga(o.key),[2,this.za(e,null)];if(e=this.Ha(o.key,o.newValue))return[2,this.za(e.clientId,e)]}else if(this.Ra.test(o.key)){if(null!==o.newValue&&(n=this.Ja(o.key,o.newValue)))return[2,this.Ya(n)]}else if(this.Pa.test(o.key)){if(null!==o.newValue&&(r=this.Xa(o.key,o.newValue)))return[2,this.Za(r)]}else if(o.key===this.ya){if(null!==o.newValue&&(i=this.pa(o.newValue)))return[2,this.ba(i)]}else if(o.key===this.ma)(i=function(t){var e=Kr.q;if(null!=t)try{var n=JSON.parse(t);Sr("number"==typeof n),e=n}catch(t){Ir("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(o.newValue))!==Kr.q&&this.k(i);else if(o.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(o);return[2]})})}):Ir("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(Nf.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),Nf.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},Nf.prototype.xa=function(t,e,n){n=new uf(this.currentUser,t,e,n),t=rf(this.persistenceKey,this.currentUser,t),this.setItem(t,n.aa())},Nf.prototype.$a=function(t){t=rf(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Nf.prototype.Ka=function(t){t={clientId:this.la,onlineState:t},this.storage.setItem(this.ya,JSON.stringify(t))},Nf.prototype.qa=function(t,e,n){var r=of(this.persistenceKey,t),n=new af(t,e,n);this.setItem(r,n.aa())},Nf.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},Nf.prototype.Ga=function(t){return(t=this.Aa.exec(t))?t[1]:null},Nf.prototype.Ha=function(t,e){return t=this.Ga(t),cf.ca(t,e)},Nf.prototype.Ja=function(t,e){var n=this.Ra.exec(t),t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return uf.ca(new jr(n),t,e)},Nf.prototype.Xa=function(t,e){return t=this.Pa.exec(t),t=Number(t[1]),af.ca(t,e)},Nf.prototype.pa=function(t){return hf.ca(t)},Nf.prototype.Ya=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return e.user.uid===this.currentUser.uid?[2,this._a.eu(e.batchId,e.state,e.error)]:(Er("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},Nf.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},Nf.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._a.su(s,u).then(function(){n.Ea=r})},Nf.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},Nf.prototype.Sa=function(t){var n=cu;return t.forEach(function(t,e){n=n.Pe(e.activeTargetIds)}),n},Nf),pf=(Tf.prototype.Ca=function(t){},Tf.prototype.Na=function(t,e,n){},Tf.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},Tf.prototype.Ba=function(t,e,n){this.ru[t]=e},Tf.prototype.ka=function(t){this.iu.ha(t)},Tf.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},Tf.prototype.La=function(t){delete this.ru[t]},Tf.prototype.va=function(){return this.iu.activeTargetIds},Tf.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},Tf.prototype.start=function(){return this.iu=new ff,Promise.resolve()},Tf.prototype.Ua=function(t,e,n){},Tf.prototype.Qa=function(t){},Tf.prototype.ko=function(){},Tf.prototype.B=function(t){},Tf.prototype.Wa=function(){},Tf),df=(If.prototype.ou=function(t){},If.prototype.ko=function(){},If),yf=(Ef.prototype.ou=function(t){this.lu.push(t)},Ef.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},Ef.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},Ef.prototype.au=function(){Er("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},Ef.prototype.hu=function(){Er("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},Ef.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},Ef),vf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},gf=(_f.prototype.wu=function(t){this.Eu=t},_f.prototype.Tu=function(t){this.Iu=t},_f.prototype.onMessage=function(t){this.mu=t},_f.prototype.close=function(){this.du()},_f.prototype.send=function(t){this.fu(t)},_f.prototype.Au=function(){this.Eu()},_f.prototype.Ru=function(t){this.Iu(t)},_f.prototype.Pu=function(t){this.mu(t)},_f),mf=(wf.prototype.pu=function(e,t,n,r){var i=this.bu(e,t);return Er("RestConnection","Sending: ",i,n),t={},this.vu(t,r),this.Su(e,i,t,n).then(function(t){return Er("RestConnection","Received: ",t),t},function(t){throw Tr("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t})},wf.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},wf.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.10",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},wf.prototype.bu=function(t,e){return t=vf[t],this.gu+"/v1/"+e+":"+t},h(bf,sf=wf),bf.prototype.Su=function(o,e,s,u){return new Promise(function(n,r){var i=new vr;i.listenOnce(pr.COMPLETE,function(){try{switch(i.getLastErrorCode()){case lr.NO_ERROR:var t=i.getResponseJson();Er("Connection","XHR received:",JSON.stringify(t)),n(t);break;case lr.TIMEOUT:Er("Connection",'RPC "'+o+'" timed out'),r(new Mr(Vr.DEADLINE_EXCEEDED,"Request time out"));break;case lr.HTTP_ERROR:var e=i.getStatus();Er("Connection",'RPC "'+o+'" failed with status:',e,"response text:",i.getResponseText()),0<e?(t=i.getResponseJson().error)&&t.status&&t.message?(e=t.status.toLowerCase().replace(/_/g,"-"),e=0<=Object.values(Vr).indexOf(e)?e:Vr.UNKNOWN,r(new Mr(e,t.message))):r(new Mr(Vr.UNKNOWN,"Server responded with status "+i.getStatus())):r(new Mr(Vr.UNAVAILABLE,"Connection failed."));break;default:Ar()}}finally{Er("Connection",'RPC "'+o+'" completed.')}});var t=JSON.stringify(u);i.send(e,"POST",t,s,15)})},bf.prototype.Cu=function(t,e){var n,r=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new sr,o=fr(),t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(p())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=p().indexOf("Electron/")||0<=(n=p()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=p().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Er("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new gf({fu:function(t){a?Er("Connection","Not sending because WebChannel is closed:",t):(u||(Er("Connection","Opening WebChannel transport."),s.open(),u=!0),Er("Connection","WebChannel sending:",t),s.send(t))},du:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,yr.EventType.OPEN,function(){a||Er("Connection","WebChannel transport opened.")}),t(s,yr.EventType.CLOSE,function(){a||(a=!0,Er("Connection","WebChannel transport closed"),c.Ru())}),t(s,yr.EventType.ERROR,function(t){a||(a=!0,Tr("Connection","WebChannel transport errored:",t),c.Ru(new Mr(Vr.UNAVAILABLE,"The operation could not be completed")))}),t(s,yr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Sr(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Er("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Us[r];if(void 0!==t)return Qs(t)}(),i=n.message,void 0===t&&(t=Vr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Ru(new Mr(t,i)),s.close()):(Er("Connection","WebChannel received:",e),c.Pu(e)))}),t(o,dr.STAT_EVENT,function(t){10===t.stat?Er("Connection","Detected buffering proxy"):11===t.stat&&Er("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Au()},0),c},bf);function bf(t){var e=this;return(e=sf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function wf(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function _f(t){this.fu=t.fu,this.du=t.du}function Ef(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}function If(){}function Tf(){this.iu=new ff,this.ru={},this.fa=null,this.k=null}function Nf(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new Ys(Or),this.Er=!1,this.Ta=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ia=nf(this.persistenceKey,this.la),this.ma="firestore_sequence_number_"+this.persistenceKey,this.Ea=this.Ea.zt(this.la,new ff),this.Aa=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.ya="firestore_online_state_"+this.persistenceKey,this.ga="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.da)}function Af(){this.activeTargetIds=cu}function Sf(t,e){this.clientId=t,this.onlineState=e}function xf(t,e){this.clientId=t,this.activeTargetIds=e}function Df(t,e,n){this.targetId=t,this.state=e,this.error=n}function Of(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function kf(){return"undefined"!=typeof window?window:null}function Pf(){return"undefined"!=typeof document?document:null}function Cf(t){return new ku(t,!0)}function Lf(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou(function(t){n.Ps(function(){return y(o,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return rl(this)?(Er("RemoteStore","Restarting streams for network reachability change."),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(4),[4,Wf(e)];case 1:return t.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,Xf(e)];case 2:return t.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Oh=new Bf(n,r)}var Rf,Vf,Mf,Uf=(Kf.prototype.reset=function(){this.Fu=0},Kf.prototype.Mu=function(){this.Fu=this.$u},Kf.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);0<i&&Er("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,function(){return e.ku=Date.now(),t()}),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},Kf.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},Kf.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},Kf.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},Kf),me=(Yf.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},Yf.prototype.Hu=function(){return 2===this.state},Yf.prototype.start=function(){3!==this.state?this.auth():this.Ju()},Yf.prototype.stop=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Yf.prototype.Yu=function(){this.state=0,this.Gu.reset()},Yf.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,function(){return t.Zu()}))},Yf.prototype.th=function(t){this.eh(),this.stream.send(t)},Yf.prototype.Zu=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return this.Hu()?[2,this.close(0)]:[2]})})},Yf.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},Yf.prototype.close=function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==e?this.Gu.reset():n&&n.code===Vr.RESOURCE_EXHAUSTED?(Ir(n.toString()),Ir("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):n&&n.code===Vr.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Tu(n)];case 1:return t.sent(),[2]}})})},Yf.prototype.nh=function(){},Yf.prototype.auth=function(){var n=this;this.state=1;var t=this.sh(this.Wu),e=this.Wu;this.Ku.getToken().then(function(t){n.Wu===e&&n.ih(t)},function(e){t(function(){var t=new Mr(Vr.UNKNOWN,"Fetching auth token failed: "+e.message);return n.rh(t)})})},Yf.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu(function(){n(function(){return e.state=2,e.listener.wu()})}),this.stream.Tu(function(t){n(function(){return e.rh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Yf.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu(function(){return y(t,void 0,void 0,function(){return v(this,function(t){return this.state=0,this.start(),[2]})})})},Yf.prototype.rh=function(t){return Er("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Yf.prototype.sh=function(e){var n=this;return function(t){n.Zr.Ps(function(){return n.Wu===e?t():(Er("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Yf),jf=(h(Qf,Mf=me),Qf.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},Qf.prototype.onMessage=function(t){this.Gu.reset();var e,n=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Ar(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.Bt?(Sr(void 0===s||"string"==typeof s),Cr.fromBase64String(s||"")):(Sr(void 0===s||s instanceof Uint8Array),Cr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?Vr.UNKNOWN:Qs(c.code),new Mr(a,c.message||"")),s=new gu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime;var r=Uu(t,n.document.name),i=Lu(n.document.updateTime),u=new Fi({mapValue:{fields:n.document.fields}}),a=(o=new Yi(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[],s=new yu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Uu(t,n.document),i=n.readTime?Lu(n.readTime):ri.min(),u=new Ki(r,i),o=n.removedTargetIds||[],s=new yu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Uu(t,n.document),i=n.removedTargetIds||[],s=new yu([],i,r,null);else{if(!("filter"in e))return Ar();e.filter,(e=e.filter).targetId,r=new Ms(n=e.count||0),i=e.targetId,s=new vu(i,r)}return s}(this.Qt,t),t=!("targetChange"in(e=t))||(e=e.targetChange).targetIds&&e.targetIds.length||!e.readTime?ri.min():Lu(e.readTime);return this.listener.ah(n,t)},Qf.prototype.uh=function(t){var e,n,r,i,o={};o.database=qu(this.Qt),o.addTarget=(e=this.Qt,(r=ro(r=(n=t).target)?{documents:Yu(e,r)}:{query:Ku(e,r)}).targetId=n.targetId,0<n.resumeToken.l()?r.resumeToken=Cu(e,n.resumeToken):0<n.Ot._(ri.min())&&(r.readTime=Pu(e,n.Ot.j())),r),(t=(this.Qt,i=t,null==(t=function(){switch(i.Ft){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Ar()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.th(o)},Qf.prototype.hh=function(t){var e={};e.database=qu(this.Qt),e.removeTarget=t,this.th(e)},Qf),Ff=(h(Hf,Vf=me),Object.defineProperty(Hf.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),Hf.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,Vf.prototype.start.call(this)},Hf.prototype.nh=function(){this.lh&&this.fh([])},Hf.prototype.oh=function(t){return this.Qu.Cu("Write",t)},Hf.prototype.onMessage=function(t){if(Sr(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Sr(void 0!==r),n.map(function(t){return n=r,new bs(t=(t=(e=t).updateTime?Lu(e.updateTime):Lu(n)).isEqual(ri.min())?Lu(n):t,e.transformResults||[]);var e,n})):[]),n=Lu(t.commitTime);return this.listener.dh(n,e)}var r;return Sr(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},Hf.prototype.Eh=function(){var t={};t.database=qu(this.Qt),this.th(t)},Hf.prototype.fh=function(t){var e=this,t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Hu(e.Qt,t)})};this.th(t)},Hf),qf=(h(zf,Rf=function(){}),zf.prototype.Ih=function(){if(this.Th)throw new Mr(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},zf.prototype.pu=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.pu(e,n,r,t)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&i.credentials.p(),t})},zf.prototype.Du=function(e,n,r){var i=this;return this.Ih(),this.credentials.getToken().then(function(t){return i.Qu.Du(e,n,r,t)}).catch(function(t){throw t.code===Vr.UNAUTHENTICATED&&i.credentials.p(),t})},zf.prototype.terminate=function(){this.Th=!1},zf),Bf=(Gf.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()}))},Gf.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,1<=this.mh&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},Gf.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},Gf.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},Gf.prototype.gh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Rh?(Ir(t),this.Rh=!1):Er("OnlineStateTracker",t)},Gf.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},Gf);function Gf(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}function zf(t,e,n){var r=this;return(r=Rf.call(this)||this).credentials=t,r.Qu=e,r.Qt=n,r.Th=!1,r}function Hf(t,e,n,r,i){var o=this;return(o=Vf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Qt=r,o.lh=!1,o}function Qf(t,e,n,r,i){var o=this;return(o=Mf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Qt=r,o}function Yf(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Uf(t,e)}function Kf(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}function Xf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:if(!rl(r))return[3,4];e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Wf(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:e=0,n=r.$h,t.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:t.sent(),t.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Jf(t,e){t.xh.has(e.targetId)||(t.xh.set(e.targetId,e),nl(t)?el(t):fl(t).Hu()&&$f(t,e))}function Zf(t,e){var n=t,t=fl(n);n.xh.delete(e),t.Hu()&&tl(n,e),0===n.xh.size&&(t.Hu()?t.Xu():rl(n)&&n.Oh.set("Unknown"))}function $f(t,e){t.kh.on(e.targetId),fl(t).uh(e)}function tl(t,e){t.kh.on(e),fl(t).hh(e)}function el(e){e.kh=new bu({vn:function(t){return e.Dh.vn(t)},Sn:function(t){return e.xh.get(t)||null}}),fl(e).start(),e.Oh.Ph()}function nl(t){return rl(t)&&!fl(t).zu()&&0<t.xh.size}function rl(t){return 0===t.Nh.size}function il(t){t.kh=void 0}function ol(n,r,i){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:if(!pa(r))throw r;return n.Nh.add(1),[4,Wf(n)];case 1:return t.sent(),n.Oh.set("Offline"),i=i||function(){return Sh(n.bh)},n._s.po(function(){return y(e,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return Er("RemoteStore","Retrying IndexedDB access"),[4,i()];case 1:return t.sent(),n.Nh.delete(1),[4,Xf(n)];case 2:return t.sent(),[2]}})})}),[2]}})})}function sl(e,n){return n().catch(function(t){return ol(e,t,n)})}function ul(c){return y(this,void 0,void 0,function(){var o,s,u,a;return v(this,function(t){switch(t.label){case 0:s=ll(o=c),u=0<o.Ch.length?o.Ch[o.Ch.length-1].batchId:-1,t.label=1;case 1:if(!(rl(o)&&o.Ch.length<10))return[3,7];t.label=2;case 2:return t.trys.push([2,4,,6]),[4,(n=o.bh,r=u,(i=n).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===r&&(r=-1),i.zo.gi(t,r)}))];case 3:return null===(a=t.sent())?(0===o.Ch.length&&s.Xu(),[3,7]):(u=a.batchId,e=a,(n=o).Ch.push(e),(n=ll(n)).Hu()&&n._h&&n.fh(e.mutations),[3,6]);case 4:return a=t.sent(),[4,ol(o,a)];case 5:return t.sent(),[3,6];case 6:return[3,1];case 7:return al(o)&&cl(o),[2]}var e,n,r,i})})}function al(t){return rl(t)&&!ll(t).zu()&&0<t.Ch.length}function cl(t){ll(t).start()}function hl(n,r){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,r?(e.Nh.delete(2),[4,Xf(e)]):[3,2];case 1:return t.sent(),[3,5];case 2:return r?[3,4]:(e.Nh.add(2),[4,Wf(e)]);case 3:t.sent(),e.Oh.set("Unknown"),t.label=4;case 4:t.label=5;case 5:return[2]}})})}function fl(n){var t,e,r,i=this;return n.Uh||(n.Uh=(t=n.Sh,e=n._s,r={wu:function(n){return y(this,void 0,void 0,function(){return v(this,function(t){return n.xh.forEach(function(t,e){$f(n,t)}),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){return il(e),nl(e)?(e.Oh.Vh(n),el(e)):e.Oh.set("Unknown"),[2]})})}.bind(null,n),ah:function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:if(s.Oh.set("Online"),!(u instanceof gu&&2===u.state&&u.cause))return[3,6];t.label=1;case 1:return t.trys.push([1,3,,5]),[4,function(o,s){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:e=s.cause,n=0,r=s.targetIds,t.label=1;case 1:return n<r.length?(i=r[n],o.xh.has(i)?[4,o.Dh.Mh(i,e)]:[3,3]):[3,5];case 2:t.sent(),o.xh.delete(i),o.kh.removeTarget(i),t.label=3;case 3:t.label=4;case 4:return n++,[3,1];case 5:return[2]}})})}(s,u)];case 2:return t.sent(),[3,5];case 3:return n=t.sent(),Er("RemoteStore","Failed to remove targets %s: %s ",u.targetIds.join(","),n),[4,ol(s,n)];case 4:return t.sent(),[3,5];case 5:return[3,13];case 6:if(u instanceof yu?s.kh.dn(u):u instanceof vu?s.kh.Pn(u):s.kh.Tn(u),a.isEqual(ri.min()))return[3,13];t.label=7;case 7:return t.trys.push([7,11,,13]),[4,Sh(s.bh)];case 8:return o=t.sent(),0<=a._(o)?[4,(i=a,(e=(r=s).kh.Vn(i)).$e.forEach(function(t,e){var n;0<t.resumeToken.l()&&(n=r.xh.get(e))&&r.xh.set(e,n.Mt(t.resumeToken,i))}),e.Fe.forEach(function(t){var e=r.xh.get(t);e&&(r.xh.set(t,e.Mt(Cr.T,e.Ot)),tl(r,t),e=new Jo(e.target,t,1,e.sequenceNumber),$f(r,e))}),r.Dh.Lh(e))]:[3,10];case 9:t.sent(),t.label=10;case 10:return[3,13];case 11:return Er("RemoteStore","Failed to raise snapshot:",o=t.sent()),[4,ol(s,o)];case 12:return t.sent(),[3,13];case 13:return[2]}var r,i,e})})}.bind(null,n)},t.Ih(),new jf(e,t.Qu,t.credentials,t.Qt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Uh.Yu(),nl(n)?el(n):n.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,n.Uh.stop()];case 2:t.sent(),il(n),t.label=3;case 3:return[2]}})})})),n.Uh}function ll(n){var t,e,r,i=this;return n.Qh||(n.Qh=(t=n.Sh,e=n._s,r={wu:function(e){return y(this,void 0,void 0,function(){return v(this,function(t){return ll(e).Eh(),[2]})})}.bind(null,n),Tu:function(e,n){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return n&&ll(e)._h?[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return Hs(n=i.code)&&n!==Vr.ABORTED?(e=r.Ch.shift(),ll(r).Yu(),[4,sl(r,function(){return r.Dh.qh(e.batchId,i)})]):[3,3];case 1:return t.sent(),[4,ul(r)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}(e,n)]:[3,2];case 1:t.sent(),t.label=2;case 2:return al(e)&&cl(e),[2]}})})}.bind(null,n),wh:function(o){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){for(e=ll(o),n=0,r=o.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]})})}.bind(null,n),dh:function(r,i,o){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return e=r.Ch.shift(),n=Wa.from(e,i,o),[4,sl(r,function(){return r.Dh.Bh(n)})];case 1:return t.sent(),[4,ul(r)];case 2:return t.sent(),[2]}})})}.bind(null,n)},t.Ih(),new Ff(e,t.Qu,t.credentials,t.Qt,r)),n.$h.push(function(e){return y(i,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e?(n.Qh.Yu(),[4,ul(n)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,n.Qh.stop()];case 3:t.sent(),0<n.Ch.length&&(Er("RemoteStore","Stopping write stream with "+n.Ch.length+" pending writes"),n.Ch=[]),t.label=4;case 4:return[2]}})})})),n.Qh}function pl(){this.queries=new Nc(Yo,Qo),this.onlineState="Unknown",this.Wh=new Set}var dl=function(){this.Kh=void 0,this.listeners=[]};function yl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:if(e=s,n=u.query,r=!1,(i=e.queries.get(n))||(r=!0,i=new dl),!r)return[3,4];t.label=1;case 1:return t.trys.push([1,3,,4]),o=i,[4,e.jh(n)];case 2:return o.Kh=t.sent(),[3,4];case 3:return o=_a(o=t.sent(),"Initialization of query '"+Ko(u.query)+"' failed"),[2,void u.onError(o)];case 4:return e.queries.set(n,i),i.listeners.push(u),u.Gh(e.onlineState),i.Kh&&u.zh(i.Kh)&&gl(e),[2]}})})}function vl(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){return e=s,n=u.query,r=!1,(i=e.queries.get(n))&&0<=(o=i.listeners.indexOf(u))&&(i.listeners.splice(o,1),r=0===i.listeners.length),r?[2,(e.queries.delete(n),e.Hh(n))]:[2]})})}function gl(t){t.Wh.forEach(function(t){t.next()})}var ml=(Nl.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lu(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},Nl.prototype.onError=function(t){this.Jh.error(t)},Nl.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},Nl.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},Nl.prototype.Zh=function(t){if(0<t.docChanges.length)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},Nl.prototype.el=function(t){t=lu.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},Nl),bl=(Tl.prototype.sl=function(){return"metadata"in this.payload},Tl),wl=(Il.prototype.Pc=function(t){return Uu(this.Qt,t)},Il.prototype.yc=function(t){return t.metadata.exists?zu(this.Qt,t.document,!1):new Ki(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},Il.prototype.gc=Lu,Il),_l=(El.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},El.prototype.ol=function(t){for(var e=new Map,n=new wl(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||au()).add(s);e.set(c,h)}}return e},El.prototype.complete=function(){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return[4,function(f,l,p,d){return y(this,void 0,void 0,function(){var n,r,i,o,e,s,u,a,c,h;return v(this,function(t){switch(t.label){case 0:for(n=f,r=au(),i=nu,o=su,e=0,s=p;e<s.length;e++)u=s[e],a=l.Pc(u.metadata.name),u.document&&(r=r.add(a)),i=i.zt(a,l.yc(u)),o=o.zt(a,l.gc(u.metadata.readTime));return c=n.Ec.Nr({Wr:!0}),[4,Dh(n,zo(Mo(ii.ot("__bundle__/docs/"+d))))];case 1:return h=t.sent(),[2,n.persistence.runTransaction("Apply bundle documents","readwrite",function(e){return xh(e,c,i,ri.min(),o).next(function(t){return c.apply(e),t}).next(function(t){return n._o.Yi(e,h.targetId).next(function(){return n._o.er(e,r,h.targetId)}).next(function(){return n.Tc.Zo(e,t)})})})]}})})}(this.bh,new wl(this.Qt),this.documents,this.il.id)];case 1:e=t.sent(),n=this.ol(this.documents),r=0,i=this.queries,t.label=2;case 2:return r<i.length?(i=i[r],[4,function(e,i,o){return void 0===o&&(o=au()),y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,Dh(e,zo(cc(i.bundledQuery)))];case 1:return n=t.sent(),[2,(r=e).persistence.runTransaction("Save named query","readwrite",function(t){var e=Lu(i.readTime);return 0<=n.Ot._(e)?r.wo.Ls(t,i):(e=n.Mt(Cr.T,e),r.fc=r.fc.zt(e.targetId,e),r._o.Hi(t,e).next(function(){return r._o.Yi(t,n.targetId)}).next(function(){return r._o.er(t,o,n.targetId)}).next(function(){return r.wo.Ls(t,i)}))})]}})})}(this.bh,i,n.get(i.name))]):[3,5];case 3:t.sent(),t.label=4;case 4:return r++,[3,2];case 5:return[2,(this.progress.taskState="Success",new vh(Object.assign({},this.progress),e))]}})})},El);function El(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=Al(t)}function Il(t){this.Qt=t}function Tl(t,e){this.payload=t,this.byteLength=e}function Nl(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}function Al(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var Sl=function(t){this.key=t},xl=function(t){this.key=t},Dl=(Object.defineProperty(Ll.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),Ll.prototype.fl=function(t,e){var s=this,u=e?e.dl:new fu,a=(e||this).ll,c=(e||this).De,h=a,f=!1,l=Uo(this.query)&&a.size===this.query.limit?a.last():null,p=jo(this.query)&&a.size===this.query.limit?a.first():null;if(t.Xt(function(t,e){var n=a.get(t),r=(r=e instanceof Yi?e:null)&&(Xo(s.query,r)?r:null),i=!!n&&s.De.has(n.key),o=!!r&&(r.Vt||s.De.has(r.key)&&r.hasCommittedMutations),e=!1;n&&r?n.data().isEqual(r.data())?i!==o&&(u.track({type:3,doc:r}),e=!0):s.wl(n,r)||(u.track({type:2,doc:r}),e=!0,(l&&0<s.hl(r,l)||p&&s.hl(r,p)<0)&&(f=!0)):!n&&r?(u.track({type:0,doc:r}),e=!0):n&&!r&&(u.track({type:1,doc:n}),e=!0,(l||p)&&(f=!0)),e&&(c=r?(h=h.add(r),o?c.add(t):c.delete(t)):(h=h.delete(t),c.delete(t)))}),Uo(this.query)||jo(this.query))for(;h.size>this.query.limit;){var n=Uo(this.query)?h.last():h.first(),h=h.delete(n.key),c=c.delete(n.key);u.track({type:1,doc:n})}return{ll:h,dl:u,lc:f,De:c}},Ll.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},Ll.prototype.wi=function(t,e,n){var o=this,r=this.ll;this.ll=t.ll,this.De=t.De;var i=t.dl.ve();i.sort(function(t,e){return r=t.type,i=e.type,n(r)-n(i)||o.hl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ar()}}var r,i}),this.El(n);var s=e?this.Tl():[],e=(n=0===this.ul.size&&this.Be?1:0)!==this.al;return this.al=n,0!==i.length||e?{snapshot:new lu(this.query,t.ll,r,i,t.De,0==n,e,!1),Il:s}:{Il:s}},Ll.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new fu,De:this.De,lc:!1},!1)):{Il:[]}},Ll.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},Ll.prototype.El=function(t){var e=this;t&&(t.qe.forEach(function(t){return e.cl=e.cl.add(t)}),t.Ue.forEach(function(t){}),t.Qe.forEach(function(t){return e.cl=e.cl.delete(t)}),this.Be=t.Be)},Ll.prototype.Tl=function(){var e=this;if(!this.Be)return[];var n=this.ul;this.ul=au(),this.ll.forEach(function(t){e.ml(t.key)&&(e.ul=e.ul.add(t.key))});var r=[];return n.forEach(function(t){e.ul.has(t)||r.push(new xl(t))}),this.ul.forEach(function(t){n.has(t)||r.push(new Sl(t))}),r},Ll.prototype.Al=function(t){return this.cl=t.Rc,this.ul=au(),t=this.fl(t.documents),this.wi(t,!0)},Ll.prototype.Rl=function(){return lu.Ne(this.query,this.ll,this.De,0===this.al)},Ll),Ol=function(t,e,n){this.query=t,this.targetId=e,this.view=n},kl=function(t){this.key=t,this.Pl=!1},Pl=(Object.defineProperty(Cl.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),Cl);function Cl(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Nc(Yo,Qo),this.Sl=new Map,this.Dl=new Set,this.Cl=new Ys(ui.H),this.xl=new Map,this.Nl=new Mh,this.$l={},this.Fl=new Map,this.Ol=Vc.Li(),this.onlineState="Unknown",this.kl=void 0}function Ll(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=au(),this.De=au(),this.hl=Wo(t),this.ll=new hu(this.hl)}function Rl(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return i.Ll=function(t,e,n){return function(r,i,o,s){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=i.view.fl(o)).lc?[4,kh(r.bh,i.query,!1).then(function(t){return t=t.documents,i.view.fl(t,e)})]:[3,2];case 1:e=t.sent(),t.label=2;case 2:return n=s&&s.$e.get(i.targetId),n=i.view.wi(e,r.Ml,n),[2,(zl(r,i.targetId,n.Il),n.snapshot)]}})})}(i,t,e,n)},[4,kh(i.bh,o,!0)];case 1:return n=t.sent(),r=new Dl(o,n.Rc),e=r.fl(n.documents),n=du.Le(s,u&&"Offline"!==i.onlineState),n=r.wi(e,i.Ml,n),zl(i,s,n.Il),r=new Ol(o,s,r),[2,(i.vl.set(o,r),i.Sl.has(s)?i.Sl.get(s).push(o):i.Sl.set(s,[o]),n.snapshot)]}})})}function Vl(l,p,d){return y(this,void 0,void 0,function(){var s,u;return v(this,function(t){switch(t.label){case 0:u=Wl(l),t.label=1;case 1:return t.trys.push([1,5,,6]),[4,(i=u.bh,a=p,h=i,f=ni.now(),o=a.reduce(function(t,e){return t.add(e.key)},au()),h.persistence.runTransaction("Locally write mutations","readwrite",function(u){return h.Tc.Xo(u,o).next(function(t){c=t;for(var e,n=[],r=0,i=a;r<i.length;r++){var o=i[r],s=(e=o,s=c.get(o.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Yi?e.field(o.field):void 0;null!=(s=ns(o.transform,s||null))&&(n=(null==n?new qi:n).set(o.field,s))}return n?n.Pt():null}(e.fieldTransforms,s));null!=s&&n.push(new Os(o.key,s,function s(t){var u=[];return yi(t.fields||{},function(t,e){var n=new si([t]);if(ji(e))if(0===(e=s(e.mapValue).fields).length)u.push(n);else for(var r=0,i=e;r<i.length;r++){var o=i[r];u.push(n.child(o))}else u.push(n)}),new gi(u)}(s.proto.mapValue),_s.exists(!0)))}return h.zo.Ri(u,f,n,a)})}).then(function(t){var e=t.xs(c);return{batchId:t.batchId,ri:e}}))];case 2:return s=t.sent(),u.Vl.Ca(s.batchId),e=u,n=s.batchId,r=d,i=(i=(i=e.$l[e.currentUser.A()])||new Ys(Or)).zt(n,r),e.$l[e.currentUser.A()]=i,[4,Ql(u,s.ri)];case 3:return t.sent(),[4,ul(u.yl)];case 4:return t.sent(),[3,6];case 5:return u=_a(u=t.sent(),"Failed to persist write"),d.reject(u),[3,6];case 6:return[2]}var e,n,r,i,a,c,h,f,o})})}function Ml(o,s){return y(this,void 0,void 0,function(){var n,i;return v(this,function(t){switch(t.label){case 0:n=o,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.bh,a=e,c=(r=s).Ot,h=a.fc,a.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var t=a.Ec.Nr({Wr:!0});h=a.fc;var u=[];r.$e.forEach(function(t,e){var n,r,i,o=h.get(e);o&&(u.push(a._o.sr(s,t.Qe,e).next(function(){return a._o.er(s,t.qe,e)})),0<(i=t.resumeToken).l()&&(n=o.Mt(i,c).kt(s.bs),h=h.zt(e,n),r=o,i=t,Sr(0<(o=n).resumeToken.l()),(0===r.resumeToken.l()||3e8<=o.Ot.W()-r.Ot.W()||0<i.qe.size+i.Ue.size+i.Qe.size)&&u.push(a._o.Hi(s,n))))});var e,n=nu;return r.Oe.forEach(function(t,e){r.ke.has(t)&&u.push(a.persistence.Ti.Fr(s,t))}),u.push(xh(s,t,r.Oe,c,void 0).next(function(t){n=t})),c.isEqual(ri.min())||(e=a._o.Qi(s).next(function(t){return a._o.Wi(s,s.bs,c)}),u.push(e)),ra.Mn(u).next(function(){return t.apply(s)}).next(function(){return a.Tc.Zo(s,n)})}).then(function(t){return a.fc=h,t}))];case 2:return i=t.sent(),s.$e.forEach(function(t,e){(e=n.xl.get(e))&&(Sr(t.qe.size+t.Ue.size+t.Qe.size<=1),0<t.qe.size?e.Pl=!0:0<t.Ue.size?Sr(e.Pl):0<t.Qe.size&&(Sr(e.Pl),e.Pl=!1))}),[4,Ql(n,i,s)];case 3:return t.sent(),[3,6];case 4:return[4,Tc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,a,c,h})})}function Ul(t,n,e){var r;((t=t).Ml&&0===e||!t.Ml&&1===e)&&(r=[],t.vl.forEach(function(t,e){(e=e.view.Gh(n)).snapshot&&r.push(e.snapshot)}),function(t,i){t.onlineState=i;var o=!1;t.queries.forEach(function(t,e){for(var n=0,r=e.listeners;n<r.length;n++)r[n].Gh(i)&&(o=!0)}),o&&gl(t)}(t.gl,n),r.length&&t.bl.ah(r),t.onlineState=n,t.Ml&&t.Vl.Qa(n))}function jl(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:rl((n=o).yl)||Er("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,(e=n.bh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return e.zo.Vi(t)})];case 2:return-1===(r=t.sent())?[2,void s.resolve()]:((i=n.Fl.get(r)||[]).push(s),n.Fl.set(r,i),[3,4]);case 3:return i=_a(i=t.sent(),"Initialization of waitForPendingWrites() operation failed"),s.reject(i),[3,4];case 4:return[2]}var e})})}function Fl(t,e){(t.Fl.get(e)||[]).forEach(function(t){t.resolve()}),t.Fl.delete(e)}function ql(t,e,n){var r=t,i=r.$l[r.currentUser.A()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i)}function Bl(e,t,n){void 0===n&&(n=null),e.Vl.ka(t);for(var r=0,i=e.Sl.get(t);r<i.length;r++){var o=i[r];e.vl.delete(o),n&&e.bl.Bl(o,n)}e.Sl.delete(t),e.Ml&&e.Nl.Fc(t).forEach(function(t){e.Nl.Fi(t)||Gl(e,t)})}function Gl(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Zf(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),Hl(t))}function zl(t,e,n){for(var r,i,o,s=0,u=n;s<u.length;s++){var a=u[s];a instanceof Sl?(t.Nl.nr(a.key,e),r=t,o=void 0,i=(o=a.key).path.rt(),r.Cl.get(o)||r.Dl.has(i)||(Er("SyncEngine","New document in limbo: "+o),r.Dl.add(i),Hl(r))):a instanceof xl?(Er("SyncEngine","Document no longer in limbo: "+a.key),t.Nl.ir(a.key,e),t.Nl.Fi(a.key)||Gl(t,a.key)):Ar()}}function Hl(t){for(;0<t.Dl.size&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new ui(ii.ot(e)),e=t.Ol.next();t.xl.set(e,new kl(n)),t.Cl=t.Cl.zt(n,e),Jf(t.yl,new Jo(zo(Mo(n.path)),e,2,Kr.q))}}function Ql(e,s,u){return y(this,void 0,void 0,function(){var n,r,i,o;return v(this,function(t){switch(t.label){case 0:return r=[],i=[],o=[],(n=e).vl.et()?[3,3]:(n.vl.forEach(function(t,e){o.push(n.Ll(e,s,u).then(function(t){t&&(n.Ml&&n.Vl.Ba(e.targetId,t.fromCache?"not-current":"current"),r.push(t),t=mh.oc(e.targetId,t),i.push(t))}))}),[4,Promise.all(o)]);case 1:return t.sent(),n.bl.ah(r),[4,function(a,c){return y(this,void 0,void 0,function(){var r,e,n,i,o,s,u;return v(this,function(t){switch(t.label){case 0:r=a,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,r.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(n){return ra.forEach(c,function(e){return ra.forEach(e.ic,function(t){return r.persistence.Ti.nr(n,e.targetId,t)}).next(function(){return ra.forEach(e.rc,function(t){return r.persistence.Ti.ir(n,e.targetId,t)})})})})];case 2:return t.sent(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Er("LocalStore","Failed to update sequence numbers: "+e),[3,4];case 4:for(n=0,i=c;n<i.length;n++)u=i[n],o=u.targetId,u.fromCache||(s=r.fc.get(o),u=s.Ot,u=s.Lt(u),r.fc=r.fc.zt(o,u));return[2]}})})}(n.bh,i)];case 2:t.sent(),t.label=3;case 3:return[2]}})})}function Yl(p,d){return y(this,void 0,void 0,function(){var e,n,r,i,o,s,u,a,c,h,f,l;return v(this,function(t){switch(t.label){case 0:e=p,n=[],r=[],i=0,o=d,t.label=1;case 1:return i<o.length?(s=o[i],u=void 0,(a=e.Sl.get(s))&&0!==a.length?[4,Dh(e.bh,zo(a[0]))]:[3,7]):[3,13];case 2:u=t.sent(),c=0,h=a,t.label=3;case 3:return c<h.length?(f=h[c],f=e.vl.get(f),[4,function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,kh((e=r).bh,i.query,!0)];case 1:return n=t.sent(),n=i.view.Al(n),[2,(e.Ml&&zl(e,i.targetId,n.Il),n)]}})})}(e,f)]):[3,6];case 4:(f=t.sent()).snapshot&&r.push(f.snapshot),t.label=5;case 5:return c++,[3,3];case 6:return[3,11];case 7:return[4,Ph(e.bh,s)];case 8:return l=t.sent(),[4,Dh(e.bh,l)];case 9:return u=t.sent(),[4,Rl(e,Kl(l),s,!1)];case 10:t.sent(),t.label=11;case 11:n.push(u),t.label=12;case 12:return i++,[3,1];case 13:return[2,(e.bl.ah(r),n)]}})})}function Kl(t){return Vo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function Xl(t){return t.yl.Dh.Lh=Ml.bind(null,t),t.yl.Dh.vn=function(t,e){var n=t;if((t=n.xl.get(e))&&t.Pl)return au().add(t.key);var r=au();if(!(e=n.Sl.get(e)))return r;for(var i=0,o=e;i<o.length;i++)var s=o[i],s=n.vl.get(s),r=r.Pe(s.view._l);return r}.bind(null,t),t.yl.Dh.Mh=function(o,s,u){return y(this,void 0,void 0,function(){var e,n,r,i;return v(this,function(t){switch(t.label){case 0:return(e=o).Vl.Ba(s,"rejected",u),i=e.xl.get(s),(n=i&&i.key)?(r=(r=new Ys(ui.H)).zt(n,new Ki(n,ri.min())),i=au().add(n),i=new pu(ri.min(),new Map,new tu(Or),r,i),[4,Ml(e,i)]):[3,2];case 1:return t.sent(),e.Cl=e.Cl.remove(n),e.xl.delete(s),Hl(e),[3,4];case 2:return[4,Oh(e.bh,s,!1).then(function(){return Bl(e,s,u)}).catch(Tc)];case 3:t.sent(),t.label=4;case 4:return[2]}})})}.bind(null,t),t.bl.ah=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].zh(s)&&(r=!0);u.Kh=s}}r&&gl(n)}.bind(null,t.gl),t.bl.Bl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.gl),t}function Wl(t){return t.yl.Dh.Bh=function(o,s){return y(this,void 0,void 0,function(){var n,r,i;return v(this,function(t){switch(t.label){case 0:n=o,r=s.batch.batchId,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.bh,h=s,(f=e).persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,e=h.batch.keys(),n=f.Ec.Nr({Wr:!0}),i=f,o=t,s=n,u=(r=h).batch,a=u.keys(),c=ra.resolve();return a.forEach(function(n){c=c.next(function(){return s._i(o,n)}).next(function(t){var e=t;Sr(null!==(t=r.$s.get(n))),(!e||e.version._(t)<0)&&(e=u.Ss(n,e,r))&&s.ai(e,r.Ns)})}),c.next(function(){return i.zo.Ci(o,u)}).next(function(){return n.apply(t)}).next(function(){return f.zo.$i(t)}).next(function(){return f.Tc.Xo(t,e)})}))];case 2:return i=t.sent(),ql(n,r,null),Fl(n,r),n.Vl.Na(r,"acknowledged"),[4,Ql(n,i)];case 3:return t.sent(),[3,6];case 4:return[4,Tc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,h,f})})}.bind(null,t),t.yl.Dh.qh=function(s,u,a){return y(this,void 0,void 0,function(){var n,o;return v(this,function(t){switch(t.label){case 0:n=s,t.label=1;case 1:return t.trys.push([1,4,,6]),[4,(e=n.bh,r=u,(i=e).persistence.runTransaction("Reject batch","readwrite-primary",function(e){var n;return i.zo.Pi(e,r).next(function(t){return Sr(null!==t),n=t.keys(),i.zo.Ci(e,t)}).next(function(){return i.zo.$i(e)}).next(function(){return i.Tc.Xo(e,n)})}))];case 2:return o=t.sent(),ql(n,u,a),Fl(n,u),n.Vl.Na(u,"rejected",a),[4,Ql(n,o)];case 3:return t.sent(),[3,6];case 4:return[4,Tc(t.sent())];case 5:return t.sent(),[3,6];case 6:return[2]}var e,r,i})})}.bind(null,t),t}function Jl(t,e,n){var r=t;!function(l,p,d){return y(this,void 0,void 0,function(){var u,a,c,h,f;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,14,,15]),[4,p.getMetadata()];case 1:return u=t.sent(),[4,(r=l.bh,o=r,s=Lu((i=u).createTime),o.persistence.runTransaction("hasNewerBundle","readonly",function(t){return o.wo.Os(t,i.id)}).then(function(t){return!!t&&0<=t.createTime._(s)}))];case 2:return t.sent()?[4,p.close()]:[3,4];case 3:return[2,(t.sent(),void d.ql({taskState:"Success",documentsLoaded:u.totalDocuments,bytesLoaded:u.totalBytes,totalDocuments:u.totalDocuments,totalBytes:u.totalBytes}))];case 4:return d.Ul(Al(u)),a=new _l(u,l.bh,p.Qt),[4,p.Ql()];case 5:c=t.sent(),t.label=6;case 6:return c?[4,a.rl(c)]:[3,10];case 7:return(h=t.sent())&&d.Ul(h),[4,p.Ql()];case 8:c=t.sent(),t.label=9;case 9:return[3,6];case 10:return[4,a.complete()];case 11:return f=t.sent(),[4,Ql(l,f.Go,void 0)];case 12:return t.sent(),[4,(r=l.bh,e=u,(n=r).persistence.runTransaction("Save bundle","readwrite",function(t){return n.wo.ks(t,e)}))];case 13:return t.sent(),d.ql(f.progress),[3,15];case 14:return Tr("SyncEngine","Loading bundle failed with "+(f=t.sent())),d.Kl(f),[3,15];case 15:return[2]}var e,n,r,i,o,s})})}(r,e,n).then(function(){r.Vl.Wa()})}var Zl,$l,tp=(up.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Qt=Cf(e.yu.t),this.Vl=this.Wl(e),this.persistence=this.jl(e),[4,this.persistence.start()];case 1:return t.sent(),this.Gl=this.zl(e),this.bh=this.Hl(e),[2]}})})},up.prototype.zl=function(t){return null},up.prototype.Hl=function(t){return Nh(this.persistence,new bh,t.Jl,this.Qt)},up.prototype.jl=function(t){return new Gh(Hh.ia,this.Qt)},up.prototype.Wl=function(t){return new pf},up.prototype.terminate=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}})})},up),ep=(h(sp,$l=tp),sp.prototype.initialize=function(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,$l.prototype.initialize.call(this,e)];case 1:return t.sent(),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,(e=n).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=oh(t),r=ri.min(),t.hs({index:Ra.readTimeIndex,reverse:!0},function(t,e,n){e.readTime&&(r=rc(e.readTime)),n.done()}).next(function(){return r});var r}).then(function(t){e.wc=t})]})})}(this.bh)];case 2:return t.sent(),[4,this.Yl.initialize(this,e)];case 3:return t.sent(),[4,Wl(this.Yl._a)];case 4:return t.sent(),[4,ul(this.Yl.yl)];case 5:return t.sent(),[2]}})})},sp.prototype.Hl=function(t){return Nh(this.persistence,new bh,t.Jl,this.Qt)},sp.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new Hc(e,t._s)},sp.prototype.jl=function(t){var e=yh(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?Ec.Ys(this.cacheSizeBytes):Ec.ti;return new fh(this.synchronizeTabs,e,t.clientId,n,t._s,kf(),Pf(),this.Qt,this.Vl,!!this.forceOwnership)},sp.prototype.Wl=function(t){return new pf},sp),np=(h(op,Zl=ep),op.prototype.initialize=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:return[4,Zl.prototype.initialize.call(this,r)];case 1:return t.sent(),e=this.Yl._a,this.Vl instanceof lf?(this.Vl._a={eu:function(u,a,c,h){return y(this,void 0,void 0,function(){var o,s;return v(this,function(t){switch(t.label){case 0:return[4,(e=(o=u).bh,n=a,i=(r=e).zo,r.persistence.runTransaction("Lookup mutation documents","readonly",function(e){return i.yi(e,n).next(function(t){return t?r.Tc.Xo(e,t):ra.resolve(null)})}))];case 1:return null===(s=t.sent())?[3,6]:"pending"!==c?[3,3]:[4,ul(o.yl)];case 2:return t.sent(),[3,4];case 3:"acknowledged"===c||"rejected"===c?(ql(o,a,h||null),Fl(o,a),o.bh.zo.xi(a)):Ar(),t.label=4;case 4:return[4,Ql(o,s)];case 5:return t.sent(),[3,7];case 6:Er("SyncEngine","Cannot apply mutation batch with id: "+a),t.label=7;case 7:return[2]}var e,n,r,i})})}.bind(null,e),nu:function(i,o,s,u){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return(e=i).kl?(Er("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!e.Sl.has(o))return[3,8];switch(s){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Ch(e.bh)];case 3:return n=t.sent(),r=pu.Me(o,"current"===s),[4,Ql(e,n,r)];case 4:return t.sent(),[3,8];case 5:return[4,Oh(e.bh,o,!0)];case 6:return t.sent(),Bl(e,o,u),[3,8];case 7:Ar(),t.label=8;case 8:return[2]}})})}.bind(null,e),su:function(c,h,f){return y(this,void 0,void 0,function(){var n,e,r,i,o,s,u,a;return v(this,function(t){switch(t.label){case 0:if(!(n=Xl(c)).kl)return[3,10];e=0,r=h,t.label=1;case 1:return e<r.length?(r=r[e],n.Sl.has(r)?(Er("SyncEngine","Adding an already active target "+r),[3,5]):[4,Ph(n.bh,r)]):[3,6];case 2:return i=t.sent(),[4,Dh(n.bh,i)];case 3:return o=t.sent(),[4,Rl(n,Kl(i),o.targetId,!1)];case 4:t.sent(),Jf(n.yl,o),t.label=5;case 5:return e++,[3,1];case 6:s=function(e){return v(this,function(t){switch(t.label){case 0:return n.Sl.has(e)?[4,Oh(n.bh,e,!1).then(function(){Zf(n.yl,e),Bl(n,e)}).catch(Tc)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})},u=0,a=f,t.label=7;case 7:return u<a.length?(a=a[u],[5,s(a)]):[3,10];case 8:t.sent(),t.label=9;case 9:return u++,[3,7];case 10:return[2]}})})}.bind(null,e),Uo:function(t){return t.bh.persistence.Uo()}.bind(null,e),tu:function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return[2,Ch((e=n).bh).then(function(t){return Ql(e,t)})]})})}.bind(null,e)},[4,this.Vl.start()]):[3,3];case 2:t.sent(),t.label=3;case 3:return[4,this.persistence.Ro(function(e){return y(n,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,function(h,f){return y(this,void 0,void 0,function(){var r,e,i,o,s,u,a,c;return v(this,function(t){switch(t.label){case 0:return Xl(r=h),Wl(r),!0!==f||!0===r.kl?[3,3]:(e=r.Vl.va(),[4,Yl(r,e.it())]);case 1:return i=t.sent(),r.kl=!0,[4,hl(r.yl,!0)];case 2:for(t.sent(),o=0,s=i;o<s.length;o++)u=s[o],Jf(r.yl,u);return[3,7];case 3:return!1!==f||!1===r.kl?[3,7]:(a=[],c=Promise.resolve(),r.Sl.forEach(function(t,e){r.Vl.Ma(e)?a.push(e):c=c.then(function(){return Bl(r,e),Oh(r.bh,e,!0)}),Zf(r.yl,e)}),[4,c]);case 4:return t.sent(),[4,Yl(r,a)];case 5:return t.sent(),(n=r).xl.forEach(function(t,e){Zf(n.yl,e)}),n.Nl.Oc(),n.xl=new Map,n.Cl=new Ys(ui.H),r.kl=!1,[4,hl(r.yl,!1)];case 6:t.sent(),t.label=7;case 7:return[2]}var n})})}(this.Yl._a,e)];case 1:return t.sent(),this.Gl&&(e&&!this.Gl.Er?this.Gl.start(this.bh):e||this.Gl.stop()),[2]}})})})];case 4:return t.sent(),[2]}})})},op.prototype.Wl=function(t){var e=kf();if(!lf.Kn(e))throw new Mr(Vr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=yh(t.yu.t,t.yu.persistenceKey);return new lf(e,t._s,n,t.clientId,t.Jl)},op),rp=(ip.prototype.initialize=function(n,r){return y(this,void 0,void 0,function(){var e=this;return v(this,function(t){switch(t.label){case 0:return this.bh?[3,2]:(this.bh=n.bh,this.Vl=n.Vl,this.Sh=this.Xl(r),this.yl=this.Zl(r),this.gl=this.t_(r),this._a=this.e_(r,!n.synchronizeTabs),this.Vl.fa=function(t){return Ul(e._a,t,1)},this.yl.Dh.n_=function(i,o){return y(this,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return(n=i).currentUser.isEqual(o)?[3,3]:(Er("SyncEngine","User change. New user:",o.A()),[4,Ah(n.bh,o)]);case 1:return r=t.sent(),n.currentUser=o,(e=n).Fl.forEach(function(t){t.forEach(function(t){t.reject(new Mr(Vr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),e.Fl.clear(),n.Vl.Ua(o,r.mc,r.Ac),[4,Ql(n,r.Ic)];case 2:t.sent(),t.label=3;case 3:return[2]}var e})})}.bind(null,this._a),[4,hl(this.yl,this._a.Ml)]);case 1:t.sent(),t.label=2;case 2:return[2]}})})},ip.prototype.t_=function(t){return new pl},ip.prototype.Xl=function(t){var e=Cf(t.yu.t),n=(n=t.yu,new mf(n));return t=t.credentials,new qf(t,n,e)},ip.prototype.Zl=function(t){var e=this;return new Lf(this.bh,this.Sh,t._s,function(t){return Ul(e._a,t,0)},t=new(yf.Kn()?yf:df))},ip.prototype.e_=function(t,e){return n=this.bh,r=this.yl,i=this.gl,o=this.Vl,s=t.Jl,t=t.pl,e=e,t=new Pl(n,r,i,o,s,t),e&&(t.kl=!0),t;var n,r,i,o,s},ip.prototype.terminate=function(){return function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=n,Er("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,Wf(e)];case 1:return t.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}})})}(this.yl)},ip);function ip(){}function op(t,e){var n=this;return(n=Zl.call(this,t,e,!1)||this).Yl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function sp(t,e,n){var r=this;return(r=$l.call(this)||this).Yl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function up(){this.synchronizeTabs=!1}function ap(n,r){void 0===r&&(r=10240);var i=0;return{read:function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){return i<n.byteLength?(e={value:n.slice(i,i+r),done:!1},[2,(i+=r,e)]):[2,{done:!0}]})})},cancel:function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2]})})},releaseLock:function(){}}}var cp=(vp.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},vp.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},vp.prototype.i_=function(){this.muted=!0},vp.prototype.s_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},vp),hp=(yp.prototype.close=function(){return this.r_.cancel()},yp.prototype.getMetadata=function(){return y(this,void 0,void 0,function(){return v(this,function(t){return[2,this.metadata.promise]})})},yp.prototype.Ql=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}})})},yp.prototype.c_=function(){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return[4,this.a_()];case 1:return null===(e=t.sent())?[2,null]:(r=this.o_.decode(e),n=Number(r),isNaN(n)&&this.u_("length string ("+r+") is not valid number"),[4,this.h_(n)]);case 2:return r=t.sent(),[2,new bl(JSON.parse(r),e.length+n)]}})})},yp.prototype.l_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},yp.prototype.a_=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(t.sent())return[3,3];t.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),n=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),n)])}})})},yp.prototype.h_=function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return this.buffer.length<n?[4,this.__()]:[3,3];case 1:t.sent()&&this.u_("Reached the end of bundle when more is expected."),t.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,n)),[2,(this.buffer=this.buffer.slice(n),e)]}})})},yp.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},yp.prototype.__=function(){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,this.r_.read()];case 1:return(e=t.sent()).done||((n=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),n.set(e.value,this.buffer.length),this.buffer=n),[2,e.done]}})})},yp),fp=(dp.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},dp),lp=function(t){this._methodName=t},pp=function(t){this.d_=t};function dp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new si(t)}function yp(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new na,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then(function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function vp(t){this.observer=t,this.muted=!1}function gp(t,e,n){if(!n)throw new Mr(Vr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function mp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function bp(t,e,n,r){if(!0===e&&!0===r)throw new Mr(Vr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function wp(t){if(!ui.wt(t))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function _p(t){if(ui.wt(t))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Ep(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return 20<e.length&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"!=typeof e)return"function"==typeof e?"a function":Ar();if(e instanceof Array)return"an array";var t=function(){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&1<t.length)return t[1]}return null}();return t?"a custom "+t+" object":"an object"}function Ip(t,e){if((t="_delegate"in t?t.d_:t)instanceof e)return t;if(e.name===t.constructor.name)throw new Mr(Vr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=Ep(t),new Mr(Vr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function Tp(t,e){if(e<=0)throw new Mr(Vr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var Np,Ap=(Vp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},Vp),Sp=new Map,xp=(Object.defineProperty(Rp.prototype,"app",{get:function(){if(!this.A_)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Rp.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(Rp.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),Rp.prototype.g_=function(t){if(this.T_)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new Ap(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new zr;switch(t.type){case"gapi":var e=t.client;return Sr(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Yr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Mr(Vr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Rp.prototype.V_=function(){return this.E_},Rp.prototype.p_=function(){return this.T_=!0,this.E_},Rp.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},Rp.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},Rp.prototype.b_=function(){return(t=Sp.get(this))&&(Er("ComponentProvider","Removing Datastore"),Sp.delete(this),t.terminate()),Promise.resolve();var t},Rp),Dp=(Object.defineProperty(Lp.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Lp.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(Lp.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(Lp.prototype,"parent",{get:function(){return new kp(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),Lp.prototype.withConverter=function(t){return new Lp(this.firestore,t,this.S_)},Lp),Op=(Cp.prototype.withConverter=function(t){return new Cp(this.firestore,t,this.C_)},Cp),kp=(h(Pp,Np=Op),Object.defineProperty(Pp.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(Pp.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(Pp.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new Dp(this.firestore,null,new ui(t))},enumerable:!1,configurable:!0}),Pp.prototype.withConverter=function(t){return new Pp(this.firestore,t,this.D_)},Pp);function Pp(t,e,n){var r=this;return(r=Np.call(this,t,e,Mo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function Cp(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function Lp(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function Rp(t,e){this.w_="(lite)",this.E_=new Ap({}),this.T_=!1,t instanceof mr?(this.I_=t,this.m_=new zr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Mr(Vr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new mr(t.options.projectId)}(t),this.m_=new Hr(e))}function Vp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Mr(Vr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Mr(Vr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,bp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Mp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof pp&&(t=t.d_),gp("collection","path",e),t instanceof xp)return _p(n=ii.ot.apply(ii,f([e],r))),new kp(t,null,n);if(!(t instanceof Dp||t instanceof kp))throw new Mr(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return _p(n=ii.ot.apply(ii,f([t.path],r)).child(ii.ot(e))),new kp(t.firestore,null,n)}function Up(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof pp&&(t=t.d_),gp("doc","path",e=1===arguments.length?xr.u():e),t instanceof xp)return wp(n=ii.ot.apply(ii,f([e],r))),new Dp(t,null,new ui(n));if(!(t instanceof Dp||t instanceof kp))throw new Mr(Vr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return wp(n=t.D_.child(ii.ot.apply(ii,f([e],r)))),new Dp(t.firestore,t instanceof kp?t.v_:null,new ui(n))}function jp(t,e){return t instanceof pp&&(t=t.d_),e instanceof pp&&(e=e.d_),(t instanceof Dp||t instanceof kp)&&(e instanceof Dp||e instanceof kp)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Fp(t,e){return t instanceof pp&&(t=t.d_),e instanceof pp&&(e=e.d_),t instanceof Op&&e instanceof Op&&t.firestore===e.firestore&&Qo(t.C_,e.C_)&&t.v_===e.v_}var qp=(Object.defineProperty(Yp.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Yp.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Yp.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Yp.prototype.U=function(t){return Or(this.x_,t.x_)||Or(this.N_,t.N_)},Yp),Bp=/^__.*__$/,Gp=(Qp.prototype.F_=function(t,e){return null!==this.Gt?new Os(t,this.data,this.Gt,e,this.fieldTransforms):new Ds(t,this.data,e,this.fieldTransforms)},Qp),zp=(Hp.prototype.F_=function(t,e){return new Os(t,this.data,this.Gt,e,this.fieldTransforms)},Hp);function Hp(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function Qp(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function Yp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Mr(Vr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Mr(Vr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function Kp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Ar()}}var Xp=(Object.defineProperty(Zp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Zp.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),Zp.prototype.M_=function(t){return new Zp(Object.assign(Object.assign({},this.settings),t),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},Zp.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.M_({path:e,B_:!1})).q_(t),e},Zp.prototype.U_=function(t){var e,t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.M_({path:t,B_:!1})).O_(),t},Zp.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},Zp.prototype.K_=function(t){return Sd(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},Zp.prototype.contains=function(e){return void 0!==this.Gt.find(function(t){return e.nt(t)})||void 0!==this.fieldTransforms.find(function(t){return e.nt(t.field)})},Zp.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},Zp.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Kp(this.k_)&&Bp.test(t))throw this.K_('Document fields cannot begin and end with "__"')},Zp),Wp=(Jp.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new Xp({k_:t,methodName:e,j_:n,path:si.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},Jp);function Jp(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Cf(t)}function Zp(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}function $p(t){var e=t.p_(),n=Cf(t.I_);return new Wp(t.I_,!!e.ignoreUndefinedProperties,n)}function td(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);Id("Data must be an object, but it was:",s,r);var u,a,r=_d(r,s);if(o.merge)u=new gi(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=Td(e,f[h],n);if(!s.contains(l))throw new Mr(Vr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");xd(c,l)||c.push(l)}u=new gi(c),a=s.fieldTransforms.filter(function(t){return u.Tt(t.field)})}else u=null,a=s.fieldTransforms;return new Gp(new Fi(r),u,a)}var ed,nd=(h(rd,ed=lp),rd.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},rd.prototype.isEqual=function(t){return t instanceof rd},rd);function rd(){return null!==ed&&ed.apply(this,arguments)||this}function id(t,e,n){return new Xp({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var od,sd,ud,ad,cd=(h(vd,ad=lp),vd.prototype.z_=function(t){return new ws(t.path,new os)},vd.prototype.isEqual=function(t){return t instanceof vd},vd),hd=(h(yd,ud=lp),yd.prototype.z_=function(t){var e=id(this,t,!0),n=this.H_.map(function(t){return wd(t,e)}),n=new ss(n);return new ws(t.path,n)},yd.prototype.isEqual=function(t){return this===t},yd),fd=(h(dd,sd=lp),dd.prototype.z_=function(t){var e=id(this,t,!0),n=this.H_.map(function(t){return wd(t,e)}),n=new fs(n);return new ws(t.path,n)},dd.prototype.isEqual=function(t){return this===t},dd),ld=(h(pd,od=lp),pd.prototype.z_=function(t){var e=new ys(t.Qt,es(t.Qt,this.J_));return new ws(t.path,e)},pd.prototype.isEqual=function(t){return this===t},pd);function pd(t,e){var n=this;return(n=od.call(this,t)||this).J_=e,n}function dd(t,e){var n=this;return(n=sd.call(this,t)||this).H_=e,n}function yd(t,e){var n=this;return(n=ud.call(this,t)||this).H_=e,n}function vd(){return null!==ad&&ad.apply(this,arguments)||this}function gd(t,r,i,e){var o=t.G_(1,r,i);Id("Data must be an object, but it was:",o,e);var s=[],u=new qi;return yi(e,function(t,e){var n=Ad(r,t,i);e instanceof pp&&(e=e.d_),t=o.U_(n),e instanceof nd?s.push(n):null!=(t=wd(e,t))&&(s.push(n),u.set(n,t))}),e=new gi(s),new zp(u.Pt(),e,o.fieldTransforms)}function md(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[Td(e,r,n)],a=[i];if(o.length%2!=0)throw new Mr(Vr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(Td(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new qi,y=u.length-1;0<=y;--y)xd(p,u[y])||(h=u[y],(f=a[y])instanceof pp&&(f=f.d_),l=s.U_(h),f instanceof nd?p.push(h):null!=(l=wd(f,l))&&(p.push(h),d.set(h,l)));return i=new gi(p),new zp(d.Pt(),i,s.fieldTransforms)}function bd(t,e,n,r){return void 0===r&&(r=!1),wd(n,t.G_(r?4:3,e))}function wd(s,t){if(Ed(s=s instanceof pp?s.d_:s))return Id("Unsupported field value:",t,s),_d(s,t);if(s instanceof lp)return function(t,e){if(!Kp(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");(t=t.z_(e))&&e.fieldTransforms.push(t)}(s,t),null;if(void 0===s&&t.ignoreUndefinedProperties)return null;if(t.path&&t.Gt.push(t.path),s instanceof Array){if(t.settings.B_&&4!==t.k_)throw t.K_("Nested arrays are not supported");return function(t){for(var e=[],n=0,r=0,i=s;r<i.length;r++){var o=wd(i[r],t.Q_(n));null==o&&(o={nullValue:"NULL_VALUE"}),e.push(o),n++}return{arrayValue:{values:e}}}(t)}return function(t,e){if(null===(t=t instanceof pp?t.d_:t))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return es(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ni.fromDate(t);return{timestampValue:Pu(e.Qt,n)}}if(t instanceof ni)return n=new ni(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Pu(e.Qt,n)};if(t instanceof qp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof Ur)return{bytesValue:Cu(e.Qt,t.I)};if(t instanceof Dp){var n=e.t,r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ru(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+Ep(t))}(s,t)}function _d(t,n){var r={};return vi(t)?n.path&&0<n.path.length&&n.Gt.push(n.path):yi(t,function(t,e){null!=(e=wd(e,n.L_(t)))&&(r[t]=e)}),{mapValue:{fields:r}}}function Ed(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ni||t instanceof qp||t instanceof Ur||t instanceof Dp||t instanceof lp)}function Id(t,e,n){if(!Ed(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=Ep(n))?e.K_(t+" a custom object"):e.K_(t+" "+n);var r}function Td(t,e,n){if((e=e instanceof pp?e.d_:e)instanceof fp)return e.f_;if("string"==typeof e)return Ad(t,e);throw Sd("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var Nd=new RegExp("[~\\*/\\[\\]]");function Ad(e,n,r){if(0<=n.search(Nd))throw Sd("Invalid field path ("+n+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,r);try{return(new(fp.bind.apply(fp,f([void 0],n.split("."))))).f_}catch(t){throw Sd("Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,r)}}function Sd(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i,e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Mr(Vr.INVALID_ARGUMENT,(e+=". ")+t+n)}function xd(t,e){return t.some(function(t){return t.isEqual(e)})}var Dd=(Ld.prototype.ef=function(r){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),0<this.mutations.length)throw new Mr(Vr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return y(this,void 0,void 0,function(){var r,e,n,i,o;return v(this,function(t){switch(t.label){case 0:return e=qu((r=s).Qt)+"/documents",n={documents:u.map(function(t){return Mu(r.Qt,t)})},[4,r.Du("BatchGetDocuments",e,n)];case 1:return n=t.sent(),i=new Map,n.forEach(function(t){var e,n,t=(n=r.Qt,"found"in t?function(t,e){Sr(!!e.found),e.found.name,e.found.updateTime;var n=Uu(t,e.found.name),t=Lu(e.found.updateTime),e=new Fi({mapValue:{fields:e.found.fields}});return new Yi(n,t,e,{})}(n,t):"missing"in t?(e=n,Sr(!!(n=t).missing),Sr(!!n.readTime),e=Uu(e,n.missing),n=Lu(n.readTime),new Ki(e,n)):Ar());i.set(t.key.toString(),t)}),o=[],[2,(u.forEach(function(t){Sr(!!(t=i.get(t.toString()))),o.push(t)}),o)]}})})}(this.Sh,r)];case 1:return[2,((e=t.sent()).forEach(function(t){t instanceof Ki||t instanceof Yi?n.sf(t):Ar()}),e)]}})})},Ld.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},Ld.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},Ld.prototype.delete=function(t){this.write(new qs(t,this.jt(t))),this.tf.add(t.toString())},Ld.prototype.commit=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return e=this.Y_,this.mutations.forEach(function(t){e.delete(t.key.toString())}),e.forEach(function(t,e){e=ui._t(e),n.mutations.push(new Bs(e,n.jt(e)))}),[4,function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=qu((e=i).Qt)+"/documents",r={writes:o.map(function(t){return Hu(e.Qt,t)})},[4,e.pu("Commit",n,r)];case 1:return t.sent(),[2]}})})}(this.Sh,this.mutations)];case 1:return t.sent(),this.X_=!0,[2]}})})},Ld.prototype.sf=function(t){var e;if(t instanceof Yi)e=t.version;else{if(!(t instanceof Ki))throw Ar();e=ri.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Mr(Vr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},Ld.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?_s.updateTime(e):_s.Kt()},Ld.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return _s.exists(!0);if(e.isEqual(ri.min()))throw new Mr(Vr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return _s.updateTime(e)},Ld.prototype.write=function(t){this.nf(),this.mutations.push(t)},Ld.prototype.nf=function(){},Ld),Od=(Cd.prototype.run=function(){this.af()},Cd.prototype.af=function(){var t=this;this.Gu.Lu(function(){return y(t,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){return e=new Dd(this.Sh),(n=this.uf(e))&&n.then(function(t){r._s.Ps(function(){return e.commit().then(function(){r.Es.resolve(t)}).catch(function(t){r.hf(t)})})}).catch(function(t){r.hf(t)}),[2]})})})},Cd.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Ni(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},Cd.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this._s.Ps(function(){return e.af(),Promise.resolve()})):this.Es.reject(t)},Cd.prototype.lf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Hs(t))},Cd),kd=(Pd.prototype.getConfiguration=function(){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}})})},Pd.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then(function(){return e._f(e.user)})},Pd.prototype.df=function(){if(this._s.wf)throw new Mr(Vr.FAILED_PRECONDITION,"The client has already been terminated.")},Pd.prototype.terminate=function(){var t=this;this._s.Ef();var n=new na;return this._s.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:t.sent(),t.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:t.sent(),t.label=4;case 4:return this.credentials.S(),n.resolve(),[3,6];case 5:return e=_a(t.sent(),"Failed to shutdown persistence"),n.reject(e),[3,6];case 6:return[2]}})})}),n.promise},Pd);function Pd(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=jr.UNAUTHENTICATED,this.clientId=xr.u(),this._f=function(){},this.C=new na,this.credentials.v(function(t){Er("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()})}function Cd(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Uf(this._s,"transaction_retry")}function Ld(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function Rd(i,o){return y(this,void 0,void 0,function(){var e,n,r=this;return v(this,function(t){switch(t.label){case 0:return i._s.Af(),Er("FirestoreClient","Initializing OfflineComponentProvider"),[4,i.getConfiguration()];case 1:return e=t.sent(),[4,o.initialize(e)];case 2:return t.sent(),n=e.Jl,i.ff(function(e){n.isEqual(e)||(n=e,i._s.po(function(){return y(r,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return[4,Ah(o.bh,e)];case 1:return t.sent(),[2]}})})}))}),o.persistence.Po(function(){return i.terminate()}),i.mf=o,[2]}})})}function Vd(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return r._s.Af(),[4,Md(r)];case 1:return e=t.sent(),Er("FirestoreClient","Initializing OnlineComponentProvider"),[4,r.getConfiguration()];case 2:return n=t.sent(),[4,i.initialize(e,n)];case 3:return t.sent(),r.ff(function(t){return r._s.po(function(){return function(r,i){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return(e=r)._s.Af(),Er("RemoteStore","RemoteStore received new credentials"),n=rl(e),e.Nh.add(3),[4,Wf(e)];case 1:return t.sent(),n&&e.Oh.set("Unknown"),[4,e.Dh.n_(i)];case 2:return t.sent(),e.Nh.delete(3),[4,Xf(e)];case 3:return t.sent(),[2]}})})}(i.yl,t)})}),r.If=i,[2]}})})}function Md(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.mf?[3,2]:(Er("FirestoreClient","Using default OfflineComponentProvider"),[4,Rd(e,new tp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.mf]}})})}function Ud(e){return y(this,void 0,void 0,function(){return v(this,function(t){switch(t.label){case 0:return e.If?[3,2]:(Er("FirestoreClient","Using default OnlineComponentProvider"),[4,Vd(e,new rp)]);case 1:t.sent(),t.label=2;case 2:return[2,e.If]}})})}function jd(t){return Md(t).then(function(t){return t.persistence})}function Fd(t){return Md(t).then(function(t){return t.bh})}function qd(t){return Ud(t).then(function(t){return t.yl})}function Bd(t){return Ud(t).then(function(t){return t._a})}function Gd(r){return y(this,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,Ud(r)];case 1:return e=t.sent(),[2,((n=e.gl).jh=function(s,u){return y(this,void 0,void 0,function(){var e,n,r,i,o;return v(this,function(t){switch(t.label){case 0:return e=Xl(s),(o=e.vl.get(u))?(n=o.targetId,e.Vl.Fa(n),r=o.view.Rl(),[3,4]):[3,1];case 1:return[4,Dh(e.bh,zo(u))];case 2:return i=t.sent(),o=e.Vl.Fa(i.targetId),n=i.targetId,[4,Rl(e,u,n,"current"===o)];case 3:r=t.sent(),e.Ml&&Jf(e.yl,i),t.label=4;case 4:return[2,r]}})})}.bind(null,e._a),n.Hh=function(i,o){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return n=(e=i).vl.get(o),1<(r=e.Sl.get(n.targetId)).length?[2,(e.Sl.set(n.targetId,r.filter(function(t){return!Qo(t,o)})),void e.vl.delete(o))]:e.Ml?(e.Vl.ka(n.targetId),e.Vl.Da(n.targetId)?[3,2]:[4,Oh(e.bh,n.targetId,!1).then(function(){e.Vl.La(n.targetId),Zf(e.yl,n.targetId),Bl(e,n.targetId)}).catch(Tc)]):[3,3];case 1:t.sent(),t.label=2;case 2:return[3,5];case 3:return Bl(e,n.targetId),[4,Oh(e.bh,n.targetId,!0)];case 4:t.sent(),t.label=5;case 5:return[2]}})})}.bind(null,e._a),n)]}})})}function zd(n,r,i){var t=this;void 0===i&&(i={});var o=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(n,r,i,o,s){var t=new cp({next:function(t){r.Ps(function(){return vl(n,u)});var e=t.docs.has(i);!e&&t.fromCache?s.reject(new Mr(Vr.UNAVAILABLE,"Failed to get document because the client is offline.")):e&&t.fromCache&&o&&"server"===o.source?s.reject(new Mr(Vr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(t)},error:function(t){return s.reject(t)}}),u=new ml(Mo(i.path),t,{includeMetadataChanges:!0,nl:!0});return yl(n,u)},[4,Gd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}function Hd(n,r,i){var t=this;void 0===i&&(i={});var o=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(e,n,t,r,i){var o=new cp({next:function(t){n.Ps(function(){return vl(e,s)}),t.fromCache&&"server"===r.source?i.reject(new Mr(Vr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(t)},error:function(t){return i.reject(t)}}),s=new ml(t,o,{includeMetadataChanges:!0,nl:!0});return yl(e,s)},[4,Gd(n)];case 1:return[2,e.apply(void 0,[t.sent(),n._s,r,i,o])]}})})}),o.promise}var Qd=(Object.defineProperty(Yd.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),Yd.prototype.Ps=function(t){this.enqueue(t)},Yd.prototype.Tf=function(t){this.Sf(),this.Df(t)},Yd.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Pf())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},Yd.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},Yd.prototype.po=function(t){var e=this;this.Ps(function(){return e.Pf.push(t),e.Cf()})},Yd.prototype.Cf=function(){return y(this,void 0,void 0,function(){var e,n=this;return v(this,function(t){switch(t.label){case 0:if(0===this.Pf.length)return[3,5];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return t.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!pa(e=t.sent()))throw e;return Er("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:0<this.Pf.length&&this.Gu.Lu(function(){return n.Cf()}),t.label=5;case 5:return[2]}})})},Yd.prototype.Df=function(t){var r=this,e=this.Rf.then(function(){return r.pf=!0,t().catch(function(t){throw r.Vf=t,r.pf=!1,Ir("INTERNAL UNHANDLED ERROR: ",(n=(e=t).message||"",n=e.stack?e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack:n)),t;var e,n}).then(function(t){return r.pf=!1,t})});return this.Rf=e},Yd.prototype.Tr=function(t,e,n){var r=this;return this.Sf(),-1<this.bf.indexOf(t)&&(e=0),n=ba.Ts(this,t,e,n,function(t){return r.xf(t)}),this.gf.push(n),n},Yd.prototype.Sf=function(){this.Vf&&Ar()},Yd.prototype.Af=function(){},Yd.prototype.Nf=function(){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,e=this.Rf];case 1:t.sent(),t.label=2;case 2:if(e!==this.Rf)return[3,0];t.label=3;case 3:return[2]}})})},Yd.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},Yd.prototype.Ff=function(r){var i=this;return this.Nf().then(function(){i.gf.sort(function(t,e){return t.ds-e.ds});for(var t=0,e=i.gf;t<e.length;t++){var n=e[t];if(n.Rs(),"all"!==r&&n.fs===r)break}return i.Nf()})},Yd.prototype.Of=function(t){this.bf.push(t)},Yd.prototype.xf=function(t){t=this.gf.indexOf(t),this.gf.splice(t,1)},Yd);function Yd(){var e=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Uf(this,"async_queue_retry"),this.vf=function(){var t=Pf();t&&Er("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Gu.qu()};var t=Pf();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.vf)}function Kd(i){return function(){if("object"==typeof i&&null!==i)for(var t=i,e=0,n=["next","error","complete"];e<n.length;e++){var r=n[e];if(r in t&&"function"==typeof t[r])return 1}}()}var Xd,Wd=($d.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},$d.prototype.catch=function(t){return this.Mf.promise.catch(t)},$d.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},$d.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},$d.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},$d.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)},$d),Jd=(h(Zd,Xd=xp),Zd.prototype.b_=function(){return this.qf||ey(this),this.qf.terminate()},Zd);function Zd(t,e){var n=this;return(n=Xd.call(this,t,e)||this).Bf=new Qd,n.w_="name"in t?t.name:"[DEFAULT]",n}function $d(){this.kf={},this.Mf=new na,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function ty(t){return t.qf||ey(t),t.qf.df(),t.qf}function ey(t){var e,n,r=t.p_(),r=(e=t.I_,n=t.w_,new gr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling));t.qf=new kd(t.m_,t.Bf,r)}function ny(r,i,o){var t=this,s=new na;return r._s.enqueue(function(){return y(t,void 0,void 0,function(){var n;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),[4,Rd(r,o)];case 1:return t.sent(),[4,Vd(r,i)];case 2:return t.sent(),s.resolve(),[3,4];case 3:if(!("FirebaseError"===(e=n=t.sent()).name?e.code===Vr.FAILED_PRECONDITION||e.code===Vr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code))throw n;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+n),s.reject(n),[3,4];case 4:return[2]}var e})})}).then(function(){return s.promise})}function ry(t){if(t.R_||t.P_)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var iy,o=(cy.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),xi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return _i(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(Ei(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw Ar()}},cy.prototype.Hf=function(t,n){var r=this,i={};return yi(t.fields||{},function(t,e){i[t]=r.Uf(e,n)}),i},cy.prototype.Gf=function(t){return new qp(_i(t.latitude),_i(t.longitude))},cy.prototype.zf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Uf(t,e)})},cy.prototype.Kf=function(t,e){switch(e){case"previous":var n=function t(e){return Ii(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Ti(t));default:return null}},cy.prototype.Qf=function(t){return t=wi(t),new ni(t.seconds,t.nanos)},cy.prototype.Jf=function(t,e){var n=ii.ot(t);return Sr(ta(n)),t=new mr(n.get(1),n.get(3)),n=new ui(n.Y(5)),t.isEqual(e)||Ir("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},cy),oy=(Object.defineProperty(ay.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(ay.prototype,"ref",{get:function(){return new Dp(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),ay.prototype.exists=function(){return null!==this.Zf},ay.prototype.data=function(){if(this.Zf){if(this.v_){var t=new sy(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},ay.prototype.get=function(t){if(this.Zf&&null!==(t=this.Zf.data().field(hy("DocumentSnapshot.get",t))))return this.Xf.Uf(t)},ay),sy=(h(uy,iy=oy),uy.prototype.data=function(){return iy.prototype.data.call(this)},uy);function uy(){return null!==iy&&iy.apply(this,arguments)||this}function ay(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}function cy(){}function hy(t,e){return"string"==typeof e?Ad(t,e):(e instanceof pp?e.d_:e).f_}function fy(t){if(jo(t)&&0===t.xt.length)throw new Mr(Vr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function ly(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].td(t);return t}var py,dy,yy,vy,gy,my=(h(Sy,gy=me=function(){}),Sy.prototype.td=function(t){var e=$p(t.firestore),e=function(t,e,n,r,i,o){if(r.ut()){if("array-contains"===i||"array-contains-any"===i)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Oy(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Dy(n,t,c))}h={arrayValue:{values:s}}}else h=Dy(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Oy(o,i),h=bd(e,"where",o,"in"===i||"not-in"===i);var h=oo.create(r,i,h);return function(t,e){if(e.Ct()){var n=qo(t);if(null!==n&&!n.isEqual(e.field))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=Fo(t))&&ky(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.ed,this.nd,this.sd);return new Op(t.firestore,t.v_,(e=(t=t.C_).filters.concat([e]),new Ro(t.path,t.collectionGroup,t.xt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Sy),by=(h(Ay,vy=me),Ay.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Po(e,n);return e=r,null!==Fo(n=t)||null!==(t=qo(n))&&ky(0,t,e.field),r}(t.C_,this.ed,this.rd);return new Op(t.firestore,t.v_,(e=(t=t.C_).xt.concat([e]),new Ro(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},Ay),wy=(h(Ny,yy=me),Ny.prototype.td=function(t){return new Op(t.firestore,t.v_,Ho(t.C_,this.od,this.ad))},Ny),_y=(h(Ty,dy=me),Ty.prototype.td=function(t){var e=xy(t,this.type,this.ud,this.hd);return new Op(t.firestore,t.v_,(t=t.C_,new Ro(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},Ty),Ey=(h(Iy,py=me),Iy.prototype.td=function(t){var e=xy(t,this.type,this.ud,this.hd);return new Op(t.firestore,t.v_,(t=t.C_,new Ro(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},Iy);function Iy(t,e,n){var r=this;return(r=py.call(this)||this).type=t,r.ud=e,r.hd=n,r}function Ty(t,e,n){var r=this;return(r=dy.call(this)||this).type=t,r.ud=e,r.hd=n,r}function Ny(t,e,n){var r=this;return(r=yy.call(this)||this).type=t,r.od=e,r.ad=n,r}function Ay(t,e){var n=this;return(n=vy.call(this)||this).ed=t,n.rd=e,n.type="orderBy",n}function Sy(t,e,n){var r=this;return(r=gy.call(this)||this).ed=t,r.nd=e,r.sd=n,r.type="where",r}function xy(t,c,e,n){if(e[0]instanceof pp&&(e[0]=e[0].d_),e[0]instanceof oy)return function(t,e,n,r){if(!n)throw new Mr(Vr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+c+"().");for(var i=[],o=0,s=Go(t);o<s.length;o++){var u=s[o];if(u.field.ut())i.push(Li(e,n.key));else{var a=n.field(u.field);if(Ii(a))throw new Mr(Vr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+u.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===a)throw u=u.field.rt(),new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.");i.push(a)}}return new Ao(i,r)}(t.C_,t.firestore.I_,e[0].Zf,n);var r=$p(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new Mr(Vr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!Bo(t)&&-1!==c.indexOf("/"))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(ii.ot(c));if(!ui.wt(h))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ui(h),u.push(Li(e,h))}else c=bd(n,r,c),u.push(c)}return new Ao(u,o)}(t.C_,t.firestore.I_,r,c,e,n)}function Dy(t,e,n){if("string"==typeof(n=n instanceof pp?n.d_:n)){if(""===n)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Bo(e)&&-1!==n.indexOf("/"))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(ii.ot(n)),!ui.wt(e))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Li(t,new ui(e))}if(n instanceof Dp)return Li(t,n.S_);throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ep(n)+".")}function Oy(t,e){if(!Array.isArray(t)||0===t.length)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function ky(t,e,n){if(!n.isEqual(e))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Py(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var Cy,Ly,Ry,Vy=(h(Hy,Ry=o),Hy.prototype.Wf=function(t){return new Ur(t)},Hy.prototype.jf=function(t){return t=this.Jf(t,this.firestore.I_),new Dp(this.firestore,null,t)},Hy),My=(zy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},zy),Uy=(h(Gy,Ly=oy),Gy.prototype.exists=function(){return Ly.prototype.exists.call(this)},Gy.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new jy(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},Gy.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf&&null!==(t=this.Zf.data().field(hy("DocumentSnapshot.get",t))))return this.Xf.Uf(t,e.serverTimestamps)},Gy),jy=(h(By,Cy=Uy),By.prototype.data=function(t){return void 0===t&&(t={}),Cy.prototype.data.call(this,t)},By),Fy=(Object.defineProperty(qy.prototype,"docs",{get:function(){var e=[];return this.forEach(function(t){return e.push(t)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(qy.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(qy.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),qy.prototype.forEach=function(e,n){var r=this;this._d.docs.forEach(function(t){e.call(n,new jy(r.Yf,r.Xf,t.key,t,new My(r._d.De.has(t.key),r._d.fromCache),r.query.v_))})},qy.prototype.docChanges=function(t){if((t=!!(t=void 0===t?{}:t).includeMetadataChanges)&&this._d.xe)throw new Mr(Vr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===t||(this.fd=function(i,e){if(i._d.Se.et()){var n=0;return i._d.docChanges.map(function(t){var e=new jy(i.Yf,i.Xf,t.doc.key,t.doc,new My(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_);return t.doc,{type:"added",doc:e,oldIndex:-1,newIndex:n++}})}var o=i._d.Se;return i._d.docChanges.filter(function(t){return e||3!==t.type}).map(function(t){var e=new jy(i.Yf,i.Xf,t.doc.key,t.doc,new My(i._d.De.has(t.doc.key),i._d.fromCache),i.query.v_),n=-1,r=-1;return 0!==t.type&&(n=o.indexOf(t.doc.key),o=o.delete(t.doc.key)),1!==t.type&&(r=(o=o.add(t.doc)).indexOf(t.doc.key)),{type:function(){switch(t.type){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ar()}}(),doc:e,oldIndex:n,newIndex:r}})}(this,t),this.dd=t),this.fd},qy);function qy(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new My(r.hasPendingWrites,r.fromCache),this.query=n}function By(){return null!==Cy&&Cy.apply(this,arguments)||this}function Gy(t,e,n,r,i,o){var s=this;return(s=Ly.call(this,t,e,n,r,o)||this).Yf=t,s.ld=t,s.metadata=i,s}function zy(t,e){this.hasPendingWrites=t,this.fromCache=e}function Hy(t){var e=this;return(e=Ry.call(this)||this).firestore=t,e}function Qy(t,e){return t instanceof Uy&&e instanceof Uy?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Fy&&e instanceof Fy&&t.Yf===e.Yf&&Fp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var Yy,Ky=(h(Xy,Yy=o),Xy.prototype.Wf=function(t){return new Ur(t)},Xy.prototype.jf=function(t){return t=this.Jf(t,this.firestore.I_),new Dp(this.firestore,null,t)},Xy);function Xy(t){var e=this;return(e=Yy.call(this)||this).firestore=t,e}function Wy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];t=Ip(t,Dp);var o=Ip(t.firestore,Jd),s=$p(o);return Zy(o,[("string"==typeof(e=e instanceof pp?e.d_:e)||e instanceof fp?md(s,"updateDoc",t.S_,e,n,r):gd(s,"updateDoc",t.S_,e)).F_(t.S_,_s.exists(!0))])}function Jy(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];e instanceof pp&&(e=e.d_);var r={includeMetadataChanges:!1},i=0;"object"!=typeof n[i]||Kd(n[i])||(r=n[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Kd(n[i])&&(o=n[i],n[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),n[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),n[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),e instanceof Dp?(u=Ip(e.firestore,Jd),a=Mo(e.S_.path),h={next:function(t){n[i]&&n[i]($y(u,e,t))},error:n[i+1],complete:n[i+2]}):(s=Ip(e,Op),u=Ip(s.firestore,Jd),a=s.C_,c=new Ky(u),h={next:function(t){n[i]&&n[i](new Fy(u,c,s,t))},error:n[i+1],complete:n[i+2]},fy(e.C_)),function(n,t,e){var r=this,i=new cp(h),o=new ml(t,i,e);return n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=yl,[4,Gd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})}),function(){i.i_(),n._s.Ps(function(){return y(r,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=vl,[4,Gd(n)];case 1:return[2,e.apply(void 0,[t.sent(),o])]}})})})}}(ty(u),a,f)}function Zy(t,e){return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Vl,[4,Bd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(ty(t),e)}function $y(t,e,n){var r=n.docs.get(e.S_),i=new Ky(t);return new Uy(t,i,e.S_,r,new My(n.hasPendingWrites,n.fromCache),e.v_)}var tv=(ev.prototype.set=function(t,e,n){return this.md(),e=Py((t=nv(t,this.Yf)).v_,e,n),n=td(this.Id,"WriteBatch.set",t.S_,e,null!==t.v_,n),this.Ed.push(n.F_(t.S_,_s.Kt())),this},ev.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.md(),t=nv(t,this.Yf),e="string"==typeof(e=e instanceof pp?e.d_:e)||e instanceof fp?md(this.Id,"WriteBatch.update",t.S_,e,n,r):gd(this.Id,"WriteBatch.update",t.S_,e),this.Ed.push(e.F_(t.S_,_s.exists(!0))),this},ev.prototype.delete=function(t){return this.md(),t=nv(t,this.Yf),this.Ed=this.Ed.concat(new qs(t.S_,_s.Kt())),this},ev.prototype.commit=function(){return this.md(),this.Td=!0,0<this.Ed.length?this.wd(this.Ed):Promise.resolve()},ev.prototype.md=function(){if(this.Td)throw new Mr(Vr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},ev);function ev(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=$p(t)}function nv(t,e){if((t=t instanceof pp?t.d_:t).firestore!==e)throw new Mr(Vr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var rv,iv=(sv.prototype.get=function(t){var e=this,n=nv(t,this.Yf),r=new Vy(this.Yf);return this.Ad.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Ar();if((t=t[0])instanceof Ki)return new oy(e.Yf,r,n.S_,null,n.v_);if(t instanceof Yi)return new oy(e.Yf,r,t.key,t,n.v_);throw Ar()})},sv.prototype.set=function(t,e,n){return e=Py((t=nv(t,this.Yf)).v_,e,n),n=td(this.Id,"Transaction.set",t.S_,e,null!==t.v_,n),this.Ad.set(t.S_,n),this},sv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=nv(t,this.Yf),e="string"==typeof(e=e instanceof pp?e.d_:e)||e instanceof fp?md(this.Id,"Transaction.update",t.S_,e,n,r):gd(this.Id,"Transaction.update",t.S_,e),this.Ad.update(t.S_,e),this},sv.prototype.delete=function(t){return t=nv(t,this.Yf),this.Ad.delete(t.S_),this},h(ov,rv=sv),ov.prototype.get=function(t){var e=this,n=nv(t,this.Yf),r=new Ky(this.Yf);return rv.prototype.get.call(this,t).then(function(t){return new Uy(e.Yf,r,n.S_,t.Zf,new My(!1,!1),n.v_)})},ov);function ov(t,e){var n=this;return(n=rv.call(this,t,e)||this).Yf=t,n}function sv(t,e){this.Yf=t,this.Ad=e,this.Id=$p(t)}function uv(){if("undefined"==typeof Uint8Array)throw new Mr(Vr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function av(){if("undefined"==typeof atob)throw new Mr(Vr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var cv,hv,fv,lv=(h(bv,fv=pp),bv.fromBase64String=function(t){return av(),new bv(Ur.fromBase64String(t))},bv.fromUint8Array=function(t){return uv(),new bv(Ur.fromUint8Array(t))},bv.prototype.toBase64=function(){return av(),this.d_.toBase64()},bv.prototype.toUint8Array=function(){return uv(),this.d_.toUint8Array()},bv.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},bv.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},bv),pv=(mv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){ry(t=Ip(t,Jd));var n=ty(t),r=t.p_();return ny(n,t=new rp,new ep(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},mv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){ry(t=Ip(t,Jd));var e=ty(t),n=t.p_();return ny(e,t=new rp,new np(t,n.cacheSizeBytes))}(t.d_)},mv.prototype.clearIndexedDbPersistence=function(t){return function(n){var t=this;if(n.R_&&!n.P_)throw new Mr(Vr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var r=new na;return n.Bf.Tf(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return oa.Kn()?(e=n+"main",[4,oa.delete(e)]):[2,Promise.resolve()];case 1:return t.sent(),[2]}})})}(yh(n.I_,n.w_))];case 1:return t.sent(),r.resolve(),[3,3];case 2:return e=t.sent(),r.reject(e),[3,3];case 3:return[2]}})})}),r.promise}(t.d_)},mv),dv=(h(gv,hv=pp),Object.defineProperty(gv.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),gv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},gv.prototype.useEmulator=function(t,e){var n=this.d_,r=t;t=e,"firestore.googleapis.com"!==(e=(n=Ip(n,xp)).V_()).host&&e.host!==r&&Tr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},gv.prototype.enableNetwork=function(){return function(i){var t=this;return i._s.enqueue(function(){return y(t,void 0,void 0,function(){var n,r;return v(this,function(t){switch(t.label){case 0:return[4,jd(i)];case 1:return n=t.sent(),[4,qd(i)];case 2:return r=t.sent(),[2,(n.yo(!0),(e=r).Nh.delete(0),Xf(e))]}var e})})})}(ty(Ip(this.d_,Jd)))},gv.prototype.disableNetwork=function(){return function(r){var t=this;return r._s.enqueue(function(){return y(t,void 0,void 0,function(){var e,n;return v(this,function(t){switch(t.label){case 0:return[4,jd(r)];case 1:return e=t.sent(),[4,qd(r)];case 2:return n=t.sent(),[2,(e.yo(!1),function(n){return y(this,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return(e=n).Nh.add(0),[4,Wf(e)];case 1:return t.sent(),e.Oh.set("Offline"),[2]}})})}(n))]}})})})}(ty(Ip(this.d_,Jd)))},gv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&bp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},gv.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},gv.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},gv.prototype.waitForPendingWrites=function(){return function(n){var t=this,r=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=jl,[4,Bd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),r.promise}(ty(Ip(this.d_,Jd)))},gv.prototype.onSnapshotsInSync=function(t){return function(n,t){var e=this,r=new cp(t);return n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.add(e),e.next()},[4,Gd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})}),function(){r.i_(),n._s.Ps(function(){return y(e,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){t.Wh.delete(e)},[4,Gd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}}(ty(Ip(this.d_,Jd)),Kd(t)?t:{next:t})},Object.defineProperty(gv.prototype,"app",{get:function(){if(!this.Pd)throw new Mr(Vr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),gv.prototype.collection=function(t){try{return new Qv(this,Mp(this.d_,t))}catch(t){throw Pv(t,"collection()","Firestore.collection()")}},gv.prototype.doc=function(t){try{return new Ov(this,Up(this.d_,t))}catch(t){throw Pv(t,"doc()","Firestore.doc()")}},gv.prototype.collectionGroup=function(t){try{return new Gv(this,function(t,e){if(t=Ip(t,xp),gp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Mr(Vr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Op(t,null,new Ro(ii.ct(),e))}(this.d_,t))}catch(t){throw Pv(t,"collectionGroup()","Firestore.collectionGroup()")}},gv.prototype.runTransaction=function(e){var n,r=this;return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return[4,Ud(n).then(function(t){return t.Sh})];case 1:return e=t.sent(),new Od(n._s,e,r,i).run(),[2]}})})}),i.promise}(ty(n=this.d_),function(t){return t=new iv(n,t),e(new Iv(r,t))})},gv.prototype.batch=function(){var e=this;return ty(this.d_),new Tv(new tv(this.d_,function(t){return Zy(e.d_,t)}))},gv.prototype.loadBundle=function(t){throw new Mr(Vr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},gv.prototype.namedQuery=function(t){throw new Mr(Vr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},gv),yv=(h(vv,cv=o),vv.prototype.Wf=function(t){return new lv(new Ur(t))},vv.prototype.jf=function(t){return t=this.Jf(t,this.firestore.I_),Ov.yd(t,this.firestore,null)},vv);function vv(t){var e=this;return(e=cv.call(this)||this).firestore=t,e}function gv(t,e,n){var r=this;return(r=hv.call(this,e)||this).Rd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof mr||(r.Pd=t),r}function mv(){}function bv(){return null!==fv&&fv.apply(this,arguments)||this}var wv,_v,Ev,Iv=(h(xv,Ev=pp),xv.prototype.get=function(t){var e=this,n=$v(t);return this.d_.get(n).then(function(t){return new qv(e.Yf,new Uy(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))})},xv.prototype.set=function(t,e,n){return t=$v(t),n?(mp("Transaction.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},xv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=$v(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,f([o,e,n],r)),this},xv.prototype.delete=function(t){return t=$v(t),this.d_.delete(t),this},xv),Tv=(h(Sv,_v=pp),Sv.prototype.set=function(t,e,n){return t=$v(t),n?(mp("WriteBatch.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},Sv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=$v(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,f([o,e,n],r)),this},Sv.prototype.delete=function(t){return t=$v(t),this.d_.delete(t),this},Sv.prototype.commit=function(){return this.d_.commit()},Sv),Nv=(h(Av,wv=pp),Av.prototype.fromFirestore=function(t,e){return t=new jy(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null),this.d_.fromFirestore(new Bv(this.Yf,t),null!=e?e:{})},Av.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},Av.gd=function(t,e){var n=Av.Vd,r=n.get(t);return r||(r=new WeakMap,n.set(t,r)),(n=r.get(e))||(n=new Av(t,new yv(t),e),r.set(e,n)),n},Av);function Av(t,e,n){var r=this;return(r=wv.call(this,n)||this).Yf=t,r.Xf=e,r}function Sv(){return null!==_v&&_v.apply(this,arguments)||this}function xv(t,e){var n=this;return(n=Ev.call(this,e)||this).Yf=t,n.Xf=new yv(t),n}Nv.Vd=new WeakMap;var Dv,Ov=(h(kv,Dv=pp),kv.pd=function(t,e,n){if(t.length%2!=0)throw new Mr(Vr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new kv(e,new Dp(e.d_,n,new ui(t)))},kv.yd=function(t,e,n){return new kv(e,new Dp(e.d_,n,t))},Object.defineProperty(kv.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(kv.prototype,"parent",{get:function(){return new Qv(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(kv.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),kv.prototype.collection=function(t){try{return new Qv(this.firestore,Mp(this.d_,t))}catch(t){throw Pv(t,"collection()","DocumentReference.collection()")}},kv.prototype.isEqual=function(t){return(t=t instanceof pp?t.d_:t)instanceof Dp&&jp(this.d_,t)},kv.prototype.set=function(t,e){e=mp("DocumentReference.set",e);try{return function(t,e,n){t=Ip(t,Dp);var r=Ip(t.firestore,Jd),e=Py(t.v_,e,n);return Zy(r,[td($p(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,_s.Kt())])}(this.d_,t,e)}catch(t){throw Pv(t,"setDoc()","DocumentReference.set()")}},kv.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Wy(this.d_,t):Wy.apply(void 0,f([this.d_,t,e],n))}catch(t){throw Pv(t,"updateDoc()","DocumentReference.update()")}},kv.prototype.delete=function(){return Zy(Ip((t=this.d_).firestore,Jd),[new qs(t.S_,_s.Kt())]);var t},kv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Cv(t),i=Lv(t,function(t){return new qv(e.firestore,new Uy(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))});return Jy(this.d_,r,i)},kv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Ip(e,Dp);var n=Ip(e.firestore,Jd),t=ty(n),r=new Ky(n);return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(o,s,u){return y(this,void 0,void 0,function(){var r,i;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,(e=s,(n=o).persistence.runTransaction("read document","readonly",function(t){return n.Tc.Ho(t,e)}))];case 1:return(i=t.sent())instanceof Yi?u.resolve(i):i instanceof Ki?u.resolve(null):u.reject(new Mr(Vr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=t.sent(),i=_a(r,"Failed to get document '"+s+" from cache"),u.reject(i),[3,3];case 3:return[2]}var e,n})})},[4,Fd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.S_).then(function(t){return new Uy(n,r,e.S_,t,new My(t instanceof Yi&&t.Vt,!0),e.v_)})}:"server"===(null==t?void 0:t.source)?function(e){e=Ip(e,Dp);var n=Ip(e.firestore,Jd);return zd(ty(n),e.S_,{source:"server"}).then(function(t){return $y(n,e,t)})}:function(e){e=Ip(e,Dp);var n=Ip(e.firestore,Jd);return zd(ty(n),e.S_).then(function(t){return $y(n,e,t)})})(this.d_).then(function(t){return new qv(e.firestore,new Uy(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))})},kv.prototype.withConverter=function(t){return new kv(this.firestore,this.d_.withConverter(Nv.gd(this.firestore,t)))},kv);function kv(t,e){var n=this;return(n=Dv.call(this,e)||this).firestore=t,n.Xf=new yv(t),n}function Pv(t,e,n){return t.message=t.message.replace(e,n),t}function Cv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Kd(r))return r}return{}}function Lv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Kd(t[0])?t[0]:Kd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Rv,Vv,Mv,Uv,jv,Fv,qv=(h(Zv,Fv=pp),Object.defineProperty(Zv.prototype,"ref",{get:function(){return new Ov(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Zv.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Zv.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Zv.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),Zv.prototype.data=function(t){return this.d_.data(t)},Zv.prototype.get=function(t,e){return this.d_.get(t,e)},Zv.prototype.isEqual=function(t){return Qy(this.d_,t.d_)},Zv),Bv=(h(Jv,jv=qv),Jv.prototype.data=function(t){return this.d_.data(t)},Jv),Gv=(h(Wv,Uv=pp),Wv.prototype.where=function(t,e,n){try{return new Wv(this.firestore,ly(this.d_,(r=n,i=e,o=hy("where",t),new my(o,i,r))))}catch(t){throw Pv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Wv.prototype.orderBy=function(t,e){try{return new Wv(this.firestore,ly(this.d_,(n=void 0===e?"asc":e,r=hy("orderBy",t),new by(r,n))))}catch(t){throw Pv(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},Wv.prototype.limit=function(t){try{return new Wv(this.firestore,ly(this.d_,(Tp("limit",e=t),new wy("limit",e,"F"))))}catch(t){throw Pv(t,"limit()","Query.limit()")}var e},Wv.prototype.limitToLast=function(t){try{return new Wv(this.firestore,ly(this.d_,(Tp("limitToLast",e=t),new wy("limitToLast",e,"L"))))}catch(t){throw Pv(t,"limitToLast()","Query.limitToLast()")}var e},Wv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Wv(this.firestore,ly(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _y("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Pv(t,"startAt()","Query.startAt()")}},Wv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Wv(this.firestore,ly(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new _y("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Pv(t,"startAfter()","Query.startAfter()")}},Wv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Wv(this.firestore,ly(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ey("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Pv(t,"endBefore()","Query.endBefore()")}},Wv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Wv(this.firestore,ly(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Ey("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Pv(t,"endAt()","Query.endAt()")}},Wv.prototype.isEqual=function(t){return Fp(this.d_,t.d_)},Wv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(e){e=Ip(e,Op);var n=Ip(e.firestore,Jd),t=ty(n),r=new Ky(n);return function(n,r){var t=this,i=new na;return n._s.Ps(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(i,o,s){return y(this,void 0,void 0,function(){var e,n,r;return v(this,function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,kh(i,o,!0)];case 1:return r=t.sent(),e=new Dl(o,r.Rc),n=e.fl(r.documents),n=e.wi(n,!1),s.resolve(n.snapshot),[3,3];case 2:return n=t.sent(),r=_a(n,"Failed to execute query '"+o+" against cache"),s.reject(r),[3,3];case 3:return[2]}})})},[4,Fd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r,i])]}})})}),i.promise}(t,e.C_).then(function(t){return new Fy(n,r,e,t)})}:"server"===(null==t?void 0:t.source)?function(e){e=Ip(e,Op);var n=Ip(e.firestore,Jd),t=ty(n),r=new Ky(n);return Hd(t,e.C_,{source:"server"}).then(function(t){return new Fy(n,r,e,t)})}:function(e){e=Ip(e,Op);var n=Ip(e.firestore,Jd),t=ty(n),r=new Ky(n);return fy(e.C_),Hd(t,e.C_).then(function(t){return new Fy(n,r,e,t)})})(this.d_).then(function(t){return new Hv(e.firestore,new Fy(e.firestore.d_,e.Xf,e.d_,t._d))})},Wv.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=Cv(t),i=Lv(t,function(t){return new Hv(e.firestore,new Fy(e.firestore.d_,e.Xf,e.d_,t._d))});return Jy(this.d_,r,i)},Wv.prototype.withConverter=function(t){return new Wv(this.firestore,this.d_.withConverter(Nv.gd(this.firestore,t)))},Wv),zv=(h(Xv,Mv=pp),Object.defineProperty(Xv.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(Xv.prototype,"doc",{get:function(){return new Bv(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(Xv.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(Xv.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),Xv),Hv=(h(Kv,Vv=pp),Object.defineProperty(Kv.prototype,"query",{get:function(){return new Gv(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Kv.prototype,"docs",{get:function(){var e=this;return this.d_.docs.map(function(t){return new Bv(e.Yf,t)})},enumerable:!1,configurable:!0}),Kv.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map(function(t){return new zv(e.Yf,t)})},Kv.prototype.forEach=function(e,n){var r=this;this.d_.forEach(function(t){e.call(n,new Bv(r.Yf,t))})},Kv.prototype.isEqual=function(t){return Qy(this.d_,t.d_)},Kv),Qv=(h(Yv,Rv=Gv),Object.defineProperty(Yv.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new Ov(this.firestore,t):null},enumerable:!1,configurable:!0}),Yv.prototype.doc=function(t){try{return new Ov(this.firestore,void 0===t?Up(this.d_):Up(this.d_,t))}catch(t){throw Pv(t,"doc()","CollectionReference.doc()")}},Yv.prototype.add=function(t){var e,n=this,r=this.d_,i=t;return t=Ip(r.firestore,Jd),e=Up(r),i=Py(r.v_,i),Zy(t,[td($p(r.firestore),"addDoc",e.S_,i,null!==r.v_,{}).F_(e.S_,_s.exists(!1))]).then(function(){return e}).then(function(t){return new Ov(n.firestore,t)})},Yv.prototype.isEqual=function(t){return jp(this.d_,t.d_)},Yv.prototype.withConverter=function(t){return new Yv(this.firestore,this.d_.withConverter(Nv.gd(this.firestore,t)))},Yv);function Yv(t,e){var n=this;return(n=Rv.call(this,t,e)||this).firestore=t,n.d_=e,n}function Kv(t,e){var n=this;return(n=Vv.call(this,e)||this).Yf=t,n}function Xv(t,e){var n=this;return(n=Mv.call(this,e)||this).Yf=t,n}function Wv(t,e){var n=this;return(n=Uv.call(this,e)||this).firestore=t,n.Xf=new yv(t),n}function Jv(){return null!==jv&&jv.apply(this,arguments)||this}function Zv(t,e){var n=this;return(n=Fv.call(this,e)||this).Yf=t,n}function $v(t){return Ip(t=t instanceof pp?t.d_:t,Dp)}var tg,eg,me=(h(rg,eg=pp),rg.documentId=function(){return new rg(si.ht().rt())},rg.prototype.isEqual=function(t){return(t=t instanceof pp?t.d_:t)instanceof fp&&this.d_.f_.isEqual(t.f_)},rg),o=(h(ng,tg=pp),ng.serverTimestamp=function(){var t=new cd("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new ng(t)},ng.delete=function(){var t=new nd("deleteField");return t._methodName="FieldValue.delete",new ng(t)},ng.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new hd("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new ng(n)},ng.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new fd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new ng(n)},ng.increment=function(t){return(t=new ld("increment",t))._methodName="FieldValue.increment",new ng(t)},ng.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},ng);function ng(){return null!==tg&&tg.apply(this,arguments)||this}function rg(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return eg.call(this,new(fp.bind.apply(fp,f([void 0],t))))||this}ig.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},ig.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},ig.prototype.setServiceProps=function(t){return this.serviceProps=t,this},ge=ig;function ig(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}o={Firestore:dv,GeoPoint:qp,Timestamp:ni,Blob:lv,Transaction:Iv,WriteBatch:Tv,DocumentReference:Ov,DocumentSnapshot:qv,Query:Gv,QueryDocumentSnapshot:Bv,QuerySnapshot:Hv,CollectionReference:Qv,FieldPath:me,FieldValue:o,setLogLevel:function(t){br.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(e=e.default).INTERNAL.registerComponent(new ge("firestore",function(t){var e=t.getProvider("app").getImmediate();return t=t.getProvider("auth-internal"),new dv(e,new Jd(e,t),new pv)},"PUBLIC").setServiceProps(Object.assign({},o))),e.registerVersion("@firebase/firestore","2.1.7"),dv.prototype.loadBundle=function(t){return e=this.d_,s=t,n=ty(e=Ip(e,Jd)),t=new Wd,function(n,t,r){var e,i=this,o=(e=s,t=Cf(t),e=function(t){if(t instanceof Uint8Array)return ap(t,void 0);if(t instanceof ArrayBuffer)return ap(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),new hp(e,t));n._s.Ps(function(){return y(i,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=Jl,[4,Bd(n)];case 1:return e.apply(void 0,[t.sent(),o,r]),[2]}})})})}(n,e.I_,t),t;var e,s,n},dv.prototype.namedQuery=function(t){var e=this,n=this.d_,t=t;return function(n,r){var t=this;return n._s.enqueue(function(){return y(t,void 0,void 0,function(){var e;return v(this,function(t){switch(t.label){case 0:return e=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.wo.Ms(t,e)})},[4,Fd(n)];case 1:return[2,e.apply(void 0,[t.sent(),r])]}})})})}(ty(n=Ip(n,Jd)),t).then(function(t){return t?new Op(n,null,t.query):null}).then(function(t){return t?new Gv(e,t):null})}}.apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});