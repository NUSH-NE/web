!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("@firebase/app")):"function"==typeof define&&define.amd?define(["@firebase/app"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).firebase)}(this,function(t){"use strict";try{(function(){var e,n=function(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}(t);function r(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function i(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(e<t.logLevel)){var o=(new Date).toISOString(),s=u[e];if(!s)throw new Error("Attempted to log a message with an invalid logType (value: "+e+")");console[s].apply(console,r(["["+o+"]  "+t.name+":"],n))}}(we=e=e||{})[we.DEBUG=0]="DEBUG",we[we.VERBOSE=1]="VERBOSE",we[we.INFO=2]="INFO",we[we.WARN=3]="WARN",we[we.ERROR=4]="ERROR",we[we.SILENT=5]="SILENT";var o={debug:e.DEBUG,verbose:e.VERBOSE,info:e.INFO,warn:e.WARN,error:e.ERROR,silent:e.SILENT},s=e.INFO,u=((_e={})[e.DEBUG]="log",_e[e.VERBOSE]="log",_e[e.INFO]="info",_e[e.WARN]="warn",_e[e.ERROR]="error",_e),a=(Object.defineProperty(c.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in e))throw new TypeError('Invalid value "'+t+'" assigned to `logLevel`');this._logLevel=t},enumerable:!1,configurable:!0}),c.prototype.setLogLevel=function(t){this._logLevel="string"==typeof t?o[t]:t},Object.defineProperty(c.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!=typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!1,configurable:!0}),Object.defineProperty(c.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(t){this._userLogHandler=t},enumerable:!1,configurable:!0}),c.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,r([this,e.DEBUG],t)),this._logHandler.apply(this,r([this,e.DEBUG],t))},c.prototype.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,r([this,e.VERBOSE],t)),this._logHandler.apply(this,r([this,e.VERBOSE],t))},c.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,r([this,e.INFO],t)),this._logHandler.apply(this,r([this,e.INFO],t))},c.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,r([this,e.WARN],t)),this._logHandler.apply(this,r([this,e.WARN],t))},c.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,r([this,e.ERROR],t)),this._logHandler.apply(this,r([this,e.ERROR],t))},c);function c(t){this.name=t,this._logLevel=s,this._logHandler=i,this._userLogHandler=null}var h=function(t,e){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function f(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}h(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function l(t,e,n,r){return new(n=n||Promise)(function(i,o){function s(t){try{a(r.next(t))}catch(t){o(t)}}function u(t){try{a(r.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):((e=t.value)instanceof n?e:new n(function(t){t(e)})).then(s,u)}a((r=r.apply(t,e||[])).next())})}function p(t,e){var n,r,i,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},s={next:u(0),throw:u(1),return:u(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function u(s){return function(u){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,(s=i?[2&s[0],i.value]:s)[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=0<(i=o.trys).length&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,u])}}}function d(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,u=o.length;s<u;s++,i++)r[i]=o[s];return r}function y(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}var v,g="FirebaseError",m=(f(b,v=Error),b);function b(t,e,n){return(e=v.call(this,e)||this).code=t,e.customData=n,e.name=g,Object.setPrototypeOf(e,b.prototype),Error.captureStackTrace&&Error.captureStackTrace(e,w.prototype.create),e}var w=(_.prototype.create=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r,i=e[0]||{},o=this.service+"/"+t;t=(t=this.errors[t])?(r=i,t.replace(E,function(t,e){var n=r[e];return null!=n?String(n):"<"+e+"?>"})):"Error",t=this.serviceName+": "+t+" ("+o+").";return new m(o,t,i)},_);function _(t,e,n){this.service=t,this.serviceName=e,this.errors=n}var E=/\{\$([^}]+)}/g,I=function(t,e){return(I=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function T(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return{value:(t=t&&r>=t.length?void 0:t)&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var N,A={},S=(Ae="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{})||self;function x(){}function D(t){var e=typeof t;return"array"==(e="object"!=e?e:t?Array.isArray(t)?"array":e:"null")||"object"==e&&"number"==typeof t.length}function O(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}var k="closure_uid_"+(1e9*Math.random()>>>0),P=0;function C(t,e,n){return t.call.apply(t.bind,arguments)}function L(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function R(t,e,n){return(R=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?C:L).apply(null,arguments)}function V(t){var e=Array.prototype.slice.call(arguments,1);return function(){var n=e.slice();return n.push.apply(n,arguments),t.apply(this,n)}}function M(){return Date.now()}function U(t,e){function n(){}n.prototype=e.prototype,t.X=e.prototype,t.prototype=new n,(t.prototype.constructor=t).Kb=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function j(){this.j=this.j,this.i=this.i}j.prototype.j=!1,j.prototype.ja=function(){var t;!this.j&&(this.j=!0,this.G(),0)&&(t=this,Object.prototype.hasOwnProperty.call(t,k)&&t[k]||(t[k]=++P))},j.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var F=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if("string"==typeof t)return"string"!=typeof e||1!=e.length?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},q=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i="string"==typeof t?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)};function B(){return Array.prototype.concat.apply([],arguments)}function G(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function z(t){return/^[\s\xa0]*$/.test(t)}var H,Q=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function Y(t,e){return-1!=t.indexOf(e)}function K(t,e){return t<e?-1:e<t?1:0}var X=S.navigator;function W(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function J(t){var e,n={};for(e in t)n[e]=t[e];return n}H=X&&(X=X.userAgent)?X:"";var Z="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function $(t){for(var e,n,r=1;r<arguments.length;r++){for(e in n=arguments[r])t[e]=n[e];for(var i=0;i<Z.length;i++)e=Z[i],Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e])}}function tt(t){return tt[" "](t),t}tt[" "]=x;var et,nt=Y(H,"Opera"),rt=Y(H,"Trident")||Y(H,"MSIE"),it=Y(H,"Edge"),ot=it||rt,st=Y(H,"Gecko")&&!(Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge"))&&!(Y(H,"Trident")||Y(H,"MSIE"))&&!Y(H,"Edge"),ut=Y(H.toLowerCase(),"webkit")&&!Y(H,"Edge");function at(){var t=S.document;return t?t.documentMode:void 0}var ct="",ht=(ht=H,st?/rv:([^\);]+)(\)|;)/.exec(ht):it?/Edge\/([\d\.]+)/.exec(ht):rt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(ht):ut?/WebKit\/(\S+)/.exec(ht):nt?/(?:Version)[ \/]?(\S+)/.exec(ht):void 0);ht&&(ct=ht?ht[1]:""),et=rt&&null!=(ht=at())&&ht>parseFloat(ct)?String(ht):ct;var ft={};function lt(t){return e=t,n=function(){for(var e=0,n=Q(String(et)).split("."),r=Q(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++)for(var s=n[o]||"",u=r[o]||"";s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],(0!=s[0].length||0!=u[0].length)&&(e=K(0==s[1].length?0:parseInt(s[1],10),0==u[1].length?0:parseInt(u[1],10))||K(0==s[2].length,0==u[2].length)||K(s[2],u[2]),s=s[3],u=u[3],0==e););return 0<=e},r=ft,Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=n();var e,n,r}var pt=S.document&&rt&&(at()||parseInt(et,10))||void 0,dt=!rt||9<=Number(pt),yt=rt&&!lt("9"),vt=function(){if(!S.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{S.addEventListener("test",x,e),S.removeEventListener("test",x,e)}catch(t){}return t}();function gt(t,e){this.type=t,this.a=this.target=e,this.defaultPrevented=!1}function mt(t,e){if(gt.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(st){t:{try{tt(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType="string"==typeof t.pointerType?t.pointerType:bt[t.pointerType]||"",(this.c=t).defaultPrevented&&this.b()}}gt.prototype.b=function(){this.defaultPrevented=!0},U(mt,gt);var bt={2:"touch",3:"pen",4:"mouse"};mt.prototype.b=function(){mt.X.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,yt)try{(t.ctrlKey||112<=t.keyCode&&t.keyCode<=123)&&(t.keyCode=-1)}catch(t){}};var wt="closure_listenable_"+(1e6*Math.random()|0),_t=0;function Et(t){t.Y=!0,t.listener=null,t.proxy=null,t.src=null,t.ca=null}function It(t){this.src=t,this.a={},this.b=0}function Tt(t,e){var n,r,i,o=e.type;o in t.a&&(n=t.a[o],(i=0<=(r=F(n,e)))&&Array.prototype.splice.call(n,r,1),i&&(Et(e),0==t.a[o].length&&(delete t.a[o],t.b--)))}function Nt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Y&&o.listener==e&&o.capture==!!n&&o.ca==r)return i}return-1}It.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var s=Nt(t,e,r,i);return-1<s?(e=t[s],n||(e.Z=!1)):((e=new function(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ca=i,this.key=++_t,this.Y=this.Z=!1}(e,this.src,o,!!r,i)).Z=n,t.push(e)),e};var At="closure_lm_"+(1e6*Math.random()|0),St={};function xt(t,e,n,r,i){if(r&&r.once)return function t(e,n,r,i,o){if(Array.isArray(n)){for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);return null}return r=Vt(r),e&&e[wt]?e.wa(n,r,O(i)?!!i.capture:!!i,o):Dt(e,n,r,!0,i,o)}(t,e,n,r,i);if(Array.isArray(e)){for(var o=0;o<e.length;o++)xt(t,e[o],n,r,i);return null}return n=Vt(n),t&&t[wt]?t.va(e,n,O(r)?!!r.capture:!!r,i):Dt(t,e,n,!1,r,i)}function Dt(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var s=O(i)?!!i.capture:!!i;if(s&&!dt)return null;var u,a,c=Lt(t);if(c||(t[At]=c=new It(t)),(n=c.add(e,n,r,s,o)).proxy)return n;if(u=Ct,r=a=dt?function(t){return u.call(a.src,a.listener,t)}:function(t){if(!(t=u.call(a.src,a.listener,t)))return t},(n.proxy=r).src=t,r.listener=n,t.addEventListener)void 0===(i=vt?i:s)&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(kt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return n}function Ot(t){var e,n,r;"number"!=typeof t&&t&&!t.Y&&((e=t.src)&&e[wt]?Tt(e.c,t):(n=t.type,r=t.proxy,e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(kt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=Lt(e))?(Tt(n,t),0==n.b&&(n.src=null,e[At]=null)):Et(t)))}function kt(t){return t in St?St[t]:St[t]="on"+t}function Pt(t,e){var n=t.listener,r=t.ca||t.src;return t.Z&&Ot(t),n.call(r,e)}function Ct(t,e){if(t.Y)return!0;if(dt)return Pt(t,new mt(e,this));if(!e)t:{e=["window","event"];for(var n=S,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}return Pt(t,e=new mt(e,this))}function Lt(t){return(t=t[At])instanceof It?t:null}var Rt="__closure_events_fn_"+(1e9*Math.random()>>>0);function Vt(t){return"function"==typeof t?t:(t[Rt]||(t[Rt]=function(e){return t.handleEvent(e)}),t[Rt])}function Mt(){j.call(this),this.c=new It(this),(this.J=this).C=null}function Ut(t,e){var n,r=t.C;if(r)for(n=[];r;r=r.C)n.push(r);if(t=t.J,r=e.type||e,"string"==typeof e?e=new gt(e,t):e instanceof gt?e.target=e.target||t:(s=e,$(e=new gt(r,t),s)),s=!0,n)for(var i=n.length-1;0<=i;i--)var o=e.a=n[i],s=jt(o,r,!0,e)&&s;if(s=jt(o=e.a=t,r,!0,e)&&s,s=jt(o,r,!1,e)&&s,n)for(i=0;i<n.length;i++)s=jt(o=e.a=n[i],r,!1,e)&&s}function jt(t,e,n,r){if(!(e=t.c.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var s,u,a=e[o];a&&!a.Y&&a.capture==n&&(s=a.listener,u=a.ca||a.src,a.Z&&Tt(t.c,a),i=!1!==s.call(u,r)&&i)}return i&&!r.defaultPrevented}U(Mt,j),Mt.prototype[wt]=!0,(N=Mt.prototype).addEventListener=function(t,e,n,r){xt(this,t,e,n,r)},N.removeEventListener=function(t,e,n,r){!function t(e,n,r,i,o){if(Array.isArray(n))for(var s=0;s<n.length;s++)t(e,n[s],r,i,o);else i=O(i)?!!i.capture:!!i,r=Vt(r),e&&e[wt]?(e=e.c,(n=String(n).toString())in e.a&&-1<(r=Nt(s=e.a[n],r,i,o))&&(Et(s[r]),Array.prototype.splice.call(s,r,1),0==s.length&&(delete e.a[n],e.b--))):(e=e&&Lt(e))&&(n=e.a[n.toString()],(r=(e=-1)<(e=n?Nt(n,r,i,o):e)?n[e]:null)&&Ot(r))}(this,t,e,n,r)},N.G=function(){if(Mt.X.G.call(this),this.c){var t,e=this.c;for(t in e.a){for(var n=e.a[t],r=0;r<n.length;r++)Et(n[r]);delete e.a[t],e.b--}}this.C=null},N.va=function(t,e,n,r){return this.c.add(String(t),e,!1,n,r)},N.wa=function(t,e,n,r){return this.c.add(String(t),e,!0,n,r)};var Ft=S.JSON.stringify;function qt(){this.b=this.a=null}var Bt,Gt=(zt.prototype.get=function(){var t;return 0<this.b?(this.b--,t=this.a,this.a=t.next,t.next=null):t=this.c(),t},new zt(function(){return new Ht},function(t){t.reset()}));function zt(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Ht(){this.next=this.b=this.a=null}function Qt(t,e){var n;Bt||(n=S.Promise.resolve(void 0),Bt=function(){n.then(Xt)}),Yt||(Bt(),Yt=!0),Kt.add(t,e)}qt.prototype.add=function(t,e){var n=Gt.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Ht.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null};var Yt=!(Ht.prototype.reset=function(){this.next=this.b=this.a=null}),Kt=new qt;function Xt(){for(var t,e;n=e=void 0,n=null,(e=Kt).a&&(n=e.a,e.a=e.a.next,e.a||(e.b=null),n.next=null),t=n;){try{t.a.call(t.b)}catch(t){!function(t){S.setTimeout(function(){throw t},0)}(t)}var n=Gt;n.f(t),n.b<100&&(n.b++,t.next=n.a,n.a=t)}Yt=!1}function Wt(t,e){Mt.call(this),this.b=t||1,this.a=e||S,this.f=R(this.Za,this),this.g=M()}function Jt(t){t.aa=!1,t.M&&(t.a.clearTimeout(t.M),t.M=null)}function Zt(t,e,n){if("function"==typeof t)n&&(t=R(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=R(t.handleEvent,t)}return 2147483647<Number(e)?-1:S.setTimeout(t,e||0)}U(Wt,Mt),(N=Wt.prototype).aa=!1,N.M=null,N.Za=function(){var t;this.aa&&(0<(t=M()-this.g)&&t<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-t):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Ut(this,"tick"),this.aa&&(Jt(this),this.start())))},N.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=M())},N.G=function(){Wt.X.G.call(this),Jt(this),delete this.a};var $t,te,ee,ne=(I(te=ie,ee=$t=j),te.prototype=null===ee?Object.create(ee):(re.prototype=ee.prototype,new re),ie.prototype.f=function(t){this.b=arguments,this.a?this.c=!0:function t(e){e.a=Zt(function(){e.a=null,e.c&&(e.c=!1,t(e))},e.h);var n=e.b;e.b=null,e.g.apply(null,n)}(this)},ie.prototype.G=function(){$t.prototype.G.call(this),this.a&&(S.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},ie);function re(){this.constructor=te}function ie(t,e){var n=$t.call(this)||this;return n.g=t,n.h=e,n.b=null,n.c=!1,n.a=null,n}function oe(t){j.call(this),this.b=t,this.a={}}U(oe,j);var se=[];function ue(t,e,n,r){Array.isArray(n)||(n&&(se[0]=n.toString()),n=se);for(var i=0;i<n.length;i++){var o=xt(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ae(t){W(t.a,function(t,e){this.a.hasOwnProperty(e)&&Ot(t)},t),t.a={}}function ce(){this.a=!0}function he(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+function(t,e){if(!t.a)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(r.length<2)){var i=r[1];if(Array.isArray(i)&&!(i.length<1)&&"noop"!=(r=i[0])&&"stop"!=r&&"close"!=r)for(var o=1;o<i.length;o++)i[o]=""}}return Ft(n)}catch(t){return e}}(t,n)+(r?" "+r:"")})}oe.prototype.G=function(){oe.X.G.call(this),ae(this)},oe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},ce.prototype.info=function(){};var fe={},le=null;function pe(){return le=le||new Mt}function de(t){gt.call(this,fe.Fa,t)}function ye(t){var e=pe();Ut(e,new de(e))}function ve(t,e){gt.call(this,fe.STAT_EVENT,t),this.stat=e}function ge(t){var e=pe();Ut(e,new ve(e,t))}function me(t){gt.call(this,fe.Ga,t)}function be(t,e){if("function"!=typeof t)throw Error("Fn must not be null and must be a function");return S.setTimeout(function(){t()},e)}fe.Fa="serverreachability",U(de,gt),fe.STAT_EVENT="statevent",U(ve,gt),fe.Ga="timingevent",U(me,gt);var we={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},_e={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function Ee(){}function Ie(t){var e;return(e=t.a)?e:t.a={}}function Te(){}Ee.prototype.a=null;var Ne,Ae={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function Se(){gt.call(this,"d")}function xe(){gt.call(this,"c")}function De(){}function Oe(t,e,n,r){this.g=t,this.c=e,this.f=n,this.S=r||1,this.J=new oe(this),this.P=ke,t=ot?125:void 0,this.R=new Wt(t),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}U(Se,gt),U(xe,gt),U(De,Ee),Ne=new De;var ke=45e3,Pe={},Ce={};function Le(t,e,n){t.H=1,t.i=en(Xe(e)),t.j=n,t.I=!0,Re(t,null)}function Re(t,e){t.u=M(),Me(t),t.l=Xe(t.i);var n,r,i,o,s,u,a=t.l,c=t.S;Array.isArray(c)||(c=[String(c)]),yn(a.b,"t",c),t.D=0,t.a=ur(t.g,t.g.C?e:null),0<t.O&&(t.F=new ne(R(t.Ca,t,t.a),t.O)),ue(t.J,t.a,"readystatechange",t.Xa),e=t.B?J(t.B):{},t.j?(t.m||(t.m="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.a.ba(t.l,t.m,t.j,e)):(t.m="GET",t.a.ba(t.l,t.m,null,e)),ye(),n=t.c,r=t.m,i=t.l,o=t.f,s=t.S,u=t.j,n.info(function(){if(n.a)if(u)for(var t="",e=u.split("&"),a=0;a<e.length;a++){var c,h,f=e[a].split("=");1<f.length&&(c=f[0],f=f[1],t=2<=(h=c.split("_")).length&&"type"==h[1]?t+(c+"=")+f+"&":t+(c+"=redacted&"))}else t=null;else t=u;return"XMLHTTP REQ ("+o+") [attempt "+s+"]: "+r+"\n"+i+"\n"+t})}function Ve(t,e,n){for(var r,i,o,s=!0;!t.A&&t.D<n.length;){var u=(u=n,o=i=void 0,i=(r=t).D,-1==(o=u.indexOf("\n",i))?Ce:(i=Number(u.substring(i,o)),isNaN(i)?Pe:(o+=1)+i>u.length?Ce:(u=u.substr(o,i),r.D=o+i,u)));if(u==Ce){4==e&&(t.h=4,ge(14),s=!1),he(t.c,t.f,null,"[Incomplete Response]");break}if(u==Pe){t.h=4,ge(15),he(t.c,t.f,n,"[Invalid Chunk]"),s=!1;break}he(t.c,t.f,u,null),Be(t,u)}4==e&&0==n.length&&(t.h=1,ge(16),s=!1),t.b=t.b&&s,s?0<n.length&&!t.V&&(t.V=!0,(e=t.g).a==t&&e.U&&!e.F&&(e.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),$n(e),e.F=!0,ge(11))):(he(t.c,t.f,n,"[Invalid Chunked Response]"),qe(t),Fe(t))}function Me(t){t.T=M()+t.P,Ue(t,t.P)}function Ue(t,e){if(null!=t.o)throw Error("WatchDog timer not null");t.o=be(R(t.Va,t),e)}function je(t){t.o&&(S.clearTimeout(t.o),t.o=null)}function Fe(t){0==t.g.v||t.A||nr(t.g,t)}function qe(t){je(t);var e=t.F;e&&"function"==typeof e.ja&&e.ja(),t.F=null,Jt(t.R),ae(t.J),t.a&&(e=t.a,t.a=null,e.abort(),e.ja())}function Be(t,e){try{var n,r,i,o,s,u=t.g;if(0!=u.v&&(u.a==t||En(u.b,t)))if(u.I=t.N,!t.C&&En(u.b,t)&&3==u.v){try{var a=u.ka.a.parse(e)}catch(t){a=null}if(Array.isArray(a)&&3==a.length){var c=a;if(0==c[0]){t:if(!u.j){if(u.a){if(!(u.a.u+3e3<t.u))break t;er(u),zn(u)}Zn(u),ge(18)}}else u.oa=c[1],0<u.oa-u.P&&c[2]<37500&&u.H&&0==u.o&&!u.m&&(u.m=be(R(u.Sa,u),6e3));if(_n(u.b)<=1&&u.ea){try{u.ea()}catch(t){}u.ea=void 0}}else ir(u,11)}else if(!t.C&&u.a!=t||er(u),!z(e))for(e=a=u.ka.a.parse(e),a=0;a<e.length;a++)c=e[a],u.P=c[0],c=c[1],2==u.v?"c"==c[0]?(u.J=c[1],u.ga=c[2],null!=(r=c[3])&&(u.ha=r,u.c.info("VER="+u.ha)),null!=(o=c[4])&&(u.pa=o,u.c.info("SVER="+u.pa)),null!=(r=c[5])&&"number"==typeof r&&0<r&&(n=1.5*r,u.D=n,u.c.info("backChannelRequestTimeoutMs_="+n)),n=u,(o=t.a)&&(!(r=o.a?o.a.getResponseHeader("X-Client-Wire-Protocol"):null)||!(i=n.b).a&&(Y(r,"spdy")||Y(r,"quic")||Y(r,"h2"))&&(i.f=i.g,i.a=new Set,i.b&&(In(i,i.b),i.b=null)),!n.A||(s=o.a?o.a.getResponseHeader("X-HTTP-Session-Id"):null)&&(n.na=s,tn(n.B,n.A,s))),u.v=3,u.f&&u.f.ta(),u.U&&(u.N=M()-t.u,u.c.info("Handshake RTT: "+u.N+"ms")),i=t,(n=u).la=sr(n,n.C?n.ga:null,n.fa),i.C?(Tn(n.b,i),o=i,(s=n.D)&&o.setTimeout(s),o.o&&(je(o),Me(o)),n.a=i):Jn(n),0<u.g.length&&Yn(u)):"stop"!=c[0]&&"close"!=c[0]||ir(u,7):3==u.v&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?ir(u,7):Gn(u):"noop"!=c[0]&&u.f&&u.f.sa(c),u.o=0);ye()}catch(t){}}function Ge(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(D(t)||"string"==typeof t)q(t,e,void 0);else{if(t.L&&"function"==typeof t.L)var n=t.L();else if(t.K&&"function"==typeof t.K)n=void 0;else if(D(t)||"string"==typeof t){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,t)n[r++]=i;i=(r=function(t){if(t.K&&"function"==typeof t.K)return t.K();if("string"==typeof t)return t.split("");if(D(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}for(r in e=[],n=0,t)e[n++]=t[r];return e}(t)).length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function ze(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof ze)for(n=t.L(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function He(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Qe(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)Qe(i,r=t.a[e])||(i[t.a[n++]=r]=1),e++;t.a.length=n}}function Qe(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(N=Oe.prototype).setTimeout=function(t){this.P=t},N.Xa=function(t){t=t.target;var e=this.F;e&&3==jn(t)?e.f():this.Ca(t)},N.Ca=function(t){try{if(t==this.a)t:{var e=jn(this.a),n=this.a.ua(),r=this.a.W();if(!(e<3||3==e&&!ot&&!this.a.$())){this.A||4!=e||7==n||ye(),je(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,r=this.c,a=this.m,c=this.l,h=this.f,f=this.S,l=e,p=i,r.info(function(){return"XMLHTTP RESP ("+h+") [ attempt "+f+"]: "+a+"\n"+c+"\n"+l+" "+p}),this.b){if(this.U&&!this.C){e:{if(this.a){var s=this.a;if((s=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!z(s)){var u=s;break e}}u=null}if(!u){this.b=!1,this.h=3,ge(12),qe(this),Fe(this);break t}he(this.c,this.f,u,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Be(this,u)}this.I?(Ve(this,e,o),ot&&this.b&&3==e&&(ue(this.J,this.R,"tick",this.Wa),this.R.start())):(he(this.c,this.f,o,null),Be(this,o)),4==e&&qe(this),this.b&&!this.A&&(4==e?nr(this.g,this):(this.b=!1,Me(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,ge(12)):(this.h=0,ge(13)),qe(this),Fe(this)}}}catch(t){}var a,c,h,f,l,p},N.Wa=function(){var t,e;this.a&&(t=jn(this.a),e=this.a.$(),this.D<e.length&&(je(this),Ve(this,t,e),this.b&&4!=t&&Me(this)))},N.cancel=function(){this.A=!0,qe(this)},N.Va=function(){this.o=null;var t,e,n=M();0<=n-this.T?(t=this.c,e=this.l,t.info(function(){return"TIMEOUT: "+e}),2!=this.H&&(ye(),ge(17)),qe(this),this.h=2,Fe(this)):Ue(this,this.T-n)},(N=ze.prototype).K=function(){He(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},N.L=function(){return He(this),this.a.concat()},N.get=function(t,e){return Qe(this.b,t)?this.b[t]:e},N.set=function(t,e){Qe(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},N.forEach=function(t,e){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var Ye=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ke(t,e){var n;this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,t instanceof Ke?(this.a=void 0!==e?e:t.a,We(this,t.f),this.j=t.j,Je(this,t.c),Ze(this,t.h),this.g=t.g,e=t.b,(n=new fn).c=e.c,e.a&&(n.a=new ze(e.a),n.b=e.b),$e(this,n),this.i=t.i):t&&(n=String(t).match(Ye))?(this.a=!!e,We(this,n[1]||"",!0),this.j=nn(n[2]||""),Je(this,n[3]||"",!0),Ze(this,n[4]),this.g=nn(n[5]||"",!0),$e(this,n[6]||"",!0),this.i=nn(n[7]||"")):(this.a=!!e,this.b=new fn(null,this.a))}function Xe(t){return new Ke(t)}function We(t,e,n){t.f=n?nn(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function Je(t,e,n){t.c=n?nn(e,!0):e}function Ze(t,e){if(e){if(e=Number(e),isNaN(e)||e<0)throw Error("Bad port number "+e);t.h=e}else t.h=null}function $e(t,e,n){var r,i;e instanceof fn?(t.b=e,r=t.b,(i=t.a)&&!r.f&&(ln(r),r.c=null,r.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(pn(this,e),yn(this,n,t))},r)),r.f=i):(n||(e=rn(e,cn)),t.b=new fn(e,t.a))}function tn(t,e,n){t.b.set(e,n)}function en(t){return tn(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^M()).toString(36)),t}function nn(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function rn(t,e,n){return"string"==typeof t?(t=encodeURI(t).replace(e,on),t=n?t.replace(/%25([0-9a-fA-F]{2})/g,"%$1"):t):null}function on(t){return"%"+((t=t.charCodeAt(0))>>4&15).toString(16)+(15&t).toString(16)}Ke.prototype.toString=function(){var t=[],e=this.f;e&&t.push(rn(e,sn,!0),":");var n=this.c;return!n&&"file"!=e||(t.push("//"),(e=this.j)&&t.push(rn(e,sn,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&t.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&t.push("/"),t.push(rn(n,"/"==n.charAt(0)?an:un,!0))),(n=this.b.toString())&&t.push("?",n),(n=this.i)&&t.push("#",rn(n,hn)),t.join("")};var sn=/[#\/\?@]/g,un=/[#\?:]/g,an=/[#\?]/g,cn=/[#\?@]/g,hn=/#/g;function fn(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ln(t){t.a||(t.a=new ze,t.b=0,t.c&&function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r,i=t[n].indexOf("="),o=null;0<=i?(r=t[n].substring(0,i),o=t[n].substring(i+1)):r=t[n],e(r,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function pn(t,e){ln(t),e=vn(t,e),Qe(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,Qe((t=t.a).b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&He(t)))}function dn(t,e){return ln(t),e=vn(t,e),Qe(t.a.b,e)}function yn(t,e,n){pn(t,e),0<n.length&&(t.c=null,t.a.set(vn(t,e),G(n)),t.b+=n.length)}function vn(t,e){return e=String(e),t.f?e.toLowerCase():e}(N=fn.prototype).add=function(t,e){ln(this),this.c=null,t=vn(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},N.forEach=function(t,e){ln(this),this.a.forEach(function(n,r){q(n,function(n){t.call(e,n,r,this)},this)},this)},N.L=function(){ln(this);for(var t=this.a.K(),e=this.a.L(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},N.K=function(t){ln(this);var e=[];if("string"==typeof t)dn(this,t)&&(e=B(e,this.a.get(vn(this,t))));else{t=this.a.K();for(var n=0;n<t.length;n++)e=B(e,t[n])}return e},N.set=function(t,e){return ln(this),this.c=null,dn(this,t=vn(this,t))&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},N.get=function(t,e){return t&&0<(t=this.K(t)).length?String(t[0]):e},N.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.L(),n=0;n<e.length;n++)for(var r=e[n],i=encodeURIComponent(String(r)),o=(r=this.K(r),0);o<r.length;o++){var s=i;""!==r[o]&&(s+="="+encodeURIComponent(String(r[o]))),t.push(s)}return this.c=t.join("&")};var gn=function(t,e){this.b=t,this.a=e};function mn(t){this.g=t||bn,t=S.PerformanceNavigationTiming?0<(t=S.performance.getEntriesByType("navigation")).length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol):!!(S.ia&&S.ia.ya&&S.ia.ya()&&S.ia.ya().Lb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var bn=10;function wn(t){return t.b||t.a&&t.a.size>=t.f}function _n(t){return t.b?1:t.a?t.a.size:0}function En(t,e){return t.b?t.b==e:t.a&&t.a.has(e)}function In(t,e){t.a?t.a.add(e):t.b=e}function Tn(t,e){t.b&&t.b==e?t.b=null:t.a&&t.a.has(e)&&t.a.delete(e)}function Nn(t){var e,n;if(null!=t.b)return t.c.concat(t.b.s);if(null==t.a||0===t.a.size)return G(t.c);var r=t.c;try{for(var i=T(t.a.values()),o=i.next();!o.done;o=i.next()){var s=o.value;r=r.concat(s.s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return r}function An(){}function Sn(t,e,n,r,i){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(t){}}mn.prototype.cancel=function(){var t,e;if(this.c=Nn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=T(this.a.values()),r=n.next();!r.done;r=n.next())r.value.cancel()}catch(e){t={error:e}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.a.clear()}},An.prototype.stringify=function(t){return S.JSON.stringify(t,void 0)},An.prototype.parse=function(t){return S.JSON.parse(t,void 0)};var xn=S.JSON.parse;function Dn(t){Mt.call(this),this.headers=new ze,this.H=t||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=On,this.D=this.F=!1}U(Dn,Mt);var On="",kn=/^https?$/i,Pn=["POST","PUT"];function Cn(t){return"content-type"==t.toLowerCase()}function Ln(t,e){t.b=!1,t.a&&(t.g=!0,t.a.abort(),t.g=!1),t.f=e,t.h=5,Rn(t),Mn(t)}function Rn(t){t.u||(t.u=!0,Ut(t,"complete"),Ut(t,"error"))}function Vn(t){if(t.b&&void 0!==A&&(!t.s[1]||4!=jn(t)||2!=t.W()))if(t.l&&4==jn(t))Zt(t.za,0,t);else if(Ut(t,"readystatechange"),4==jn(t)){t.b=!1;try{var e,n,r,i,o=t.W();t:switch(o){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var s=!0;break t;default:s=!1}if((e=s)||((n=0===o)&&(!(i=String(t.B).match(Ye)[1]||null)&&S.self&&S.self.location&&(i=(r=S.self.location.protocol).substr(0,r.length-1)),n=!kn.test(i?i.toLowerCase():"")),e=n),e)Ut(t,"complete"),Ut(t,"success");else{t.h=6;try{var u=2<jn(t)?t.a.statusText:""}catch(o){u=""}t.f=u+" ["+t.W()+"]",Rn(t)}}finally{Mn(t)}}}function Mn(t,e){if(t.a){Un(t);var n=t.a,r=t.s[0]?x:null;t.a=null,t.s=null,e||Ut(t,"ready");try{n.onreadystatechange=r}catch(t){}}}function Un(t){t.a&&t.D&&(t.a.ontimeout=null),t.m&&(S.clearTimeout(t.m),t.m=null)}function jn(t){return t.a?t.a.readyState:0}function Fn(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}var i;r||(i="",W(n,function(t,e){i+=e,i+=":",i+=t,i+="\r\n"}),n=i,"string"==typeof t?null!=n&&encodeURIComponent(String(n)):tn(t,e,n))}function qn(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function Bn(t){this.pa=0,this.g=[],this.c=new ce,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=qn("failFast",!1,t),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=qn("baseRetryDelayMs",5e3,t),this.Ra=qn("retryDelaySeedMs",1e4,t),this.Ma=qn("forwardChannelMaxRetries",2,t),this.ma=qn("forwardChannelRequestTimeoutMs",2e4,t),this.Na=t&&t.g||void 0,this.D=void 0,this.C=t&&t.supportsCrossDomainXhr||!1,this.J="",this.b=new mn(t&&t.concurrentRequestLimit),this.ka=new function(){this.a=new An},this.da=t&&t.fastHandshake||!1,this.Ia=t&&t.b||!1,t&&t.f&&(this.c.a=!1),t&&t.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&t&&t.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=t&&t.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Gn(t){var e,n;Hn(t),3==t.v&&(e=t.R++,tn(n=Xe(t.B),"SID",t.J),tn(n,"RID",e),tn(n,"TYPE","terminate"),Xn(t,n),(e=new Oe(t,t.c,e,void 0)).H=2,e.i=en(Xe(n)),n=!1,!(n=S.navigator&&S.navigator.sendBeacon?S.navigator.sendBeacon(e.i.toString(),""):n)&&S.Image&&((new Image).src=e.i,n=!0),n||(e.a=ur(e.g,null),e.a.ba(e.i)),e.u=M(),Me(e)),or(t)}function zn(t){t.a&&($n(t),t.a.cancel(),t.a=null)}function Hn(t){zn(t),t.j&&(S.clearTimeout(t.j),t.j=null),er(t),t.b.cancel(),t.h&&("number"==typeof t.h&&S.clearTimeout(t.h),t.h=null)}function Qn(t,e){t.g.push(new gn(t.Oa++,e)),3==t.v&&Yn(t)}function Yn(t){wn(t.b)||t.h||(t.h=!0,Qt(t.Ba,t),t.u=0)}function Kn(t,e){var n=e?e.f:t.R++,r=Xe(t.B);tn(r,"SID",t.J),tn(r,"RID",n),tn(r,"AID",t.P),Xn(t,r),t.i&&t.l&&Fn(r,t.i,t.l),n=new Oe(t,t.c,n,t.u+1),null===t.i&&(n.B=t.l),e&&(t.g=e.s.concat(t.g)),e=Wn(t,n,1e3),n.setTimeout(Math.round(.5*t.ma)+Math.round(.5*t.ma*Math.random())),In(t.b,n),Le(n,r,e)}function Xn(t,e){t.f&&Ge({},function(t,n){tn(e,n,t)})}function Wn(t,e,n){n=Math.min(t.g.length,n);var r=t.f?R(t.f.Ja,t.f,t):null;t:for(var i=t.g,o=-1;;){var s=["count="+n];-1==o?0<n?(o=i[0].b,s.push("ofs="+o)):o=0:s.push("ofs="+o);for(var u=!0,a=0;a<n;a++){var c=i[a].b,h=i[a].a;if((c-=o)<0)o=Math.max(0,i[a].b-100),u=!1;else try{!function(t,e){var n="req"+c+"_"||"";try{Ge(t,function(t,r){var i=t;O(t)&&(i=Ft(t)),e.push(n+r+"="+encodeURIComponent(i))})}catch(t){throw e.push(n+"type="+encodeURIComponent("_badmap")),t}}(h,s)}catch(t){r&&r(h)}}if(u){r=s.join("&");break t}}return t=t.g.splice(0,n),e.s=t,r}function Jn(t){t.a||t.j||(t.T=1,Qt(t.Aa,t),t.o=0)}function Zn(t){return!(t.a||t.j||3<=t.o)&&(t.T++,t.j=be(R(t.Aa,t),rr(t,t.o)),t.o++,1)}function $n(t){null!=t.s&&(S.clearTimeout(t.s),t.s=null)}function tr(t){t.a=new Oe(t,t.c,"rpc",t.T),null===t.i&&(t.a.B=t.l),t.a.O=0;var e=Xe(t.la);tn(e,"RID","rpc"),tn(e,"SID",t.J),tn(e,"CI",t.H?"0":"1"),tn(e,"AID",t.P),Xn(t,e),tn(e,"TYPE","xmlhttp"),t.i&&t.l&&Fn(e,t.i,t.l),t.D&&t.a.setTimeout(t.D);var n=t.a;t=t.ga,n.H=1,n.i=en(Xe(e)),n.j=null,n.I=!0,Re(n,t)}function er(t){null!=t.m&&(S.clearTimeout(t.m),t.m=null)}function nr(t,e){var n,r,i,o=null;if(t.a==e){er(t),$n(t),t.a=null;var s=2}else{if(!En(t.b,e))return;o=e.s,Tn(t.b,e),s=1}if(t.I=e.N,0!=t.v)if(e.b)1==s?(o=e.j?e.j.length:0,e=M()-e.u,n=t.u,Ut(s=pe(),new me(s)),Yn(t)):Jn(t);else if(3==(n=e.h)||0==n&&0<t.I||(1!=s||(i=e,_n((r=t).b)>=r.b.f-(r.h?1:0)||(r.h?(r.g=i.s.concat(r.g),0):1==r.v||2==r.v||r.u>=(r.La?0:r.Ma)||(r.h=be(R(r.Ba,r,i),rr(r,r.u)),r.u++,0))))&&(2!=s||!Zn(t)))switch(o&&0<o.length&&(e=t.b,e.c=e.c.concat(o)),n){case 1:ir(t,5);break;case 4:ir(t,10);break;case 3:ir(t,6);break;default:ir(t,2)}}function rr(t,e){var n=t.Ha+Math.floor(Math.random()*t.Ra);return t.f||(n*=2),n*e}function ir(t,e){var n,r,i,o;t.c.info("Error code "+e),2==e?(r=null,t.f&&(r=null),o=R(t.Ya,t),r||(r=new Ke("//www.google.com/images/cleardot.gif"),S.location&&"http"==S.location.protocol||We(r,"https"),en(r)),n=r.toString(),r=o,o=new ce,S.Image?((i=new Image).onload=V(Sn,o,i,"TestLoadImage: loaded",!0,r),i.onerror=V(Sn,o,i,"TestLoadImage: error",!1,r),i.onabort=V(Sn,o,i,"TestLoadImage: abort",!1,r),i.ontimeout=V(Sn,o,i,"TestLoadImage: timeout",!1,r),S.setTimeout(function(){i.ontimeout&&i.ontimeout()},1e4),i.src=n):r(!1)):ge(2),t.v=0,t.f&&t.f.ra(e),or(t),Hn(t)}function or(t){t.v=0,t.I=-1,t.f&&(0==Nn(t.b).length&&0==t.g.length||(t.b.c.length=0,G(t.g),t.g.length=0),t.f.qa())}function sr(t,e,n){var r,i,o,s,u,a=(s=n)instanceof Ke?Xe(s):new Ke(s,void 0);return""!=a.c?(e&&Je(a,e+"."+a.c),Ze(a,a.h)):(r=(u=S.location).protocol,i=e?e+"."+u.hostname:u.hostname,o=+u.port,s=n,u=new Ke(null,void 0),r&&We(u,r),i&&Je(u,i),o&&Ze(u,o),s&&(u.g=s),a=u),t.V&&W(t.V,function(t,e){tn(a,e,t)}),e=t.A,n=t.na,e&&n&&tn(a,e,n),tn(a,"VER",t.ha),Xn(t,a),a}function ur(t,e){if(e&&!t.C)throw Error("Can't create secondary domain capable XhrIo object.");return(e=new Dn(t.Na)).F=t.C,e}function ar(){}function cr(){if(rt&&!(10<=Number(pt)))throw Error("Environmental error: no available transport.")}function hr(t,e){Mt.call(this),this.a=new Bn(e),this.o=t,this.b=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.l=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.a&&(t?t["X-WebChannel-Client-Profile"]=e.a:t={"X-WebChannel-Client-Profile":e.a}),this.a.O=t,(t=e&&e.httpHeadersOverwriteParam)&&!z(t)&&(this.a.i=t),this.m=e&&e.supportsCrossDomainXhr||!1,this.l=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!z(e)&&(this.a.A=e,null!==(t=this.b)&&e in t&&e in(t=this.b)&&delete t[e]),this.f=new pr(this)}function fr(t){Se.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function lr(){xe.call(this),this.status=1}function pr(t){this.a=t}(N=Dn.prototype).ba=function(t,e,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?Ie(this.H):Ie(Ne),this.a.onreadystatechange=R(this.za,this);try{this.A=!0,this.a.open(e,String(t),!0),this.A=!1}catch(t){return void Ln(this,t)}t=n||"";var i,o=new ze(this.headers);r&&Ge(r,function(t,e){o.set(e,t)}),r=function(t){t:{for(var e=Cn,n=t.length,r="string"==typeof t?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return e<0?null:"string"==typeof t?t.charAt(e):t[e]}(o.L()),n=S.FormData&&t instanceof S.FormData,0<=F(Pn,e)&&!r&&!n&&o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Un(this),0<this.o&&((this.D=(i=this.a,rt&&lt(9)&&"number"==typeof i.timeout&&void 0!==i.ontimeout))?(this.a.timeout=this.o,this.a.ontimeout=R(this.xa,this)):this.m=Zt(this.xa,this.o,this)),this.l=!0,this.a.send(t),this.l=!1}catch(t){Ln(this,t)}},N.xa=function(){void 0!==A&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Ut(this,"timeout"),this.abort(8))},N.abort=function(t){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=t||7,Ut(this,"complete"),Ut(this,"abort"),Mn(this))},N.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),Mn(this,!0)),Dn.X.G.call(this)},N.za=function(){this.j||(this.A||this.l||this.g?Vn(this):this.Ua())},N.Ua=function(){Vn(this)},N.W=function(){try{return 2<jn(this)?this.a.status:-1}catch(t){return-1}},N.$=function(){try{return this.a?this.a.responseText:""}catch(t){return""}},N.Pa=function(t){if(this.a){var e=this.a.responseText;return t&&0==e.indexOf(t)&&(e=e.substring(t.length)),xn(e)}},N.ua=function(){return this.h},N.Qa=function(){return"string"==typeof this.f?this.f:String(this.f)},(N=Bn.prototype).ha=8,N.v=1,N.Ba=function(t){if(this.h)if(this.h=null,1==this.v){if(!t){this.R=Math.floor(1e5*Math.random()),t=this.R++;var e,n=new Oe(this,this.c,t,void 0),r=this.l;if(this.O&&(r?$(r=J(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)t:{for(var i=e=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"==typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(e+=o)){e=i;break t}if(4096===e||i===this.g.length-1){e=i+1;break t}}e=1e3}else e=1e3;e=Wn(this,n,e),tn(i=Xe(this.B),"RID",t),tn(i,"CVER",22),this.A&&tn(i,"X-HTTP-Session-Id",this.A),Xn(this,i),this.i&&r&&Fn(i,this.i,r),In(this.b,n),this.Ia&&tn(i,"TYPE","init"),this.da?(tn(i,"$req",e),tn(i,"SID","null"),n.U=!0,Le(n,i,null)):Le(n,i,e),this.v=2}}else 3==this.v&&(t?Kn(this,t):0==this.g.length||wn(this.b)||Kn(this))},N.Aa=function(){var t;this.j=null,tr(this),this.U&&!(this.F||null==this.a||this.N<=0)&&(t=2*this.N,this.c.info("BP detection timer enabled: "+t),this.s=be(R(this.Ta,this),t))},N.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,ge(10),zn(this),tr(this))},N.Sa=function(){null!=this.m&&(this.m=null,zn(this),Zn(this),ge(19))},N.Ya=function(t){t?(this.c.info("Successfully pinged google.com"),ge(2)):(this.c.info("Failed to ping google.com"),ge(1))},(N=ar.prototype).ta=function(){},N.sa=function(){},N.ra=function(){},N.qa=function(){},N.Ja=function(){},cr.prototype.a=function(t,e){return new hr(t,e)},U(hr,Mt),hr.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var t=this.a,e=this.o,n=this.b||void 0;ge(0),t.fa=e,t.V=n||{},t.H=t.S,t.B=sr(t,null,t.fa),Yn(t)},hr.prototype.close=function(){Gn(this.a)},hr.prototype.h=function(t){var e;"string"==typeof t?((e={}).__data__=t,Qn(this.a,e)):this.l?((e={}).__data__=Ft(t),Qn(this.a,e)):Qn(this.a,t)},hr.prototype.G=function(){this.a.f=null,delete this.f,Gn(this.a),delete this.a,hr.X.G.call(this)},U(fr,Se),U(lr,xe),U(pr,ar),pr.prototype.ta=function(){Ut(this.a,"a")},pr.prototype.sa=function(t){Ut(this.a,new fr(t))},pr.prototype.ra=function(t){Ut(this.a,new lr)},pr.prototype.qa=function(){Ut(this.a,"b")},cr.prototype.createWebChannel=cr.prototype.a,hr.prototype.send=hr.prototype.h,hr.prototype.open=hr.prototype.g,we.NO_ERROR=0,we.TIMEOUT=8,we.HTTP_ERROR=6,_e.COMPLETE="complete",(Te.EventType=Ae).OPEN="a",Ae.CLOSE="b",Ae.ERROR="c",Ae.MESSAGE="d",Mt.prototype.listen=Mt.prototype.va,Dn.prototype.listenOnce=Dn.prototype.wa,Dn.prototype.getLastError=Dn.prototype.Qa,Dn.prototype.getLastErrorCode=Dn.prototype.ua,Dn.prototype.getStatus=Dn.prototype.W,Dn.prototype.getResponseJson=Dn.prototype.Pa,Dn.prototype.getResponseText=Dn.prototype.$,Dn.prototype.send=Dn.prototype.ba;var dr=pe,yr=we,vr=_e,gr=fe,mr=Te,br=Dn,wr=function(t,e,n,r,i,o){this.t=t,this.persistenceKey=e,this.host=n,this.ssl=r,this.forceLongPolling=i,this.i=o},_r=(Object.defineProperty(Ir.prototype,"o",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),Ir.prototype.isEqual=function(t){return t instanceof Ir&&t.projectId===this.projectId&&t.database===this.database},Ir),Er=new a("@firebase/firestore");function Ir(t,e){this.projectId=t,this.database=e||"(default)"}function Tr(){return Er.logLevel}function Nr(t){for(var n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];Er.logLevel<=e.DEBUG&&(n=r.map(xr),Er.debug.apply(Er,d(["Firestore (8.2.10): "+t],n)))}function Ar(t){for(var n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];Er.logLevel<=e.ERROR&&(n=r.map(xr),Er.error.apply(Er,d(["Firestore (8.2.10): "+t],n)))}function Sr(t){for(var n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];Er.logLevel<=e.WARN&&(n=r.map(xr),Er.warn.apply(Er,d(["Firestore (8.2.10): "+t],n)))}function xr(t){if("string"==typeof t)return t;try{return JSON.stringify(t)}catch(e){return t}}function Dr(t){throw Ar(t="FIRESTORE (8.2.10) INTERNAL ASSERTION FAILED: "+(t=void 0===t?"Unexpected state":t)),new Error(t)}function Or(t){t||Dr()}var kr=(Pr.u=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,n="";n.length<20;)for(var r=function(t){var e="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(40);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(n);else for(var r=0;r<40;r++)n[r]=Math.floor(256*Math.random());return n}(),i=0;i<r.length;++i)n.length<20&&r[i]<e&&(n+=t.charAt(r[i]%t.length));return n},Pr);function Pr(){}function Cr(t,e){return t<e?-1:e<t?1:0}function Lr(t,e,n){return t.length===e.length&&t.every(function(t,r){return n(t,e[r])})}function Rr(t){return t+"\0"}var Vr=(Mr.fromBase64String=function(t){return new Mr(atob(t))},Mr.fromUint8Array=function(t){return new Mr(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(t))},Mr.prototype.toBase64=function(){return t=this.h,btoa(t);var t},Mr.prototype.toUint8Array=function(){return function(t){for(var e=new Uint8Array(t.length),n=0;n<t.length;n++)e[n]=t.charCodeAt(n);return e}(this.h)},Mr.prototype.l=function(){return 2*this.h.length},Mr.prototype._=function(t){return Cr(this.h,t.h)},Mr.prototype.isEqual=function(t){return this.h===t.h},Mr);function Mr(t){this.h=t}Vr.T=new Vr("");var Ur,jr={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},Fr=(f(Hr,Ur=Error),Hr),qr=(zr.fromBase64String=function(t){try{return new zr(Vr.fromBase64String(t))}catch(t){throw new Fr(jr.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},zr.fromUint8Array=function(t){return new zr(Vr.fromUint8Array(t))},zr.prototype.toBase64=function(){return this.I.toBase64()},zr.prototype.toUint8Array=function(){return this.I.toUint8Array()},zr.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},zr.prototype.isEqual=function(t){return this.I.isEqual(t.I)},zr),Br=(Gr.prototype.m=function(){return null!=this.uid},Gr.prototype.A=function(){return this.m()?"uid:"+this.uid:"anonymous-user"},Gr.prototype.isEqual=function(t){return t.uid===this.uid},Gr);function Gr(t){this.uid=t}function zr(t){this.I=t}function Hr(t,e){var n=this;return(n=Ur.call(this,e)||this).code=t,n.message=e,n.name="FirebaseError",n.toString=function(){return n.name+": [code="+n.code+"]: "+n.message},n}Br.UNAUTHENTICATED=new Br(null),Br.R=new Br("google-credentials-uid"),Br.P=new Br("first-party-uid");var Qr=(ei.prototype.getToken=function(){return Promise.resolve(null)},ei.prototype.p=function(){},ei.prototype.v=function(t){(this.V=t)(Br.UNAUTHENTICATED)},ei.prototype.S=function(){this.V=null},ei),Yr=(ti.prototype.getToken=function(){var t=this,e=this.N,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(function(n){return t.N!==e?(Nr("FirebaseCredentialsProvider","getToken aborted due to token change."),t.getToken()):n?(Or("string"==typeof n.accessToken),new function(t,e){this.user=e,this.type="OAuth",this.g={},this.g.Authorization="Bearer "+t}(n.accessToken,t.currentUser)):null}):Promise.resolve(null)},ti.prototype.p=function(){this.forceRefresh=!0},ti.prototype.v=function(t){this.V=t,this.C&&t(this.currentUser)},ti.prototype.S=function(){this.auth&&this.auth.removeAuthTokenListener(this.D),this.D=null,this.V=null},ti.prototype.$=function(){var t=this.auth&&this.auth.getUid();return Or(null===t||"string"==typeof t),new Br(t)},ti),Kr=(Object.defineProperty($r.prototype,"g",{get:function(){var t={"X-Goog-AuthUser":this.O},e=this.F.auth.getAuthHeaderValueForFirstParty([]);return e&&(t.Authorization=e),t},enumerable:!1,configurable:!0}),$r),Xr=(Zr.prototype.getToken=function(){return Promise.resolve(new Kr(this.F,this.O))},Zr.prototype.v=function(t){t(Br.P)},Zr.prototype.S=function(){},Zr.prototype.p=function(){},Zr),Wr=(Jr.prototype.M=function(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue},Jr.prototype.next=function(){var t=++this.previousValue;return this.L&&this.L(t),t},Jr);function Jr(t,e){var n=this;this.previousValue=t,e&&(e.k=function(t){return n.M(t)},this.L=function(t){return e.B(t)})}function Zr(t,e){this.F=t,this.O=e}function $r(t,e){this.F=t,this.O=e,this.type="FirstParty",this.user=Br.P}function ti(t){var e=this;this.D=null,this.currentUser=Br.UNAUTHENTICATED,this.C=!1,this.N=0,this.V=null,this.forceRefresh=!1,this.D=function(){e.N++,e.currentUser=e.$(),e.C=!0,e.V&&e.V(e.currentUser)},this.N=0,this.auth=t.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.D):(this.D(null),t.get().then(function(t){e.auth=t,e.D&&e.auth.addAuthTokenListener(e.D)},function(){}))}function ei(){this.V=null}Wr.q=-1;var ni,ri,ii=(yi.now=function(){return yi.fromMillis(Date.now())},yi.fromDate=function(t){return yi.fromMillis(t.getTime())},yi.fromMillis=function(t){var e=Math.floor(t/1e3);return new yi(e,1e6*(t-1e3*e))},yi.prototype.toDate=function(){return new Date(this.toMillis())},yi.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},yi.prototype.U=function(t){return this.seconds===t.seconds?Cr(this.nanoseconds,t.nanoseconds):Cr(this.seconds,t.seconds)},yi.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},yi.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},yi.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},yi.prototype.valueOf=function(){var t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},yi),oi=(di.K=function(t){return new di(t)},di.min=function(){return new di(new ii(0,0))},di.prototype._=function(t){return this.timestamp.U(t.timestamp)},di.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},di.prototype.W=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},di.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},di.prototype.j=function(){return this.timestamp},di),si=(_e=(Object.defineProperty(pi.prototype,"length",{get:function(){return this.G},enumerable:!1,configurable:!0}),pi.prototype.isEqual=function(t){return 0===pi.H(this,t)},pi.prototype.child=function(t){var e=this.segments.slice(this.offset,this.limit());return t instanceof pi?t.forEach(function(t){e.push(t)}):e.push(t),this.J(e)},pi.prototype.limit=function(){return this.offset+this.length},pi.prototype.Y=function(t){return t=void 0===t?1:t,this.J(this.segments,this.offset+t,this.length-t)},pi.prototype.X=function(){return this.J(this.segments,this.offset,this.length-1)},pi.prototype.Z=function(){return this.segments[this.offset]},pi.prototype.tt=function(){return this.get(this.length-1)},pi.prototype.get=function(t){return this.segments[this.offset+t]},pi.prototype.et=function(){return 0===this.length},pi.prototype.nt=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.st=function(t){if(this.length+1!==t.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},pi.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},pi.prototype.it=function(){return this.segments.slice(this.offset,this.limit())},pi.H=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(o<i)return 1}return t.length<e.length?-1:t.length>e.length?1:0},pi),f(li,ri=_e),li.prototype.J=function(t,e,n){return new li(t,e,n)},li.prototype.rt=function(){return this.it().join("/")},li.prototype.toString=function(){return this.rt()},li.ot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=[],r=0,i=t;r<i.length;r++){var o=i[r];if(0<=o.indexOf("//"))throw new Fr(jr.INVALID_ARGUMENT,"Invalid segment ("+o+"). Paths must not contain // in them.");n.push.apply(n,o.split("/").filter(function(t){return 0<t.length}))}return new li(n)},li.ct=function(){return new li([])},li),ui=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ai=(f(fi,ni=_e),fi.prototype.J=function(t,e,n){return new fi(t,e,n)},fi.at=function(t){return ui.test(t)},fi.prototype.rt=function(){return this.it().map(function(t){return t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),fi.at(t)?t:"`"+t+"`"}).join(".")},fi.prototype.toString=function(){return this.rt()},fi.prototype.ut=function(){return 1===this.length&&"__name__"===this.get(0)},fi.ht=function(){return new fi(["__name__"])},fi.lt=function(t){for(var e=[],n="",r=0,i=function(){if(0===n.length)throw new Fr(jr.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");e.push(n),n=""},o=!1;r<t.length;){var s=t[r];if("\\"===s){if(r+1===t.length)throw new Fr(jr.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[r+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new Fr(jr.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);n+=u,r+=2}else"`"===s?o=!o:"."!==s||o?n+=s:i(),r++}if(i(),o)throw new Fr(jr.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new fi(e)},fi.ct=function(){return new fi([])},fi),ci=(hi._t=function(t){return new hi(si.ot(t))},hi.ft=function(t){return new hi(si.ot(t).Y(5))},hi.prototype.dt=function(t){return 2<=this.path.length&&this.path.get(this.path.length-2)===t},hi.prototype.isEqual=function(t){return null!==t&&0===si.H(this.path,t.path)},hi.prototype.toString=function(){return this.path.toString()},hi.H=function(t,e){return si.H(t.path,e.path)},hi.wt=function(t){return t.length%2==0},hi.Et=function(t){return new hi(new si(t.slice()))},hi);function hi(t){this.path=t}function fi(){return null!==ni&&ni.apply(this,arguments)||this}function li(){return null!==ri&&ri.apply(this,arguments)||this}function pi(t,e,n){void 0===e?e=0:e>t.length&&Dr(),void 0===n?n=t.length-e:n>t.length-e&&Dr(),this.segments=t,this.offset=e,this.G=n}function di(t){this.timestamp=t}function yi(t,e){if(this.seconds=t,(this.nanoseconds=e)<0)throw new Fr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(1e9<=e)throw new Fr(jr.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new Fr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(253402300800<=t)throw new Fr(jr.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}function vi(t){var e,n=0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n++;return n}function gi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function mi(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}var bi=(_i.prototype.Tt=function(t){for(var e=0,n=this.fields;e<n.length;e++)if(n[e].nt(t))return!0;return!1},_i.prototype.isEqual=function(t){return Lr(this.fields,t.fields,function(t,e){return t.isEqual(e)})},_i),wi=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function _i(t){(this.fields=t).sort(ai.H)}function Ei(t){if(Or(!!t),"string"!=typeof t)return{seconds:Ii(t.seconds),nanos:Ii(t.nanos)};var e=0,n=wi.exec(t);return Or(!!n),n[1]&&(n=((n=n[1])+"000000000").substr(0,9),e=Number(n)),t=new Date(t),{seconds:Math.floor(t.getTime()/1e3),nanos:e}}function Ii(t){return"number"==typeof t?t:"string"==typeof t?Number(t):0}function Ti(t){return"string"==typeof t?Vr.fromBase64String(t):Vr.fromUint8Array(t)}function Ni(t){return"server_timestamp"===(null===(t=((null===(t=null==t?void 0:t.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Ai(t){return t=Ei(t.mapValue.fields.__local_write_time__.timestampValue),new ii(t.seconds,t.nanos)}function Si(t){return null==t}function xi(t){return 0===t&&1/t==-1/0}function Di(t){return"number"==typeof t&&Number.isInteger(t)&&!xi(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}function Oi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ni(t)?4:10:Dr()}function ki(t,e){var n,r,i=Oi(t);if(i!==Oi(e))return!1;switch(i){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Ai(t).isEqual(Ai(e));case 3:return function(e){if("string"==typeof t.timestampValue&&"string"==typeof e.timestampValue&&t.timestampValue.length===e.timestampValue.length)return t.timestampValue===e.timestampValue;var n=Ei(t.timestampValue);e=Ei(e.timestampValue);return n.seconds===e.seconds&&n.nanos===e.nanos}(e);case 5:return t.stringValue===e.stringValue;case 6:return r=e,Ti(t.bytesValue).isEqual(Ti(r.bytesValue));case 7:return t.referenceValue===e.referenceValue;case 8:return n=e,Ii((r=t).geoPointValue.latitude)===Ii(n.geoPointValue.latitude)&&Ii(r.geoPointValue.longitude)===Ii(n.geoPointValue.longitude);case 2:return function(t,e){return"integerValue"in t&&"integerValue"in e?Ii(t.integerValue)===Ii(e.integerValue):"doubleValue"in t&&"doubleValue"in e&&((t=Ii(t.doubleValue))===(e=Ii(e.doubleValue))?xi(t)===xi(e):isNaN(t)&&isNaN(e))}(t,e);case 9:return Lr(t.arrayValue.values||[],e.arrayValue.values||[],ki);case 10:return function(){var n,r=t.mapValue.fields||{},i=e.mapValue.fields||{};if(vi(r)!==vi(i))return!1;for(n in r)if(r.hasOwnProperty(n)&&(void 0===i[n]||!ki(r[n],i[n])))return!1;return!0}();default:return Dr()}}function Pi(t,e){return void 0!==(t.values||[]).find(function(t){return ki(t,e)})}function Ci(t,e){var n,r,i,o=Oi(t),s=Oi(e);if(o!==s)return Cr(o,s);switch(o){case 0:return 0;case 1:return Cr(t.booleanValue,e.booleanValue);case 2:return r=e,(i=Ii(t.integerValue||t.doubleValue))<(r=Ii(r.integerValue||r.doubleValue))?-1:r<i?1:i===r?0:isNaN(i)?isNaN(r)?0:-1:1;case 3:return Li(t.timestampValue,e.timestampValue);case 4:return Li(Ai(t),Ai(e));case 5:return Cr(t.stringValue,e.stringValue);case 6:return function(t,e){return t=Ti(t),e=Ti(e),t._(e)}(t.bytesValue,e.bytesValue);case 7:return function(t,e){for(var n=t.split("/"),r=e.split("/"),i=0;i<n.length&&i<r.length;i++){var o=Cr(n[i],r[i]);if(0!==o)return o}return Cr(n.length,r.length)}(t.referenceValue,e.referenceValue);case 8:return n=t.geoPointValue,i=e.geoPointValue,0!==(r=Cr(Ii(n.latitude),Ii(i.latitude)))?r:Cr(Ii(n.longitude),Ii(i.longitude));case 9:return function(t,e){for(var n=t.values||[],r=e.values||[],i=0;i<n.length&&i<r.length;++i){var o=Ci(n[i],r[i]);if(o)return o}return Cr(n.length,r.length)}(t.arrayValue,e.arrayValue);case 10:return function(t,e){var n=t.fields||{},r=Object.keys(n),i=e.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var s=0;s<r.length&&s<o.length;++s){var u=Cr(r[s],o[s]);if(0!==u)return u;if(0!==(u=Ci(n[r[s]],i[o[s]])))return u}return Cr(r.length,o.length)}(t.mapValue,e.mapValue);default:throw Dr()}}function Li(t,e){if("string"==typeof t&&"string"==typeof e&&t.length===e.length)return Cr(t,e);var n=Ei(t);t=Ei(e);return 0!==(e=Cr(n.seconds,t.seconds))?e:Cr(n.nanos,t.nanos)}function Ri(t){return function t(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(t){return"time("+(t=Ei(t)).seconds+","+t.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?Ti(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,ci.ft(n).toString()):"geoPointValue"in e?"geo("+(n=e.geoPointValue).latitude+","+n.longitude+")":"arrayValue"in e?function(e){for(var n="[",r=!0,i=0,o=e.values||[];i<o.length;i++)r?r=!1:n+=",",n+=t(o[i]);return n+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var n="{",r=!0,i=0,o=Object.keys(e.fields||{}).sort();i<o.length;i++){var s=o[i];r?r=!1:n+=",",n+=s+":"+t(e.fields[s])}return n+"}"}(e.mapValue):Dr();var n}(t)}function Vi(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.rt()}}function Mi(t){return t&&"integerValue"in t}function Ui(t){return!!t&&"arrayValue"in t}function ji(t){return t&&"nullValue"in t}function Fi(t){return t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function qi(t){return t&&"mapValue"in t}var Bi=(Hi.empty=function(){return new Hi({mapValue:{}})},Hi.prototype.field=function(t){if(t.et())return this.proto;for(var e=this.proto,n=0;n<t.length-1;++n){if(!e.mapValue.fields)return null;if(!qi(e=e.mapValue.fields[t.get(n)]))return null}return(e=(e.mapValue.fields||{})[t.tt()])||null},Hi.prototype.isEqual=function(t){return ki(this.proto,t.proto)},Hi),Gi=(zi.prototype.set=function(t,e){return this.Rt(t,e),this},zi.prototype.delete=function(t){return this.Rt(t,null),this},zi.prototype.Rt=function(t,e){for(var n=this.At,r=0;r<t.length-1;++r){var i=t.get(r),o=n.get(i);n=(o instanceof Map||(o=o&&10===Oi(o)?new Map(Object.entries(o.mapValue.fields||{})):new Map,n.set(i,o)),o)}n.set(t.tt(),e)},zi.prototype.Pt=function(){var t=this.yt(ai.ct(),this.At);return null!=t?new Bi(t):this.It},zi.prototype.yt=function(t,e){var n=this,r=!1,i=this.It.field(t),o=qi(i)?Object.assign({},i.mapValue.fields):{};return e.forEach(function(e,i){var s;e instanceof Map?null!=(s=n.yt(t.child(i),e))&&(o[i]=s,r=!0):null!==e?(o[i]=e,r=!0):o.hasOwnProperty(i)&&(delete o[i],r=!0)}),r?{mapValue:{fields:o}}:null},zi);function zi(t){void 0===t&&(t=Bi.empty()),this.It=t,this.At=new Map}function Hi(t){this.proto=t}var Qi,Yi,Ki,Xi=(f(eo,Ki=a=function(t,e){this.key=t,this.version=e}),eo.prototype.field=function(t){return this.gt.field(t)},eo.prototype.data=function(){return this.gt},eo.prototype.bt=function(){return this.gt.proto},eo.prototype.isEqual=function(t){return t instanceof eo&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.Vt===t.Vt&&this.hasCommittedMutations===t.hasCommittedMutations&&this.gt.isEqual(t.gt)},eo.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.gt.toString()+", {hasLocalMutations: "+this.Vt+"}), {hasCommittedMutations: "+this.hasCommittedMutations+"})"},Object.defineProperty(eo.prototype,"hasPendingWrites",{get:function(){return this.Vt||this.hasCommittedMutations},enumerable:!1,configurable:!0}),eo),Wi=(f(to,Yi=a),to.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},Object.defineProperty(to.prototype,"hasPendingWrites",{get:function(){return this.hasCommittedMutations},enumerable:!1,configurable:!0}),to.prototype.isEqual=function(t){return t instanceof to&&t.hasCommittedMutations===this.hasCommittedMutations&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},to),Ji=(f($i,Qi=a),$i.prototype.toString=function(){return"UnknownDocument("+this.key+", "+this.version+")"},Object.defineProperty($i.prototype,"hasPendingWrites",{get:function(){return!0},enumerable:!1,configurable:!0}),$i.prototype.isEqual=function(t){return t instanceof $i&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},$i),Zi=function(t,e,n,r,i,o,s){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===s&&(s=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=s,this.vt=null};function $i(){return null!==Qi&&Qi.apply(this,arguments)||this}function to(t,e,n){var r;return(r=Yi.call(this,t,e)||this).hasCommittedMutations=!(!n||!n.hasCommittedMutations),r}function eo(t,e,n,r){var i=this;return(i=Ki.call(this,t,e)||this).gt=n,i.Vt=!!r.Vt,i.hasCommittedMutations=!!r.hasCommittedMutations,i}function no(t,e,n,r,i,o,s){return new Zi(t,e=void 0===e?null:e,n=void 0===n?[]:n,r=void 0===r?[]:r,i=void 0===i?null:i,o=void 0===o?null:o,s=void 0===s?null:s)}function ro(t){var e=t;return null===e.vt&&(t=e.path.rt(),null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(function(t){return(t=t).field.rt()+t.op.toString()+Ri(t.value)}).join(","),t+="|ob:",t+=e.orderBy.map(function(t){return(t=t).field.rt()+t.dir}).join(","),Si(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=Co(e.startAt)),e.endAt&&(t+="|ub:",t+=Co(e.endAt)),e.vt=t),e.vt}function io(t,e){if(t.limit!==e.limit)return!1;if(t.orderBy.length!==e.orderBy.length)return!1;for(var n,r,i=0;i<t.orderBy.length;i++)if(n=t.orderBy[i],r=e.orderBy[i],n.dir!==r.dir||!n.field.isEqual(r.field))return!1;if(t.filters.length!==e.filters.length)return!1;for(var o,s,u=0;u<t.filters.length;u++)if(o=t.filters[u],s=e.filters[u],o.op!==s.op||!o.field.isEqual(s.field)||!ki(o.value,s.value))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Vo(t.startAt,e.startAt)&&Vo(t.endAt,e.endAt)}function oo(t){return ci.wt(t.path)&&null===t.collectionGroup&&0===t.filters.length}var so,uo=(f(ao,so=function(){}),ao.create=function(t,e,n){return t.ut()?"in"===e||"not-in"===e?this.St(t,e,n):new lo(t,e,n):"array-contains"===e?new To(t,n):"in"===e?new No(t,n):"not-in"===e?new Ao(t,n):"array-contains-any"===e?new So(t,n):new ao(t,e,n)},ao.St=function(t,e,n){return new("in"===e?po:yo)(t,n)},ao.prototype.matches=function(t){return t=t.field(this.field),"!="===this.op?null!==t&&this.Dt(Ci(t,this.value)):null!==t&&Oi(this.value)===Oi(t)&&this.Dt(Ci(t,this.value))},ao.prototype.Dt=function(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return 0===t;case"!=":return 0!==t;case">":return 0<t;case">=":return 0<=t;default:return Dr()}},ao.prototype.Ct=function(){return 0<=["<","<=",">",">=","!=","not-in"].indexOf(this.op)},ao);function ao(t,e,n){var r=this;return(r=so.call(this)||this).field=t,r.op=e,r.value=n,r}var co,ho,fo,lo=(f(mo,fo=uo),mo.prototype.matches=function(t){return t=ci.H(t.key,this.key),this.Dt(t)},mo),po=(f(go,ho=uo),go.prototype.matches=function(t){return this.keys.some(function(e){return e.isEqual(t.key)})},go),yo=(f(vo,co=uo),vo.prototype.matches=function(t){return!this.keys.some(function(e){return e.isEqual(t.key)})},vo);function vo(t,e){var n;return(n=co.call(this,t,"not-in",e)||this).keys=bo(0,e),n}function go(t,e){var n;return(n=ho.call(this,t,"in",e)||this).keys=bo(0,e),n}function mo(t,e,n){var r;return(r=fo.call(this,t,e,n)||this).key=ci.ft(n.referenceValue),r}function bo(t,e){return((null===(e=e.arrayValue)||void 0===e?void 0:e.values)||[]).map(function(t){return ci.ft(t.referenceValue)})}var wo,_o,Eo,Io,To=(f(Po,Io=uo),Po.prototype.matches=function(t){return Ui(t=t.field(this.field))&&Pi(t.arrayValue,this.value)},Po),No=(f(ko,Eo=uo),ko.prototype.matches=function(t){return null!==(t=t.field(this.field))&&Pi(this.value.arrayValue,t)},ko),Ao=(f(Oo,_o=uo),Oo.prototype.matches=function(t){return!Pi(this.value.arrayValue,{nullValue:"NULL_VALUE"})&&(null!==(t=t.field(this.field))&&!Pi(this.value.arrayValue,t))},Oo),So=(f(Do,wo=uo),Do.prototype.matches=function(t){var e=this;return!(!Ui(t=t.field(this.field))||!t.arrayValue.values)&&t.arrayValue.values.some(function(t){return Pi(e.value.arrayValue,t)})},Do),xo=function(t,e){this.position=t,this.before=e};function Do(t,e){return wo.call(this,t,"array-contains-any",e)||this}function Oo(t,e){return _o.call(this,t,"not-in",e)||this}function ko(t,e){return Eo.call(this,t,"in",e)||this}function Po(t,e){return Io.call(this,t,"array-contains",e)||this}function Co(t){return(t.before?"b":"a")+":"+t.position.map(Ri).join(",")}var Lo=function(t,e){void 0===e&&(e="asc"),this.field=t,this.dir=e};function Ro(t,e,n){for(var r=0,i=0;i<t.position.length;i++){var o=e[i],s=t.position[i];r=o.field.ut()?ci.H(ci.ft(s.referenceValue),n.key):Ci(s,n.field(o.field));if("desc"===o.dir&&(r*=-1),0!==r)break}return t.before?r<=0:r<0}function Vo(t,e){if(null===t)return null===e;if(null===e)return!1;if(t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!ki(t.position[n],e.position[n]))return!1;return!0}var Mo=function(t,e,n,r,i,o,s,u){void 0===e&&(e=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===s&&(s=null),void 0===u&&(u=null),this.path=t,this.collectionGroup=e,this.xt=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=s,this.endAt=u,this.Nt=null,this.$t=null,this.startAt,this.endAt};function Uo(t,e,n,r,i,o,s,u){return new Mo(t,e,n,r,i,o,s,u)}function jo(t){return new Mo(t)}function Fo(t){return!Si(t.limit)&&"F"===t.limitType}function qo(t){return!Si(t.limit)&&"L"===t.limitType}function Bo(t){return 0<t.xt.length?t.xt[0].field:null}function Go(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.Ct())return r.field}return null}function zo(t){return null!==t.collectionGroup}function Ho(t){var e=t;if(null===e.Nt){e.Nt=[];var n=Go(e);t=Bo(e);if(null!==n&&null===t)n.ut()||e.Nt.push(new Lo(n)),e.Nt.push(new Lo(ai.ht(),"asc"));else{for(var r=!1,i=0,o=e.xt;i<o.length;i++){var s=o[i];e.Nt.push(s),s.field.ut()&&(r=!0)}r||(n=0<e.xt.length?e.xt[e.xt.length-1].dir:"asc",e.Nt.push(new Lo(ai.ht(),n)))}}return e.Nt}function Qo(t){var e=t;if(!e.$t)if("F"===e.limitType)e.$t=no(e.path,e.collectionGroup,Ho(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,i=Ho(e);r<i.length;r++){var o=i[r],s="desc"===o.dir?"asc":"desc";n.push(new Lo(o.field,s))}var u=e.endAt?new xo(e.endAt.position,!e.endAt.before):null;t=e.startAt?new xo(e.startAt.position,!e.startAt.before):null;e.$t=no(e.path,e.collectionGroup,n,e.filters,e.limit,u,t)}return e.$t}function Yo(t,e,n){return new Mo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ko(t,e){return io(Qo(t),Qo(e))&&t.limitType===e.limitType}function Xo(t){return ro(Qo(t))+"|lt:"+t.limitType}function Wo(t){return"Query(target="+(n=(e=Qo(t)).path.rt(),null!==e.collectionGroup&&(n+=" collectionGroup="+e.collectionGroup),0<e.filters.length&&(n+=", filters: ["+e.filters.map(function(t){return(t=t).field.rt()+" "+t.op+" "+Ri(t.value)}).join(", ")+"]"),Si(e.limit)||(n+=", limit: "+e.limit),0<e.orderBy.length&&(n+=", orderBy: ["+e.orderBy.map(function(t){return(t=t).field.rt()+" ("+t.dir+")"}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+Co(e.startAt)),e.endAt&&(n+=", endAt: "+Co(e.endAt)),"Target("+n+")")+"; limitType="+t.limitType+")";var e,n}function Jo(t,e){return n=t,r=e.key.path,(null!==n.collectionGroup?e.key.dt(n.collectionGroup)&&n.path.nt(r):ci.wt(n.path)?n.path.isEqual(r):n.path.st(r))&&function(e){for(var n=0,r=t.xt;n<r.length;n++){var i=r[n];if(!i.field.ut()&&null===e.field(i.field))return}return 1}(e)&&function(e){for(var n=0,r=t.filters;n<r.length;n++)if(!r[n].matches(e))return;return 1}(e)&&(r=e,(!(e=t).startAt||Ro(e.startAt,Ho(e),r))&&(!e.endAt||!Ro(e.endAt,Ho(e),r)));var n,r}function Zo(t){return function(e,n){for(var r=!1,i=0,o=Ho(t);i<o.length;i++){var s=o[i],u=function(t,e,n){var r=t.field.ut()?ci.H(e.key,n.key):function(t,n){var r=e.field(t);t=n.field(t);return null!==r&&null!==t?Ci(r,t):Dr()}(t.field,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Dr()}}(s,e,n);if(0!==u)return u;r=r||s.field.ut()}return 0}}var $o=(ts.prototype.kt=function(t){return new ts(this.target,this.targetId,this.Ft,t,this.Ot,this.lastLimboFreeSnapshotVersion,this.resumeToken)},ts.prototype.Mt=function(t,e){return new ts(this.target,this.targetId,this.Ft,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t)},ts.prototype.Lt=function(t){return new ts(this.target,this.targetId,this.Ft,this.sequenceNumber,this.Ot,t,this.resumeToken)},ts);function ts(t,e,n,r,i,o,s){void 0===i&&(i=oi.min()),void 0===o&&(o=oi.min()),void 0===s&&(s=Vr.T),this.target=t,this.targetId=e,this.Ft=n,this.sequenceNumber=r,this.Ot=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=s}function es(t,e){if(t.Bt){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:xi(e)?"-0":e}}function ns(t){return{integerValue:""+t}}function rs(t,e){return Di(e)?ns(e):es(t,e)}function is(t,e){return t instanceof gs?Mi(t=e)||t&&"doubleValue"in t?e:{integerValue:0}:null}var os,ss,us=(f(hs,ss=_e=function(){this.qt=void 0}),hs),as=(f(cs,os=_e),cs);function cs(t){var e;return(e=os.call(this)||this).elements=t,e}function hs(){return null!==ss&&ss.apply(this,arguments)||this}function fs(t,e){for(var n=ws(e),r=0,i=t.elements;r<i.length;r++)!function(t){n.some(function(e){return ki(e,t)})||n.push(t)}(i[r]);return{arrayValue:{values:n}}}var ls,ps=(f(ds,ls=_e),ds);function ds(t){var e;return(e=ls.call(this)||this).elements=t,e}function ys(t,e){for(var n=ws(e),r=0,i=t.elements;r<i.length;r++)!function(t){n=n.filter(function(e){return!ki(e,t)})}(i[r]);return{arrayValue:{values:n}}}var vs,gs=(f(ms,vs=_e),ms);function ms(t,e){var n=this;return(n=vs.call(this)||this).Qt=t,n.Ut=e,n}function bs(t){return Ii(t.integerValue||t.doubleValue)}function ws(t){return Ui(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}var _s=function(t,e){this.field=t,this.transform=e},Es=(Is.Kt=function(){return new Is},Is.exists=function(t){return new Is(void 0,t)},Is.updateTime=function(t){return new Is(t)},Object.defineProperty(Is.prototype,"Wt",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),Is.prototype.isEqual=function(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)},Is);function Is(t,e){this.updateTime=t,this.exists=e}function Ts(t,e){return void 0!==t.updateTime?e instanceof Xi&&e.version.isEqual(t.updateTime):void 0===t.exists||t.exists===e instanceof Xi}function Ns(t,e,n){return t instanceof Os?function(t,e,n){if(!Ts(t.jt,e))return e;var r=t.value;n=Vs(t.fieldTransforms,n,e),r=Ms(t.fieldTransforms,r,n),e=Ss(e);return new Xi(t.key,e,r,{Vt:!0})}(t,e,n):t instanceof ks?function(t,e,n){if(!Ts(t.jt,e))return e;var r=Ss(e);e=Ls(t,e,Vs(t.fieldTransforms,n,e));return new Xi(t.key,r,e,{Vt:!0})}(t,e,n):(e=e,Ts((t=t).jt,e)?new Wi(t.key,oi.min()):e)}function As(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.jt.isEqual(e.jt)&&(n=t.fieldTransforms,r=e.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Lr(n,r,function(t,e){return e=e,(t=t).field.isEqual(e.field)&&(t=t.transform,e=e.transform,t instanceof as&&e instanceof as||t instanceof ps&&e instanceof ps?Lr(t.elements,e.elements,ki):t instanceof gs&&e instanceof gs?ki(t.Ut,e.Ut):t instanceof us&&e instanceof us)})))&&(0===t.type?t.value.isEqual(e.value):1!==t.type||t.data.isEqual(e.data)&&t.Gt.isEqual(e.Gt));var n,r}function Ss(t){return t instanceof Xi?t.version:oi.min()}var xs,Ds,Os=(f(Cs,Ds=a=function(){}),Cs),ks=(f(Ps,xs=a),Ps);function Ps(t,e,n,r,i){void 0===i&&(i=[]);var o=this;return(o=xs.call(this)||this).key=t,o.data=e,o.Gt=n,o.jt=r,o.fieldTransforms=i,o.type=1,o}function Cs(t,e,n,r){void 0===r&&(r=[]);var i=this;return(i=Ds.call(this)||this).key=t,i.value=e,i.jt=n,i.fieldTransforms=r,i.type=0,i}function Ls(t,e,n){var r,i,o;return i=t,e=e instanceof Xi?e.data():Bi.empty(),o=new Gi(e),i.Gt.fields.forEach(function(t){var e;t.et()||(null!==(e=i.data.field(t))?o.set(t,e):o.delete(t))}),r=o.Pt(),Ms(t.fieldTransforms,r,n)}function Rs(t,e,n){var r=[];Or(t.length===n.length);for(var i=0;i<n.length;i++){var o=t[i],s=o.transform,u=null;e instanceof Xi&&(u=e.field(o.field)),r.push((o=s,s=u,u=n[i],o instanceof as?fs(o,s):o instanceof ps?ys(o,s):u))}return r}function Vs(t,e,n){for(var r,i=[],o=0,s=t;o<s.length;o++){var u=s[o],a=u.transform,c=null;n instanceof Xi&&(c=n.field(u.field)),i.push((r=c,u=e,c=void 0,(a=a)instanceof us?(c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:u.seconds,nanos:u.nanoseconds}}}},r&&(c.fields.__previous_value__=r),{mapValue:c}):a instanceof as?fs(a,r):a instanceof ps?ys(a,r):(r=bs(a=is(c=a,r))+bs(c.Ut),Mi(a)&&Mi(c.Ut)?ns(r):es(c.Qt,r))))}return i}function Ms(t,e,n){for(var r=new Gi(e),i=0;i<t.length;i++){var o=t[i];r.set(o.field,n[i])}return r.Pt()}var Us,js,Fs,qs=(f(zs,Fs=a),zs),Bs=(f(Gs,js=a),Gs);function Gs(t,e){var n=this;return(n=js.call(this)||this).key=t,n.jt=e,n.type=3,n.fieldTransforms=[],n}function zs(t,e){var n=this;return(n=Fs.call(this)||this).key=t,n.jt=e,n.type=2,n.fieldTransforms=[],n}function Hs(t){switch(t){case jr.OK:return Dr(),0;case jr.CANCELLED:case jr.UNKNOWN:case jr.DEADLINE_EXCEEDED:case jr.RESOURCE_EXHAUSTED:case jr.INTERNAL:case jr.UNAVAILABLE:case jr.UNAUTHENTICATED:return;case jr.INVALID_ARGUMENT:case jr.NOT_FOUND:case jr.ALREADY_EXISTS:case jr.PERMISSION_DENIED:case jr.FAILED_PRECONDITION:case jr.ABORTED:case jr.OUT_OF_RANGE:case jr.UNIMPLEMENTED:case jr.DATA_LOSS:return 1;default:return Dr(),0}}function Qs(t){if(void 0===t)return Ar("GRPC error has no .code"),jr.UNKNOWN;switch(t){case Us.OK:return jr.OK;case Us.CANCELLED:return jr.CANCELLED;case Us.UNKNOWN:return jr.UNKNOWN;case Us.DEADLINE_EXCEEDED:return jr.DEADLINE_EXCEEDED;case Us.RESOURCE_EXHAUSTED:return jr.RESOURCE_EXHAUSTED;case Us.INTERNAL:return jr.INTERNAL;case Us.UNAVAILABLE:return jr.UNAVAILABLE;case Us.UNAUTHENTICATED:return jr.UNAUTHENTICATED;case Us.INVALID_ARGUMENT:return jr.INVALID_ARGUMENT;case Us.NOT_FOUND:return jr.NOT_FOUND;case Us.ALREADY_EXISTS:return jr.ALREADY_EXISTS;case Us.PERMISSION_DENIED:return jr.PERMISSION_DENIED;case Us.FAILED_PRECONDITION:return jr.FAILED_PRECONDITION;case Us.ABORTED:return jr.ABORTED;case Us.OUT_OF_RANGE:return jr.OUT_OF_RANGE;case Us.UNIMPLEMENTED:return jr.UNIMPLEMENTED;case Us.DATA_LOSS:return jr.DATA_LOSS;default:return Dr()}}(_e=Us=Us||{})[_e.OK=0]="OK",_e[_e.CANCELLED=1]="CANCELLED",_e[_e.UNKNOWN=2]="UNKNOWN",_e[_e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_e[_e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_e[_e.NOT_FOUND=5]="NOT_FOUND",_e[_e.ALREADY_EXISTS=6]="ALREADY_EXISTS",_e[_e.PERMISSION_DENIED=7]="PERMISSION_DENIED",_e[_e.UNAUTHENTICATED=16]="UNAUTHENTICATED",_e[_e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_e[_e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_e[_e.ABORTED=10]="ABORTED",_e[_e.OUT_OF_RANGE=11]="OUT_OF_RANGE",_e[_e.UNIMPLEMENTED=12]="UNIMPLEMENTED",_e[_e.INTERNAL=13]="INTERNAL",_e[_e.UNAVAILABLE=14]="UNAVAILABLE",_e[_e.DATA_LOSS=15]="DATA_LOSS";var Ys=(Zs.prototype.zt=function(t,e){return new Zs(this.H,this.root.zt(t,e,this.H).copy(null,null,Xs.Ht,null,null))},Zs.prototype.remove=function(t){return new Zs(this.H,this.root.remove(t,this.H).copy(null,null,Xs.Ht,null,null))},Zs.prototype.get=function(t){for(var e=this.root;!e.et();){var n=this.H(t,e.key);if(0===n)return e.value;n<0?e=e.left:0<n&&(e=e.right)}return null},Zs.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.et();){var r=this.H(t,n.key);if(0===r)return e+n.left.size;n=r<0?n.left:(e+=n.left.size+1,n.right)}return-1},Zs.prototype.et=function(){return this.root.et()},Object.defineProperty(Zs.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),Zs.prototype.Jt=function(){return this.root.Jt()},Zs.prototype.Yt=function(){return this.root.Yt()},Zs.prototype.Xt=function(t){return this.root.Xt(t)},Zs.prototype.forEach=function(t){this.Xt(function(e,n){return t(e,n),!1})},Zs.prototype.toString=function(){var t=[];return this.Xt(function(e,n){return t.push(e+":"+n),!1}),"{"+t.join(", ")+"}"},Zs.prototype.Zt=function(t){return this.root.Zt(t)},Zs.prototype.te=function(){return new Ks(this.root,null,this.H,!1)},Zs.prototype.ee=function(t){return new Ks(this.root,t,this.H,!1)},Zs.prototype.ne=function(){return new Ks(this.root,null,this.H,!0)},Zs.prototype.se=function(t){return new Ks(this.root,t,this.H,!0)},Zs),Ks=(Js.prototype.oe=function(){var t=this.re.pop(),e={key:t.key,value:t.value};if(this.ie)for(t=t.left;!t.et();)this.re.push(t),t=t.right;else for(t=t.right;!t.et();)this.re.push(t),t=t.left;return e},Js.prototype.ce=function(){return 0<this.re.length},Js.prototype.ae=function(){if(0===this.re.length)return null;var t=this.re[this.re.length-1];return{key:t.key,value:t.value}},Js),Xs=(Ws.prototype.copy=function(t,e,n,r,i){return new Ws(null!=t?t:this.key,null!=e?e:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)},Ws.prototype.et=function(){return!1},Ws.prototype.Xt=function(t){return this.left.Xt(t)||t(this.key,this.value)||this.right.Xt(t)},Ws.prototype.Zt=function(t){return this.right.Zt(t)||t(this.key,this.value)||this.left.Zt(t)},Ws.prototype.min=function(){return this.left.et()?this:this.left.min()},Ws.prototype.Jt=function(){return this.min().key},Ws.prototype.Yt=function(){return this.right.et()?this.key:this.right.Yt()},Ws.prototype.zt=function(t,e,n){var r=this,i=n(t,r.key);return(r=i<0?r.copy(null,null,null,r.left.zt(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.zt(t,e,n))).ue()},Ws.prototype.he=function(){if(this.left.et())return Ws.EMPTY;var t=this;return(t=(t=t.left.le()||t.left.left.le()?t:t._e()).copy(null,null,null,t.left.he(),null)).ue()},Ws.prototype.remove=function(t,e){var n,r=this;if(e(t,r.key)<0)r=(r=r.left.et()||r.left.le()||r.left.left.le()?r:r._e()).copy(null,null,null,r.left.remove(t,e),null);else{if(0===e(t,(r=(r=r.left.le()?r.fe():r).right.et()||r.right.le()||r.right.left.le()?r:r.de()).key)){if(r.right.et())return Ws.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.he())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.ue()},Ws.prototype.le=function(){return this.color},Ws.prototype.ue=function(){var t=this;return(t=(t=t.right.le()&&!t.left.le()?t.we():t).left.le()&&t.left.left.le()?t.fe():t).left.le()&&t.right.le()?t.Ee():t},Ws.prototype._e=function(){var t=this.Ee();return t.right.left.le()?(t=(t=t.copy(null,null,null,null,t.right.fe())).we()).Ee():t},Ws.prototype.de=function(){var t=this.Ee();return t.left.left.le()?(t=t.fe()).Ee():t},Ws.prototype.we=function(){var t=this.copy(null,null,Ws.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},Ws.prototype.fe=function(){var t=this.copy(null,null,Ws.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},Ws.prototype.Ee=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},Ws.prototype.Te=function(){var t=this.Ie();return Math.pow(2,t)<=this.size+1},Ws.prototype.Ie=function(){if(this.le()&&this.left.le())throw Dr();if(this.right.le())throw Dr();var t=this.left.Ie();if(t!==this.right.Ie())throw Dr();return t+(this.le()?0:1)},Ws);function Ws(t,e,n,r,i){this.key=t,this.value=e,this.color=null!=n?n:Ws.RED,this.left=null!=r?r:Ws.EMPTY,this.right=null!=i?i:Ws.EMPTY,this.size=this.left.size+1+this.right.size}function Js(t,e,n,r){this.ie=r,this.re=[];for(var i=1;!t.et();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.ie?t.left:t.right;else{if(0===i){this.re.push(t);break}this.re.push(t),t=this.ie?t.right:t.left}}function Zs(t,e){this.H=t,this.root=e||Xs.EMPTY}function $s(){this.size=0}Xs.EMPTY=null,Xs.RED=!0,Xs.Ht=!1,Xs.EMPTY=(Object.defineProperty($s.prototype,"key",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"value",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"color",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"left",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),Object.defineProperty($s.prototype,"right",{get:function(){throw Dr()},enumerable:!1,configurable:!0}),$s.prototype.copy=function(t,e,n,r,i){return this},$s.prototype.zt=function(t,e,n){return new Xs(t,e)},$s.prototype.remove=function(t,e){return this},$s.prototype.et=function(){return!0},$s.prototype.Xt=function(t){return!1},$s.prototype.Zt=function(t){return!1},$s.prototype.Jt=function(){return null},$s.prototype.Yt=function(){return null},$s.prototype.le=function(){return!1},$s.prototype.Te=function(){return!0},$s.prototype.Ie=function(){return 0},new $s);var tu=(iu.prototype.has=function(t){return null!==this.data.get(t)},iu.prototype.first=function(){return this.data.Jt()},iu.prototype.last=function(){return this.data.Yt()},Object.defineProperty(iu.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),iu.prototype.indexOf=function(t){return this.data.indexOf(t)},iu.prototype.forEach=function(t){this.data.Xt(function(e,n){return t(e),!1})},iu.prototype.me=function(t,e){for(var n=this.data.ee(t[0]);n.ce();){var r=n.oe();if(0<=this.H(r.key,t[1]))return;e(r.key)}},iu.prototype.Ae=function(t,e){for(var n=void 0!==e?this.data.ee(e):this.data.te();n.ce();)if(!t(n.oe().key))return},iu.prototype.Re=function(t){return(t=this.data.ee(t)).ce()?t.oe().key:null},iu.prototype.te=function(){return new eu(this.data.te())},iu.prototype.ee=function(t){return new eu(this.data.ee(t))},iu.prototype.add=function(t){return this.copy(this.data.remove(t).zt(t,!0))},iu.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},iu.prototype.et=function(){return this.data.et()},iu.prototype.Pe=function(t){var e=this;return e.size<t.size&&(e=t,t=this),t.forEach(function(t){e=e.add(t)}),e},iu.prototype.isEqual=function(t){if(!(t instanceof iu))return!1;if(this.size!==t.size)return!1;for(var e=this.data.te(),n=t.data.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(0!==this.H(r,i))return!1}return!0},iu.prototype.it=function(){var t=[];return this.forEach(function(e){t.push(e)}),t},iu.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},iu.prototype.copy=function(t){var e=new iu(this.H);return e.data=t,e},iu),eu=(ru.prototype.oe=function(){return this.ye.oe().key},ru.prototype.ce=function(){return this.ye.ce()},ru),nu=new Ys(ci.H);function ru(t){this.ye=t}function iu(t){this.H=t,this.data=new Ys(this.H)}var ou=new Ys(ci.H),su=new Ys(ci.H),uu=new tu(ci.H);function au(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=uu,r=0,i=t;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var cu=new tu(Cr),hu=(Au.pe=function(t){return new Au(t.H)},Au.prototype.has=function(t){return null!=this.ge.get(t)},Au.prototype.get=function(t){return this.ge.get(t)},Au.prototype.first=function(){return this.Ve.Jt()},Au.prototype.last=function(){return this.Ve.Yt()},Au.prototype.et=function(){return this.Ve.et()},Au.prototype.indexOf=function(t){return(t=this.ge.get(t))?this.Ve.indexOf(t):-1},Object.defineProperty(Au.prototype,"size",{get:function(){return this.Ve.size},enumerable:!1,configurable:!0}),Au.prototype.forEach=function(t){this.Ve.Xt(function(e,n){return t(e),!1})},Au.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.ge.zt(t.key,t),e.Ve.zt(t,null))},Au.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.ge.remove(t),this.Ve.remove(e)):this},Au.prototype.isEqual=function(t){if(!(t instanceof Au))return!1;if(this.size!==t.size)return!1;for(var e=this.Ve.te(),n=t.Ve.te();e.ce();){var r=e.oe().key,i=n.oe().key;if(!r.isEqual(i))return!1}return!0},Au.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},Au.prototype.copy=function(t,e){var n=new Au;return n.H=this.H,n.ge=t,n.Ve=e,n},Au),fu=(Nu.prototype.track=function(t){var e=t.doc.key,n=this.be.get(e);!n||0!==t.type&&3===n.type?this.be=this.be.zt(e,t):3===t.type&&1!==n.type?this.be=this.be.zt(e,{type:n.type,doc:t.doc}):2===t.type&&2===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):2===t.type&&0===n.type?this.be=this.be.zt(e,{type:0,doc:t.doc}):1===t.type&&0===n.type?this.be=this.be.remove(e):1===t.type&&2===n.type?this.be=this.be.zt(e,{type:1,doc:n.doc}):0===t.type&&1===n.type?this.be=this.be.zt(e,{type:2,doc:t.doc}):Dr()},Nu.prototype.ve=function(){var t=[];return this.be.Xt(function(e,n){t.push(n)}),t},Nu),lu=(Tu.Ne=function(t,e,n,r){var i=[];return e.forEach(function(t){i.push({type:0,doc:t})}),new Tu(t,e,hu.pe(e),i,n,r,!0,!1)},Object.defineProperty(Tu.prototype,"hasPendingWrites",{get:function(){return!this.De.et()},enumerable:!1,configurable:!0}),Tu.prototype.isEqual=function(t){if(!(this.fromCache===t.fromCache&&this.Ce===t.Ce&&this.De.isEqual(t.De)&&Ko(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.Se.isEqual(t.Se)))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},Tu),pu=(Iu.Me=function(t,e){var n=new Map;return n.set(t,du.Le(t,e)),new Iu(oi.min(),n,cu,nu,au())},Iu),du=(Eu.Le=function(t,e){return new Eu(Vr.T,e,au(),au(),au())},Eu),yu=function(t,e,n,r){this.Ke=t,this.removedTargetIds=e,this.key=n,this.We=r},vu=function(t,e){this.targetId=t,this.je=e},gu=function(t,e,n,r){void 0===n&&(n=Vr.T),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},mu=(Object.defineProperty(_u.prototype,"Be",{get:function(){return this.Je},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"resumeToken",{get:function(){return this.He},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"Xe",{get:function(){return 0!==this.Ge},enumerable:!1,configurable:!0}),Object.defineProperty(_u.prototype,"Ze",{get:function(){return this.Ye},enumerable:!1,configurable:!0}),_u.prototype.tn=function(t){0<t.l()&&(this.Ye=!0,this.He=t)},_u.prototype.en=function(){var t=au(),e=au(),n=au();return this.ze.forEach(function(r,i){switch(i){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:n=n.add(r);break;default:Dr()}}),new du(this.He,this.Je,t,e,n)},_u.prototype.nn=function(){this.Ye=!1,this.ze=xu()},_u.prototype.sn=function(t,e){this.Ye=!0,this.ze=this.ze.zt(t,e)},_u.prototype.rn=function(t){this.Ye=!0,this.ze=this.ze.remove(t)},_u.prototype.on=function(){this.Ge+=1},_u.prototype.cn=function(){--this.Ge},_u.prototype.an=function(){this.Ye=!0,this.Je=!0},_u),bu=(wu.prototype.dn=function(t){for(var e=0,n=t.Ke;e<n.length;e++){var r=n[e];t.We instanceof Xi?this.wn(r,t.We):t.We instanceof Wi&&this.En(r,t.key,t.We)}for(var i=0,o=t.removedTargetIds;i<o.length;i++)r=o[i],this.En(r,t.key,t.We)},wu.prototype.Tn=function(t){var e=this;this.In(t,function(n){var r=e.mn(n);switch(t.state){case 0:e.An(n)&&r.tn(t.resumeToken);break;case 1:r.cn(),r.Xe||r.nn(),r.tn(t.resumeToken);break;case 2:r.cn(),r.Xe||e.removeTarget(n);break;case 3:e.An(n)&&(r.an(),r.tn(t.resumeToken));break;case 4:e.An(n)&&(e.Rn(n),r.tn(t.resumeToken));break;default:Dr()}})},wu.prototype.In=function(t,e){var n=this;0<t.targetIds.length?t.targetIds.forEach(e):this.hn.forEach(function(t,r){n.An(r)&&e(r)})},wu.prototype.Pn=function(t){var e=t.targetId,n=t.je.count;(t=this.yn(e))&&(oo(t=t.target)?0===n?(t=new ci(t.path),this.En(e,t,new Wi(t,oi.min()))):Or(1===n):this.gn(e)!==n&&(this.Rn(e),this.fn=this.fn.add(e)))},wu.prototype.Vn=function(t){var e=this,n=new Map;this.hn.forEach(function(r,i){var o=e.yn(i);o&&(r.Be&&oo(o.target)&&(o=new ci(o.target.path),null!==e.ln.get(o)||e.pn(i,o)||e.En(i,o,new Wi(o,t))),r.Ze&&(n.set(i,r.en()),r.nn()))});var r=au();this._n.forEach(function(t,n){var i=!0;n.Ae(function(t){return!(t=e.yn(t))||2===t.Ft||(i=!1)}),i&&(r=r.add(t))});var i=new pu(t,n,this.fn,this.ln,r);return this.ln=nu,this._n=Su(),this.fn=new tu(Cr),i},wu.prototype.wn=function(t,e){var n;this.An(t)&&(n=this.pn(t,e.key)?2:0,this.mn(t).sn(e.key,n),this.ln=this.ln.zt(e.key,e),this._n=this._n.zt(e.key,this.bn(e.key).add(t)))},wu.prototype.En=function(t,e,n){var r;this.An(t)&&(r=this.mn(t),this.pn(t,e)?r.sn(e,1):r.rn(e),this._n=this._n.zt(e,this.bn(e).delete(t)),n&&(this.ln=this.ln.zt(e,n)))},wu.prototype.removeTarget=function(t){this.hn.delete(t)},wu.prototype.gn=function(t){var e=this.mn(t).en();return this.un.vn(t).size+e.qe.size-e.Qe.size},wu.prototype.on=function(t){this.mn(t).on()},wu.prototype.mn=function(t){var e=this.hn.get(t);return e||(e=new mu,this.hn.set(t,e)),e},wu.prototype.bn=function(t){var e=this._n.get(t);return e||(e=new tu(Cr),this._n=this._n.zt(t,e)),e},wu.prototype.An=function(t){var e=null!==this.yn(t);return e||Nr("WatchChangeAggregator","Detected inactive target",t),e},wu.prototype.yn=function(t){var e=this.hn.get(t);return e&&e.Xe?null:this.un.Sn(t)},wu.prototype.Rn=function(t){var e=this;this.hn.set(t,new mu),this.un.vn(t).forEach(function(n){e.En(t,n,null)})},wu.prototype.pn=function(t,e){return this.un.vn(t).has(e)},wu);function wu(t){this.un=t,this.hn=new Map,this.ln=nu,this._n=Su(),this.fn=new tu(Cr)}function _u(){this.Ge=0,this.ze=xu(),this.He=Vr.T,this.Je=!1,this.Ye=!0}function Eu(t,e,n,r,i){this.resumeToken=t,this.Be=e,this.qe=n,this.Ue=r,this.Qe=i}function Iu(t,e,n,r,i){this.Ot=t,this.$e=e,this.Fe=n,this.Oe=r,this.ke=i}function Tu(t,e,n,r,i,o,s,u){this.query=t,this.docs=e,this.Se=n,this.docChanges=r,this.De=i,this.fromCache=o,this.Ce=s,this.xe=u}function Nu(){this.be=new Ys(ci.H)}function Au(t){this.H=t?function(e,n){return t(e,n)||ci.H(e.key,n.key)}:function(t,e){return ci.H(t.key,e.key)},this.ge=ou,this.Ve=new Ys(this.H)}function Su(){return new Ys(ci.H)}function xu(){return new Ys(ci.H)}var Du={asc:"ASCENDING",desc:"DESCENDING"},Ou={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ku=function(t,e){this.t=t,this.Bt=e};function Pu(t,e){return t.Bt?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function Cu(t,e){return t.Bt?e.toBase64():e.toUint8Array()}function Lu(t){return Or(!!t),oi.K((t=Ei(t),new ii(t.seconds,t.nanos)))}function Ru(t,e){return new si(["projects",t.projectId,"databases",t.database]).child("documents").child(e).rt()}function Vu(t){return Or(ta(t=si.ot(t))),t}function Mu(t,e){return Ru(t.t,e.path)}function Uu(t,e){if((e=Vu(e)).get(1)!==t.t.projectId)throw new Fr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+t.t.projectId);if(e.get(3)!==t.t.database)throw new Fr(jr.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+t.t.database);return new ci(Bu(e))}function ju(t,e){return Ru(t.t,e)}function Fu(t){return 4===(t=Vu(t)).length?si.ct():Bu(t)}function qu(t){return new si(["projects",t.t.projectId,"databases",t.t.database]).rt()}function Bu(t){return Or(4<t.length&&"documents"===t.get(4)),t.Y(5)}function Gu(t,e,n){return{name:Mu(t,e),fields:n.proto.mapValue.fields}}function zu(t,e,n){var r=Uu(t,e.name);t=Lu(e.updateTime),e=new Bi({mapValue:{fields:e.fields}});return new Xi(r,t,e,{hasCommittedMutations:!!n})}function Hu(t,e){var n,r,i;if(e instanceof Os)n={update:Gu(t,e.key,e.value)};else if(e instanceof qs)n={delete:Mu(t,e.key)};else if(e instanceof ks)n={update:Gu(t,e.key,e.data),updateMask:(i=e.Gt,r=[],i.fields.forEach(function(t){return r.push(t.rt())}),{fieldPaths:r})};else{if(!(e instanceof Bs))return Dr();n={verify:Mu(t,e.key)}}return 0<e.fieldTransforms.length&&(n.updateTransforms=e.fieldTransforms.map(function(t){var e=t.transform;if(e instanceof us)return{fieldPath:t.field.rt(),setToServerValue:"REQUEST_TIME"};if(e instanceof as)return{fieldPath:t.field.rt(),appendMissingElements:{values:e.elements}};if(e instanceof ps)return{fieldPath:t.field.rt(),removeAllFromArray:{values:e.elements}};if(e instanceof gs)return{fieldPath:t.field.rt(),increment:e.Ut};throw Dr()})),e.jt.Wt||(n.currentDocument=void 0!==(i=e.jt).updateTime?{updateTime:(e=t,t=i.updateTime,Pu(e,t.j()))}:void 0!==i.exists?{exists:i.exists}:Dr()),n}function Qu(t,e){var n=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Es.updateTime(Lu(s.updateTime)):void 0!==s.exists?Es.exists(s.exists):Es.Kt():Es.Kt(),r=e.updateTransforms?e.updateTransforms.map(function(e){return function(t,e){var n,r=null;return"setToServerValue"in e?(Or("REQUEST_TIME"===e.setToServerValue),r=new us):"appendMissingElements"in e?(n=e.appendMissingElements.values||[],r=new as(n)):"removeAllFromArray"in e?(n=e.removeAllFromArray.values||[],r=new ps(n)):"increment"in e?r=new gs(t,e.increment):Dr(),e=ai.lt(e.fieldPath),new _s(e,r)}(t,e)}):[];if(e.update){e.update.name;var i=Uu(t,e.update.name),o=new Bi({mapValue:{fields:e.update.fields}});if(e.updateMask){var s=(s=e.updateMask.fieldPaths||[],new bi(s.map(function(t){return ai.lt(t)})));return new ks(i,o,s,n,r)}return new Os(i,o,n,r)}return e.delete?(r=Uu(t,e.delete),new qs(r,n)):e.verify?(e=Uu(t,e.verify),new Bs(e,n)):Dr()}function Yu(t,e){return{documents:[ju(t,e.path)]}}function Ku(t,e){var n={structuredQuery:{}},r=e.path;return null!==e.collectionGroup?(n.parent=ju(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=ju(t,r.X()),n.structuredQuery.from=[{collectionId:r.tt()}]),(r=function(t){if(0!==t.length)return 1===(t=t.map(function(t){if("=="===t.op){if(Fi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NAN"}};if(ji(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Fi(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NOT_NAN"}};if(ji(t.value))return{unaryFilter:{field:Zu(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zu(t.field),op:(e=t.op,Ou[e]),value:t.value}};var e})).length?t[0]:{compositeFilter:{op:"AND",filters:t}}}(e.filters))&&(n.structuredQuery.where=r),(r=function(t){if(0!==t.length)return t.map(function(t){return{field:Zu((t=t).field),direction:(t=t.dir,Du[t])}})}(e.orderBy))&&(n.structuredQuery.orderBy=r),r=e.limit,null!==(r=t.Bt||Si(r)?r:{value:r})&&(n.structuredQuery.limit=r),e.startAt&&(n.structuredQuery.startAt=Wu(e.startAt)),e.endAt&&(n.structuredQuery.endAt=Wu(e.endAt)),n}function Xu(t){var e=Fu(t.parent),n=t.structuredQuery,r=null;0<(s=n.from?n.from.length:0)&&(Or(1===s),(u=n.from[0]).allDescendants?r=u.collectionId:e=e.child(u.collectionId));var i=[];n.where&&(i=function t(e){return e?void 0!==e.unaryFilter?[function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=$u(t.unaryFilter.field);return uo.create(e,"==",{doubleValue:NaN});case"IS_NULL":return e=$u(t.unaryFilter.field),uo.create(e,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var n=$u(t.unaryFilter.field);return uo.create(n,"!=",{doubleValue:NaN});case"IS_NOT_NULL":return n=$u(t.unaryFilter.field),uo.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return Dr()}}(e)]:void 0!==e.fieldFilter?[function(t){return uo.create($u(t.fieldFilter.field),function(){switch(t.fieldFilter.op){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return Dr()}}(),t.fieldFilter.value)}(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map(function(e){return t(e)}).reduce(function(t,e){return t.concat(e)}):Dr():[]}(n.where));var o=[],s=(t=null,null),u=null;return Uo(e,r,o=n.orderBy?n.orderBy.map(function(t){return new Lo($u((e=t).field),function(){switch(e.direction){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}());var e}):o,i,t=n.limit?Si(i="object"==typeof(i=n.limit)?i.value:i)?null:i:t,"F",s=n.startAt?Ju(n.startAt):s,u=n.endAt?Ju(n.endAt):u)}function Wu(t){return{before:t.before,values:t.position}}function Ju(t){var e=!!t.before;t=t.values||[];return new xo(t,e)}function Zu(t){return{fieldPath:t.rt()}}function $u(t){return ai.lt(t.fieldPath)}function ta(t){return 4<=t.length&&"projects"===t.get(0)&&"databases"===t.get(2)}var ea,na=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},ra=(la.prototype.catch=function(t){return this.next(void 0,t)},la.prototype.next=function(t,e){var n=this;return this.Nn&&Dr(),this.Nn=!0,this.xn?this.error?this.$n(e,this.error):this.Fn(t,this.result):new la(function(r,i){n.Dn=function(e){n.Fn(t,e).next(r,i)},n.Cn=function(t){n.$n(e,t).next(r,i)}})},la.prototype.On=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},la.prototype.kn=function(t){try{var e=t();return e instanceof la?e:la.resolve(e)}catch(t){return la.reject(t)}},la.prototype.Fn=function(t,e){return t?this.kn(function(){return t(e)}):la.resolve(e)},la.prototype.$n=function(t,e){return t?this.kn(function(){return t(e)}):la.reject(e)},la.resolve=function(t){return new la(function(e,n){e(t)})},la.reject=function(t){return new la(function(e,n){n(t)})},la.Mn=function(t){return new la(function(e,n){var r=0,i=0,o=!1;t.forEach(function(t){++r,t.next(function(){++i,o&&i===r&&e()},function(t){return n(t)})}),o=!0,i===r&&e()})},la.Ln=function(t){for(var e=la.resolve(!1),n=0,r=t;n<r.length;n++)!function(t){e=e.next(function(e){return e?la.resolve(e):t()})}(r[n]);return e},la.forEach=function(t,e){var n=this,r=[];return t.forEach(function(t,i){r.push(e.call(n,t,i))}),this.Mn(r)},la),ia=(fa.open=function(t,e,n,r){try{return new fa(e,t.transaction(r,n))}catch(t){throw new ua(e,t)}},Object.defineProperty(fa.prototype,"qn",{get:function(){return this.Bn.promise},enumerable:!1,configurable:!0}),fa.prototype.abort=function(t){t&&this.Bn.reject(t),this.aborted||(Nr("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},fa.prototype.store=function(t){return t=this.transaction.objectStore(t),new da(t)},fa),oa=(ha.delete=function(t){return Nr("SimpleDb","Removing database:",t),va(window.indexedDB.deleteDatabase(t)).On()},ha.Kn=function(){if("undefined"==typeof indexedDB)return!1;if(ha.Wn())return!0;var t=y(),e=0<(n=ha.Qn(t))&&n<10,n=0<(n=ha.jn(t))&&n<4.5;return!(0<t.indexOf("MSIE ")||0<t.indexOf("Trident/")||0<t.indexOf("Edge/")||e||n)},ha.Wn=function(){var t;return"undefined"!=typeof process&&"YES"===(null===(t=process.env)||void 0===t?void 0:t.Gn)},ha.zn=function(t,e){return t.store(e)},ha.Qn=function(t){return t=(t=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i))?t[1].split("_").slice(0,2).join("."):"-1",Number(t)},ha.jn=function(t){return t=(t=t.match(/Android ([\d.]+)/i))?t[1].split(".").slice(0,2).join("."):"-1",Number(t)},ha.prototype.Hn=function(t){return l(this,void 0,void 0,function(){var e,n=this;return p(this,function(r){switch(r.label){case 0:return this.db?[3,2]:(Nr("SimpleDb","Opening database:",this.name),e=this,[4,new Promise(function(e,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(t){t=t.target.result,e(t)},i.onblocked=function(){r(new ua(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(e){"VersionError"===(e=e.target.error).name?r(new Fr(jr.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ua(t,e))},i.onupgradeneeded=function(t){Nr("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',t.oldVersion);var e=t.target.result;n.Un.Jn(e,i.transaction,t.oldVersion,n.version).next(function(){Nr("SimpleDb","Database upgrade to version "+n.version+" complete")})}})]);case 1:e.db=r.sent(),r.label=2;case 2:return[2,(this.Yn&&(this.db.onversionchange=function(t){return n.Yn(t)}),this.db)]}})})},ha.prototype.Xn=function(t){this.Yn=t,this.db&&(this.db.onversionchange=function(e){return t(e)})},ha.prototype.runTransaction=function(t,e,n,r){return l(this,void 0,void 0,function(){var i,o,s,u;return p(this,function(a){switch(a.label){case 0:i="readonly"===e,o=0,u=function(){var e,u,a;return p(this,function(c){switch(c.label){case 0:++o,c.label=1;case 1:return c.trys.push([1,4,,5]),[4,s.Hn(t)];case 2:return s.db=c.sent(),e=ia.open(s.db,t,i?"readonly":"readwrite",n),u=r(e).catch(function(t){return e.abort(t),ra.reject(t)}).On(),a={},u.catch(function(){}),[4,e.qn];case 3:return[2,(a.value=(c.sent(),u),a)];case 4:return u=c.sent(),a="FirebaseError"!==u.name&&o<3,Nr("SimpleDb","Transaction failed with error:",u.message,"Retrying:",a),s.close(),a?[3,5]:[2,{value:Promise.reject(u)}];case 5:return[2]}})},s=this,a.label=1;case 1:return[5,u()];case 2:if("object"==typeof(u=a.sent()))return[2,u.value];a.label=3;case 3:return[3,1];case 4:return[2]}})})},ha.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},ha),sa=(Object.defineProperty(ca.prototype,"xn",{get:function(){return this.ts},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"ns",{get:function(){return this.es},enumerable:!1,configurable:!0}),Object.defineProperty(ca.prototype,"cursor",{set:function(t){this.Zn=t},enumerable:!1,configurable:!0}),ca.prototype.done=function(){this.ts=!0},ca.prototype.ss=function(t){this.es=t},ca.prototype.delete=function(){return va(this.Zn.delete())},ca),ua=(f(aa,ea=Fr),aa);function aa(t,e){var n;return(n=ea.call(this,jr.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+e)||this).name="IndexedDbTransactionError",n}function ca(t){this.Zn=t,this.ts=!1,this.es=null}function ha(t,e,n){this.name=t,this.version=e,this.Un=n,12.2===ha.Qn(y())&&Ar("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}function fa(t,e){var n=this;this.action=t,this.transaction=e,this.aborted=!1,this.Bn=new na,this.transaction.oncomplete=function(){n.Bn.resolve()},this.transaction.onabort=function(){e.error?n.Bn.reject(new ua(t,e.error)):n.Bn.resolve()},this.transaction.onerror=function(e){e=ma(e.target.error),n.Bn.reject(new ua(t,e))}}function la(t){var e=this;this.Dn=null,this.Cn=null,this.result=void 0,this.error=void 0,this.xn=!1,this.Nn=!1,t(function(t){e.xn=!0,e.result=t,e.Dn&&e.Dn(t)},function(t){e.xn=!0,e.error=t,e.Cn&&e.Cn(t)})}function pa(t){return"IndexedDbTransactionError"===t.name}var da=(ya.prototype.put=function(t,e){return va(t=void 0!==e?(Nr("SimpleDb","PUT",this.store.name,t,e),this.store.put(e,t)):(Nr("SimpleDb","PUT",this.store.name,"<auto-key>",t),this.store.put(t)))},ya.prototype.add=function(t){return Nr("SimpleDb","ADD",this.store.name,t,t),va(this.store.add(t))},ya.prototype.get=function(t){var e=this;return va(this.store.get(t)).next(function(n){return void 0===n&&(n=null),Nr("SimpleDb","GET",e.store.name,t,n),n})},ya.prototype.delete=function(t){return Nr("SimpleDb","DELETE",this.store.name,t),va(this.store.delete(t))},ya.prototype.count=function(){return Nr("SimpleDb","COUNT",this.store.name),va(this.store.count())},ya.prototype.rs=function(t,e){e=this.cursor(this.options(t,e));var n=[];return this.os(e,function(t,e){n.push(e)}).next(function(){return n})},ya.prototype.cs=function(t,e){return Nr("SimpleDb","DELETE ALL",this.store.name),(e=this.options(t,e)).us=!1,e=this.cursor(e),this.os(e,function(t,e,n){return n.delete()})},ya.prototype.hs=function(t,e){e?n=t:(n={},e=t);var n=this.cursor(n);return this.os(n,e)},ya.prototype.ls=function(t){var e=this.cursor({});return new ra(function(n,r){e.onerror=function(t){t=ma(t.target.error),r(t)},e.onsuccess=function(e){var r=e.target.result;r?t(r.primaryKey,r.value).next(function(t){t?r.continue():n()}):n()}})},ya.prototype.os=function(t,e){var n=[];return new ra(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i,o=t.target.result;o?(i=new sa(o),(t=e(o.primaryKey,o.value,i))instanceof ra&&(t=t.catch(function(t){return i.done(),ra.reject(t)}),n.push(t)),i.xn?r():null===i.ns?o.continue():o.continue(i.ns)):r()}}).next(function(){return ra.Mn(n)})},ya.prototype.options=function(t,e){var n;return void 0!==t&&("string"==typeof t?n=t:e=t),{index:n,range:e}},ya.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.us?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},ya);function ya(t){this.store=t}function va(t){return new ra(function(e,n){t.onsuccess=function(t){t=t.target.result,e(t)},t.onerror=function(t){t=ma(t.target.error),n(t)}})}var ga=!1;function ma(t){var e=oa.Qn(y());if(12.2<=e&&e<13&&(e="An internal error was encountered in the Indexed Database server",0<=t.message.indexOf(e))){var n=new Fr("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+e+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return ga||(ga=!0,setTimeout(function(){throw n},0)),n}return t}var ba=(wa.Ts=function(t,e,n,r,i){return(i=new wa(t,e,Date.now()+n,r,i)).start(n),i},wa.prototype.start=function(t){var e=this;this.Is=setTimeout(function(){return e.As()},t)},wa.prototype.Rs=function(){return this.As()},wa.prototype.cancel=function(t){null!==this.Is&&(this.clearTimeout(),this.Es.reject(new Fr(jr.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},wa.prototype.As=function(){var t=this;this._s.Ps(function(){return null!==t.Is?(t.clearTimeout(),t.op().then(function(e){return t.Es.resolve(e)})):Promise.resolve()})},wa.prototype.clearTimeout=function(){null!==this.Is&&(this.ws(this),clearTimeout(this.Is),this.Is=null)},wa);function wa(t,e,n,r,i){this._s=t,this.fs=e,this.ds=n,this.op=r,this.ws=i,this.Es=new na,this.then=this.Es.promise.then.bind(this.Es.promise),this.Es.promise.catch(function(t){})}function _a(t,e){if(Ar("AsyncQueue",e+": "+t),pa(t))return new Fr(jr.UNAVAILABLE,e+": "+t);throw t}var Ea="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";Ia.prototype.gs=function(t){this.ys.push(t)},Ia.prototype.Vs=function(){this.ys.forEach(function(t){return t()})},a=Ia;function Ia(){this.ys=[]}function Ta(t){for(var e="",n=0;n<t.length;n++)0<e.length&&(e=Na(e)),e=function(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+="";break;case"":n+="";break;default:n+=o}}return n}(t.get(n),e);return Na(e)}function Na(t){return t+""}function Aa(t){var e=t.length;if(Or(2<=e),2===e)return Or(""===t.charAt(0)&&""===t.charAt(1)),si.ct();for(var n=e-2,r=[],i="",o=0;o<e;){var s=t.indexOf("",o);switch((s<0||n<s)&&Dr(),t.charAt(s+1)){case"":var u=t.substring(o,s),a=void 0;0===i.length?a=u:(a=i+=u,i=""),r.push(a);break;case"":i+=t.substring(o,s),i+="\0";break;case"":i+=t.substring(o,s+1);break;default:Dr()}o=s+2}return new si(r)}function Sa(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n}var xa=function(t,e){this.seconds=t,this.nanoseconds=e};function Da(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}function Oa(t,e,n,r,i){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i}Sa.store="owner",Sa.key="owner",Da.store="mutationQueues",Da.keyPath="userId",Oa.store="mutations",Oa.keyPath="batchId",Oa.userMutationsIndex="userMutationsIndex",Oa.userMutationsKeyPath=["userId","batchId"];var ka=(Pa.prefixForUser=function(t){return[t]},Pa.prefixForPath=function(t,e){return[t,Ta(e)]},Pa.key=function(t,e,n){return[t,Ta(e),n]},Pa);function Pa(){}ka.store="documentMutations",ka.PLACEHOLDER=new ka;var Ca=function(t,e,n,r,i,o){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};function La(t){this.byteSize=t}function Ra(t,e,n,r,i,o,s){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=s}Ca.store="remoteDocuments",Ca.readTimeIndex="readTimeIndex",Ca.readTimeIndexPath="readTime",Ca.collectionReadTimeIndex="collectionReadTimeIndex",Ca.collectionReadTimeIndexPath=["parentPath","readTime"],La.store="remoteDocumentGlobal",La.key="remoteDocumentGlobalKey",Ra.store="targets",Ra.keyPath="targetId",Ra.queryTargetsIndexName="queryTargetsIndex",Ra.queryTargetsKeyPath=["canonicalId","targetId"];var Va=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};function Ma(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}function Ua(t,e){this.collectionId=t,this.parent=e}function ja(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r}function Fa(t,e,n){this.bundleId=t,this.createTime=e,this.version=n}function qa(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n}Va.store="targetDocuments",Va.keyPath=["targetId","path"],Va.documentTargetsIndex="documentTargetsIndex",Va.documentTargetsKeyPath=["path","targetId"],Ma.key="targetGlobalKey",Ma.store="targetGlobal",Ua.store="collectionParents",Ua.keyPath=["collectionId","parent"],ja.store="clientMetadata",ja.keyPath="clientId",Fa.store="bundles",Fa.keyPath="bundleId",qa.store="namedQueries",qa.keyPath="name";var Ba,Ga=d(d(d(d([Da.store,Oa.store,ka.store,Ca.store,Ra.store,Sa.store,Ma.store,Va.store],[ja.store]),[La.store]),[Ua.store]),[Fa.store,qa.store]),za=(f(Ha,Ba=a),Ha);function Ha(t,e){var n=this;return(n=Ba.call(this)||this).ps=t,n.bs=e,n}function Qa(t,e){return oa.zn(t.ps,e)}var Ya=(Ja.prototype.Ss=function(t,e,n){for(var r,i,o,s,u,a,c=n.Ds,h=0;h<this.mutations.length;h++){var f=this.mutations[h];f.key.isEqual(t)&&(r=f,i=e,o=c[h],f=a=u=s=void 0,e=r instanceof Os?(u=o,a=(s=r).value,f=Rs(s.fieldTransforms,i,u.transformResults),a=Ms(s.fieldTransforms,a,f),new Xi(s.key,u.version,a,{hasCommittedMutations:!0})):r instanceof ks?function(t,e,n){return Ts(t.jt,e)?(e=Ls(t,e,Rs(t.fieldTransforms,e,n.transformResults)),new Xi(t.key,n.version,e,{hasCommittedMutations:!0})):new Ji(t.key,n.version)}(r,i,o):new Wi(r.key,o.version,{hasCommittedMutations:!0}))}return e},Ja.prototype.Cs=function(t,e){for(var n=0,r=this.baseMutations;n<r.length;n++)(i=r[n]).key.isEqual(t)&&(e=Ns(i,e,this.vs));for(var i,o=0,s=this.mutations;o<s.length;o++)(i=s[o]).key.isEqual(t)&&(e=Ns(i,e,this.vs));return e},Ja.prototype.xs=function(t){var e=this,n=t;return this.mutations.forEach(function(r){var i=e.Cs(r.key,t.get(r.key));i&&(n=n.zt(r.key,i))}),n},Ja.prototype.keys=function(){return this.mutations.reduce(function(t,e){return t.add(e.key)},au())},Ja.prototype.isEqual=function(t){return this.batchId===t.batchId&&Lr(this.mutations,t.mutations,As)&&Lr(this.baseMutations,t.baseMutations,As)},Ja),Ka=(Wa.from=function(t,e,n){Or(t.mutations.length===n.length);for(var r=su,i=t.mutations,o=0;o<i.length;o++)r=r.zt(i[o].key,n[o].version);return new Wa(t,e,n,r)},Wa),Xa=function(t){this.Fs=t};function Wa(t,e,n,r){this.batch=t,this.Ns=e,this.Ds=n,this.$s=r}function Ja(t,e,n,r){this.batchId=t,this.vs=e,this.baseMutations=n,this.mutations=r}function Za(t,e){if(e.document)return zu(t.Fs,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=ci.Et(e.noDocument.path),r=rc(e.noDocument.readTime);return new Wi(n,r,{hasCommittedMutations:!!e.hasCommittedMutations})}return e.unknownDocument?(n=ci.Et(e.unknownDocument.path),r=rc(e.unknownDocument.version),new Ji(n,r)):Dr()}function $a(t,e,n){var r=tc(n);n=e.key.path.X().it();if(e instanceof Xi){var i={name:Mu(o=t.Fs,(s=e).key),fields:s.bt().mapValue.fields,updateTime:Pu(o,s.version.j())},o=e.hasCommittedMutations;return new Ca(null,null,i,o,r,n)}if(e instanceof Wi){var s=e.key.path.it();i=nc(e.version),o=e.hasCommittedMutations;return new Ca(null,new function(t,e){this.path=t,this.readTime=e}(s,i),null,o,r,n)}return e instanceof Ji?(o=e.key.path.it(),e=nc(e.version),new Ca(new function(t,e){this.path=t,this.version=e}(o,e),null,null,!0,r,n)):Dr()}function tc(t){return[(t=t.j()).seconds,t.nanoseconds]}function ec(t){return t=new ii(t[0],t[1]),oi.K(t)}function nc(t){return t=t.j(),new xa(t.seconds,t.nanoseconds)}function rc(t){return t=new ii(t.seconds,t.nanoseconds),oi.K(t)}function ic(t,e){for(var n=(e.baseMutations||[]).map(function(e){return Qu(t.Fs,e)}),r=0;r<e.mutations.length-1;++r){var i,o=e.mutations[r];r+1<e.mutations.length&&void 0!==e.mutations[r+1].transform&&(i=e.mutations[r+1],o.updateTransforms=i.transform.fieldTransforms,e.mutations.splice(r+1,1),++r)}var s=e.mutations.map(function(e){return Qu(t.Fs,e)}),u=ii.fromMillis(e.localWriteTimeMs);return new Ya(e.batchId,u,n,s)}function oc(t){var e=rc(t.readTime),n=void 0!==t.lastLimboFreeSnapshotVersion?rc(t.lastLimboFreeSnapshotVersion):oi.min(),r=void 0!==t.query.documents?(Or(1===(r=t.query).documents.length),Qo(jo(Fu(r.documents[0])))):Qo(Xu(t.query));return new $o(r,t.targetId,0,t.lastListenSequenceNumber,e,n,Vr.fromBase64String(t.resumeToken))}function sc(t,e){var n=nc(e.Ot),r=nc(e.lastLimboFreeSnapshotVersion),i=(oo(e.target)?Yu:Ku)(t.Fs,e.target);t=e.resumeToken.toBase64();return new Ra(e.targetId,ro(e.target),n,t,e.sequenceNumber,r,i)}function uc(t){var e=Xu({parent:t.parent,structuredQuery:t.structuredQuery});return"LAST"===t.limitType?Yo(e,e.limit,"L"):e}var ac=(cc.prototype.Os=function(t,e){return hc(t).get(e).next(function(t){if(t)return{id:(t=t).bundleId,createTime:rc(t.createTime),version:t.version}})},cc.prototype.ks=function(t,e){return hc(t).put({bundleId:(e=e).id,createTime:nc(Lu(e.createTime)),version:e.version})},cc.prototype.Ms=function(t,e){return fc(t).get(e).next(function(t){if(t)return{name:(t=t).name,query:uc(t.bundledQuery),readTime:rc(t.readTime)}})},cc.prototype.Ls=function(t,e){return fc(t).put({name:(e=e).name,readTime:nc(Lu(e.readTime)),bundledQuery:e.bundledQuery})},cc);function cc(){}function hc(t){return Qa(t,Fa.store)}function fc(t){return Qa(t,qa.store)}var lc=(gc.prototype.qs=function(t,e){return this.Bs.add(e),ra.resolve()},gc.prototype.Us=function(t,e){return ra.resolve(this.Bs.getEntries(e))},gc),pc=(vc.prototype.add=function(t){var e=t.tt(),n=t.X(),r=this.index[e]||new tu(si.H);t=!r.has(n);return this.index[e]=r.add(n),t},vc.prototype.has=function(t){var e=t.tt();t=t.X();return(e=this.index[e])&&e.has(t)},vc.prototype.getEntries=function(t){return(this.index[t]||new tu(si.H)).it()},vc),dc=(yc.prototype.qs=function(t,e){var n=this;if(this.Qs.has(e))return ra.resolve();var r=e.tt(),i=e.X();return t.gs(function(){n.Qs.add(e)}),i={collectionId:r,parent:Ta(i)},mc(t).put(i)},yc.prototype.Us=function(t,e){var n=[],r=IDBKeyRange.bound([e,""],[Rr(e),""],!1,!0);return mc(t).rs(r).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];if(o.collectionId!==e)break;n.push(Aa(o.parent))}return n})},yc);function yc(){this.Qs=new pc}function vc(){this.index={}}function gc(){this.Bs=new pc}function mc(t){return Qa(t,Ua.store)}var bc={Ks:!1,Ws:0,js:0,Gs:0},wc=(_c.Ys=function(t){return new _c(t,_c.Xs,_c.Zs)},_c);function _c(t,e,n){this.zs=t,this.Hs=e,this.Js=n}function Ec(t){return l(this,void 0,void 0,function(){return p(this,function(e){if(t.code!==jr.FAILED_PRECONDITION||t.message!==Ea)throw t;return Nr("LocalStore","Unexpectedly lost primary lease"),[2]})})}wc.Xs=10,wc.Zs=1e3,wc.ti=new wc(41943040,wc.Xs,wc.Zs),wc.ei=new wc(-1,0,0);var Ic=(Nc.prototype.get=function(t){var e=this.ni(t);if(void 0!==(e=this.ii[e]))for(var n=0,r=e;n<r.length;n++){var i=(o=r[n])[0],o=o[1];if(this.si(i,t))return o}},Nc.prototype.has=function(t){return void 0!==this.get(t)},Nc.prototype.set=function(t,e){var n=this.ni(t),r=this.ii[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.si(r[i][0],t))return void(r[i]=[t,e]);r.push([t,e])}else this.ii[n]=[[t,e]]},Nc.prototype.delete=function(t){var e=this.ni(t),n=this.ii[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.si(n[r][0],t))return 1===n.length?delete this.ii[e]:n.splice(r,1),!0;return!1},Nc.prototype.forEach=function(t){gi(this.ii,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=(s=i[r])[0],s=s[1];t(o,s)}})},Nc.prototype.et=function(){return mi(this.ii)},Nc);Tc.prototype.ci=function(t){return(t=this.ri.get(t))?t.readTime:oi.min()},Tc.prototype.ai=function(t,e){this.ui(),this.ri.set(t.key,{hi:t,readTime:e})},Tc.prototype.li=function(t,e){void 0===e&&(e=null),this.ui(),this.ri.set(t,{hi:null,readTime:e})},Tc.prototype._i=function(t,e){this.ui();var n=this.ri.get(e);return void 0!==n?ra.resolve(n.hi):this.fi(t,e)},Tc.prototype.getEntries=function(t,e){return this.di(t,e)},Tc.prototype.apply=function(t){return this.ui(),this.oi=!0,this.wi(t)},Tc.prototype.ui=function(){},_e=Tc;function Tc(){this.ri=new Ic(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),this.oi=!1}function Nc(t,e){this.ni=t,this.si=e,this.ii={}}function Ac(t,e,n){var r=t.store(Oa.store),i=t.store(ka.store),o=[],s=(t=IDBKeyRange.only(n.batchId),0);t=r.hs({range:t},function(t,e,n){return s++,n.delete()});o.push(t.next(function(){Or(1===s)}));for(var u=[],a=0,c=n.mutations;a<c.length;a++){var h=c[a],f=ka.key(e,h.key.path,n.batchId);o.push(i.delete(f)),u.push(h.key)}return ra.Mn(o).next(function(){return u})}function Sc(t){var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw Dr();e=t.noDocument}return JSON.stringify(e).length}var xc=(Dc.mi=function(t,e,n,r){return Or(""!==t.uid),new Dc(t.m()?t.uid:"",e,n,r)},Dc.prototype.Ai=function(t){var e=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kc(t).hs({index:Oa.userMutationsIndex,range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},Dc.prototype.Ri=function(t,e,n,r){var i=this,o=Pc(t),s=kc(t);return s.add({}).next(function(u){Or("number"==typeof u);for(var a,c,h,f,l,p=new Ya(u,e,n,r),d=(a=i.Qt,c=i.userId,f=(h=p).baseMutations.map(function(t){return Hu(a.Fs,t)}),l=h.mutations.map(function(t){return Hu(a.Fs,t)}),new Oa(c,h.batchId,h.vs.toMillis(),f,l)),y=[],v=new tu(function(t,e){return Cr(t.rt(),e.rt())}),g=0,m=r;g<m.length;g++){var b=m[g],w=ka.key(i.userId,b.key.path,u);v=v.add(b.key.path.X());y.push(s.put(d)),y.push(o.put(w,ka.PLACEHOLDER))}return v.forEach(function(e){y.push(i.Ei.qs(t,e))}),t.gs(function(){i.Ii[u]=p.keys()}),ra.Mn(y).next(function(){return p})})},Dc.prototype.Pi=function(t,e){var n=this;return kc(t).get(e).next(function(t){return t?(Or(t.userId===n.userId),ic(n.Qt,t)):null})},Dc.prototype.yi=function(t,e){var n=this;return this.Ii[e]?ra.resolve(this.Ii[e]):this.Pi(t,e).next(function(t){return t?(t=t.keys(),n.Ii[e]=t):null})},Dc.prototype.gi=function(t,e){var n=this,r=e+1,i=(e=IDBKeyRange.lowerBound([this.userId,r]),null);return kc(t).hs({index:Oa.userMutationsIndex,range:e},function(t,e,o){e.userId===n.userId&&(Or(e.batchId>=r),i=ic(n.Qt,e)),o.done()}).next(function(){return i})},Dc.prototype.Vi=function(t){var e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return kc(t).hs({index:Oa.userMutationsIndex,range:e,reverse:!0},function(t,e,r){n=e.batchId,r.done()}).next(function(){return n})},Dc.prototype.pi=function(t){var e=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return kc(t).rs(Oa.userMutationsIndex,n).next(function(t){return t.map(function(t){return ic(e.Qt,t)})})},Dc.prototype.bi=function(t,e){var n=this,r=ka.prefixForPath(this.userId,e.path),i=(r=IDBKeyRange.lowerBound(r),[]);return Pc(t).hs({range:r},function(r,o,s){var u=r[0],a=r[1];r=r[2],a=Aa(a);if(u===n.userId&&e.path.isEqual(a))return kc(t).get(r).next(function(t){if(!t)throw Dr();Or(t.userId===n.userId),i.push(ic(n.Qt,t))});s.done()}).next(function(){return i})},Dc.prototype.vi=function(t,e){var n=this,r=new tu(Cr),i=[];return e.forEach(function(e){var o=ka.prefixForPath(n.userId,e.path);o=IDBKeyRange.lowerBound(o),o=Pc(t).hs({range:o},function(t,i,o){var s=t[0],u=t[1];t=t[2],u=Aa(u);s===n.userId&&e.path.isEqual(u)?r=r.add(t):o.done()});i.push(o)}),ra.Mn(i).next(function(){return n.Si(t,r)})},Dc.prototype.Di=function(t,e){var n=this,r=e.path,i=r.length+1,o=(e=ka.prefixForPath(this.userId,r),e=IDBKeyRange.lowerBound(e),new tu(Cr));return Pc(t).hs({range:e},function(t,e,s){var u=t[0],a=t[1];t=t[2],a=Aa(a);u===n.userId&&r.nt(a)?a.length===i&&(o=o.add(t)):s.done()}).next(function(){return n.Si(t,o)})},Dc.prototype.Si=function(t,e){var n=this,r=[],i=[];return e.forEach(function(e){i.push(kc(t).get(e).next(function(t){if(null===t)throw Dr();Or(t.userId===n.userId),r.push(ic(n.Qt,t))}))}),ra.Mn(i).next(function(){return r})},Dc.prototype.Ci=function(t,e){var n=this;return Ac(t.ps,this.userId,e).next(function(r){return t.gs(function(){n.xi(e.batchId)}),ra.forEach(r,function(e){return n.Ti.Ni(t,e)})})},Dc.prototype.xi=function(t){delete this.Ii[t]},Dc.prototype.$i=function(t){var e=this;return this.Ai(t).next(function(n){if(!n)return ra.resolve();n=IDBKeyRange.lowerBound(ka.prefixForUser(e.userId));var r=[];return Pc(t).hs({range:n},function(t,n,i){t[0]===e.userId?(t=Aa(t[1]),r.push(t)):i.done()}).next(function(){Or(0===r.length)})})},Dc.prototype.Fi=function(t,e){return Oc(t,this.userId,e)},Dc.prototype.Oi=function(t){var e=this;return Cc(t).get(this.userId).next(function(t){return t||new Da(e.userId,-1,"")})},Dc);function Dc(t,e,n,r){this.userId=t,this.Qt=e,this.Ei=n,this.Ti=r,this.Ii={}}function Oc(t,e,n){var r=(n=ka.prefixForPath(e,n.path))[1],i=(n=IDBKeyRange.lowerBound(n),!1);return Pc(t).hs({range:n,us:!0},function(t,n,o){var s=t[0],u=t[1];t[2],s===e&&u===r&&(i=!0),o.done()}).next(function(){return i})}function kc(t){return Qa(t,Oa.store)}function Pc(t){return Qa(t,ka.store)}function Cc(t){return Qa(t,Da.store)}var Lc=(Mc.prototype.next=function(){return this.ki+=2,this.ki},Mc.Mi=function(){return new Mc(0)},Mc.Li=function(){return new Mc(-1)},Mc),Rc=(Vc.prototype.Bi=function(t){var e=this;return this.qi(t).next(function(n){var r=new Lc(n.highestTargetId);return n.highestTargetId=r.next(),e.Ui(t,n).next(function(){return n.highestTargetId})})},Vc.prototype.Qi=function(t){return this.qi(t).next(function(t){return oi.K(new ii(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))})},Vc.prototype.Ki=function(t){return this.qi(t).next(function(t){return t.highestListenSequenceNumber})},Vc.prototype.Wi=function(t,e,n){var r=this;return this.qi(t).next(function(i){return i.highestListenSequenceNumber=e,n&&(i.lastRemoteSnapshotVersion=n.j()),e>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=e),r.Ui(t,i)})},Vc.prototype.ji=function(t,e){var n=this;return this.Gi(t,e).next(function(){return n.qi(t).next(function(r){return r.targetCount+=1,n.zi(e,r),n.Ui(t,r)})})},Vc.prototype.Hi=function(t,e){return this.Gi(t,e)},Vc.prototype.Ji=function(t,e){var n=this;return this.Yi(t,e.targetId).next(function(){return Uc(t).delete(e.targetId)}).next(function(){return n.qi(t)}).next(function(e){return Or(0<e.targetCount),--e.targetCount,n.Ui(t,e)})},Vc.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return Uc(t).hs(function(s,u){(u=oc(u)).sequenceNumber<=e&&null===n.get(u.targetId)&&(i++,o.push(r.Ji(t,u)))}).next(function(){return ra.Mn(o)}).next(function(){return i})},Vc.prototype.In=function(t,e){return Uc(t).hs(function(t,n){n=oc(n),e(n)})},Vc.prototype.qi=function(t){return jc(t).get(Ma.key).next(function(t){return Or(null!==t),t})},Vc.prototype.Ui=function(t,e){return jc(t).put(Ma.key,e)},Vc.prototype.Gi=function(t,e){return Uc(t).put(sc(this.Qt,e))},Vc.prototype.zi=function(t,e){var n=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,n=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,n=!0),n},Vc.prototype.Zi=function(t){return this.qi(t).next(function(t){return t.targetCount})},Vc.prototype.tr=function(t,e){var n=ro(e),r=(n=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),null);return Uc(t).hs({range:n,index:Ra.queryTargetsIndexName},function(t,n,i){n=oc(n),io(e,n.target)&&(r=n,i.done())}).next(function(){return r})},Vc.prototype.er=function(t,e,n){var r=this,i=[],o=Fc(t);return e.forEach(function(e){var s=Ta(e.path);i.push(o.put(new Va(n,s))),i.push(r.Ti.nr(t,n,e))}),ra.Mn(i)},Vc.prototype.sr=function(t,e,n){var r=this,i=Fc(t);return ra.forEach(e,function(e){var o=Ta(e.path);return ra.Mn([i.delete([n,o]),r.Ti.ir(t,n,e)])})},Vc.prototype.Yi=function(t,e){return t=Fc(t),e=IDBKeyRange.bound([e],[e+1],!1,!0),t.delete(e)},Vc.prototype.rr=function(t,e){e=IDBKeyRange.bound([e],[e+1],!1,!0),t=Fc(t);var n=au();return t.hs({range:e,us:!0},function(t,e,r){t=Aa(t[1]),t=new ci(t),n=n.add(t)}).next(function(){return n})},Vc.prototype.Fi=function(t,e){e=Ta(e.path),e=IDBKeyRange.bound([e],[Rr(e)],!1,!0);var n=0;return Fc(t).hs({index:Va.documentTargetsIndex,us:!0,range:e},function(t,e,r){var i=t[0];t[1],0!==i&&(n++,r.done())}).next(function(){return 0<n})},Vc.prototype.Sn=function(t,e){return Uc(t).get(e).next(function(t){return t?oc(t):null})},Vc);function Vc(t,e){this.Ti=t,this.Qt=e}function Mc(t){this.ki=t}function Uc(t){return Qa(t,Ra.store)}function jc(t){return Qa(t,Ma.store)}function Fc(t){return Qa(t,Va.store)}function qc(t,e){var n=t[0],r=t[1];t=e[0],e=e[1];return 0===(t=Cr(n,t))?Cr(r,e):t}var Bc=(Xc.prototype.ur=function(){return++this.ar},Xc.prototype.hr=function(t){var e=[t,this.ur()];this.buffer.size<this.cr?this.buffer=this.buffer.add(e):qc(e,t=this.buffer.last())<0&&(this.buffer=this.buffer.delete(t).add(e))},Object.defineProperty(Xc.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),Xc),Gc=(Kc.prototype.start=function(t){-1!==this.lr.params.zs&&this.wr(t)},Kc.prototype.stop=function(){this.dr&&(this.dr.cancel(),this.dr=null)},Object.defineProperty(Kc.prototype,"Er",{get:function(){return null!==this.dr},enumerable:!1,configurable:!0}),Kc.prototype.wr=function(t){var e=this,n=this._r?3e5:6e4;Nr("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.dr=this._s.Tr("lru_garbage_collection",n,function(){return l(e,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:this.dr=null,this._r=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,t.Ir(this.lr)];case 2:return n.sent(),[3,7];case 3:return pa(e=n.sent())?(Nr("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e),[3,6]):[3,4];case 4:return[4,Ec(e)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.wr(t)];case 8:return n.sent(),[2]}})})})},Kc),zc=(Yc.prototype.Ar=function(t,e){return this.mr.Rr(t).next(function(t){return Math.floor(e/100*t)})},Yc.prototype.Pr=function(t,e){var n=this;if(0===e)return ra.resolve(Wr.q);var r=new Bc(e);return this.mr.In(t,function(t){return r.hr(t.sequenceNumber)}).next(function(){return n.mr.yr(t,function(t){return r.hr(t)})}).next(function(){return r.maxValue})},Yc.prototype.Xi=function(t,e,n){return this.mr.Xi(t,e,n)},Yc.prototype.gr=function(t,e){return this.mr.gr(t,e)},Yc.prototype.Vr=function(t,e){var n=this;return-1===this.params.zs?(Nr("LruGarbageCollector","Garbage collection skipped; disabled"),ra.resolve(bc)):this.pr(t).next(function(r){return r<n.params.zs?(Nr("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.zs),bc):n.br(t,e)})},Yc.prototype.pr=function(t){return this.mr.pr(t)},Yc.prototype.br=function(t,n){var r,i,o,s,u,a,c,h=this,f=Date.now();return this.Ar(t,this.params.Hs).next(function(e){return i=e>h.params.Js?(Nr("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+h.params.Js+" from "+e),h.params.Js):e,s=Date.now(),h.Pr(t,i)}).next(function(e){return r=e,u=Date.now(),h.Xi(t,r,n)}).next(function(e){return o=e,a=Date.now(),h.gr(t,r)}).next(function(t){return c=Date.now(),Tr()<=e.DEBUG&&Nr("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(s-f)+"ms\n\tDetermined least recently used "+i+" in "+(u-s)+"ms\n\tRemoved "+o+" targets in "+(a-u)+"ms\n\tRemoved "+t+" documents in "+(c-a)+"ms\nTotal Duration: "+(c-f)+"ms"),ra.resolve({Ks:!0,Ws:i,js:o,Gs:t})})},Yc),Hc=(Qc.prototype.Rr=function(t){var e=this.vr(t);return this.db.Sr().Zi(t).next(function(t){return e.next(function(e){return t+e})})},Qc.prototype.vr=function(t){var e=0;return this.yr(t,function(t){e++}).next(function(){return e})},Qc.prototype.In=function(t,e){return this.db.Sr().In(t,e)},Qc.prototype.yr=function(t,e){return this.Dr(t,function(t,n){return e(n)})},Qc.prototype.nr=function(t,e,n){return Wc(t,n)},Qc.prototype.ir=function(t,e,n){return Wc(t,n)},Qc.prototype.Xi=function(t,e,n){return this.db.Sr().Xi(t,e,n)},Qc.prototype.Ni=Wc,Qc.prototype.Cr=function(t,e){return r=e,i=!1,Cc(n=t).ls(function(t){return Oc(n,t,r).next(function(t){return t&&(i=!0),ra.resolve(!t)})}).next(function(){return i});var n,r,i},Qc.prototype.gr=function(t,e){var n=this,r=this.db.$r().Nr(),i=[],o=0;return this.Dr(t,function(s,u){u<=e&&(u=n.Cr(t,s).next(function(e){if(!e)return o++,r._i(t,s).next(function(){return r.li(s),Fc(t).delete([0,Ta(s.path)])})}),i.push(u))}).next(function(){return ra.Mn(i)}).next(function(){return r.apply(t)}).next(function(){return o})},Qc.prototype.removeTarget=function(t,e){return e=e.kt(t.bs),this.db.Sr().Hi(t,e)},Qc.prototype.Fr=Wc,Qc.prototype.Dr=function(t,e){t=Fc(t);var n,r=Wr.q;return t.hs({index:Va.documentTargetsIndex},function(t,i){var o=t[0];t[1],t=i.path,i=i.sequenceNumber;0===o?(r!==Wr.q&&e(new ci(Aa(n)),r),r=i,n=t):r=Wr.q}).next(function(){r!==Wr.q&&e(new ci(Aa(n)),r)})},Qc.prototype.pr=function(t){return this.db.$r().Or(t)},Qc);function Qc(t,e){this.db=t,this.lr=new zc(this,e)}function Yc(t,e){this.mr=t,this.params=e}function Kc(t,e){this.lr=t,this._s=e,this._r=!1,this.dr=null}function Xc(t){this.cr=t,this.buffer=new tu(qc),this.ar=0}function Wc(t,e){return Fc(t).put((t=t.bs,new Va(0,Ta(e.path),t)))}var Jc,Zc=(eh.prototype.ai=function(t,e,n){return rh(t).put(ih(e),n)},eh.prototype.li=function(t,e){return t=rh(t),e=ih(e),t.delete(e)},eh.prototype.updateMetadata=function(t,e){var n=this;return this.getMetadata(t).next(function(r){return r.byteSize+=e,n.kr(t,r)})},eh.prototype._i=function(t,e){var n=this;return rh(t).get(ih(e)).next(function(t){return n.Mr(t)})},eh.prototype.Lr=function(t,e){var n=this;return rh(t).get(ih(e)).next(function(t){var e=n.Mr(t);return e?{hi:e,size:Sc(t)}:null})},eh.prototype.getEntries=function(t,e){var n=this,r=nu;return this.Br(t,e,function(t,e){e=n.Mr(e),r=r.zt(t,e)}).next(function(){return r})},eh.prototype.qr=function(t,e){var n=this,r=nu,i=new Ys(ci.H);return this.Br(t,e,function(t,e){var o=n.Mr(e);i=o?(r=r.zt(t,o),i.zt(t,Sc(e))):(r=r.zt(t,null),i.zt(t,0))}).next(function(){return{Ur:r,Qr:i}})},eh.prototype.Br=function(t,e,n){if(e.et())return ra.resolve();var r=IDBKeyRange.bound(e.first().path.it(),e.last().path.it()),i=e.te(),o=i.oe();return rh(t).hs({range:r},function(t,e,r){for(var s=ci.Et(t);o&&ci.H(o,s)<0;)n(o,null),o=i.oe();o&&o.isEqual(s)&&(n(o,e),o=i.ce()?i.oe():null),o?r.ss(o.path.it()):r.done()}).next(function(){for(;o;)n(o,null),o=i.ce()?i.oe():null})},eh.prototype.Kr=function(t,e,n){var r,i=this,o=ou,s=e.path.length+1,u={};return n.isEqual(oi.min())?(r=e.path.it(),u.range=IDBKeyRange.lowerBound(r)):(r=e.path.it(),n=tc(n),u.range=IDBKeyRange.lowerBound([r,n],!0),u.index=Ca.collectionReadTimeIndex),rh(t).hs(u,function(t,n,r){t.length===s&&(n=Za(i.Qt,n),e.path.nt(n.key.path)?n instanceof Xi&&Jo(e,n)&&(o=o.zt(n.key,n)):r.done())}).next(function(){return o})},eh.prototype.Nr=function(t){return new $c(this,!!t&&t.Wr)},eh.prototype.Or=function(t){return this.getMetadata(t).next(function(t){return t.byteSize})},eh.prototype.getMetadata=function(t){return nh(t).get(La.key).next(function(t){return Or(!!t),t})},eh.prototype.kr=function(t,e){return nh(t).put(La.key,e)},eh.prototype.Mr=function(t){return t?(t=Za(this.Qt,t))instanceof Wi&&t.version.isEqual(oi.min())?null:t:null},eh),$c=(f(th,Jc=_e),th.prototype.wi=function(t){var e=this,n=[],r=0,i=new tu(function(t,e){return Cr(t.rt(),e.rt())});return this.ri.forEach(function(o,s){var u,a=e.Gr.get(o);s.hi?(u=$a(e.jr.Qt,s.hi,e.ci(o)),i=i.add(o.path.X()),s=Sc(u),r+=s-a,n.push(e.jr.ai(t,o,u))):(r-=a,e.Wr?(a=$a(e.jr.Qt,new Wi(o,oi.min()),e.ci(o)),n.push(e.jr.ai(t,o,a))):n.push(e.jr.li(t,o)))}),i.forEach(function(r){n.push(e.jr.Ei.qs(t,r))}),n.push(this.jr.updateMetadata(t,r)),ra.Mn(n)},th.prototype.fi=function(t,e){var n=this;return this.jr.Lr(t,e).next(function(t){return null===t?(n.Gr.set(e,0),null):(n.Gr.set(e,t.size),t.hi)})},th.prototype.di=function(t,e){var n=this;return this.jr.qr(t,e).next(function(t){var e=t.Ur;return t.Qr.forEach(function(t,e){n.Gr.set(t,e)}),e})},th);function th(t,e){var n=this;return(n=Jc.call(this)||this).jr=t,n.Wr=e,n.Gr=new Ic(function(t){return t.toString()},function(t,e){return t.isEqual(e)}),n}function eh(t,e){this.Qt=t,this.Ei=e}function nh(t){return Qa(t,La.store)}function rh(t){return Qa(t,Ca.store)}function ih(t){return t.path.it()}var oh=(sh.prototype.Jn=function(t,e,n,r){var i=this;Or(n<r&&0<=n&&r<=11);var o=new ia("createOrUpgrade",e);n<1&&1<=r&&(t.createObjectStore(Sa.store),(s=t).createObjectStore(Da.store,{keyPath:Da.keyPath}),s.createObjectStore(Oa.store,{keyPath:Oa.keyPath,autoIncrement:!0}).createIndex(Oa.userMutationsIndex,Oa.userMutationsKeyPath,{unique:!0}),s.createObjectStore(ka.store),uh(t),t.createObjectStore(Ca.store));var s,u=ra.resolve();return n<3&&3<=r&&(0!==n&&((s=t).deleteObjectStore(Va.store),s.deleteObjectStore(Ra.store),s.deleteObjectStore(Ma.store),uh(t)),u=u.next(function(){return t=o.store(Ma.store),e=new Ma(0,0,oi.min().j(),0),t.put(Ma.key,e);var t,e})),n<4&&4<=r&&(u=(u=0!==n?u.next(function(){return e=t,(n=o).store(Oa.store).rs().next(function(t){e.deleteObjectStore(Oa.store),e.createObjectStore(Oa.store,{keyPath:Oa.keyPath,autoIncrement:!0}).createIndex(Oa.userMutationsIndex,Oa.userMutationsKeyPath,{unique:!0});var r=n.store(Oa.store);t=t.map(function(t){return r.put(t)});return ra.Mn(t)});var e,n}):u).next(function(){t.createObjectStore(ja.store,{keyPath:ja.keyPath})})),n<5&&5<=r&&(u=u.next(function(){return i.zr(o)})),n<6&&6<=r&&(u=u.next(function(){return t.createObjectStore(La.store),i.Hr(o)})),n<7&&7<=r&&(u=u.next(function(){return i.Jr(o)})),n<8&&8<=r&&(u=u.next(function(){return i.Yr(t,o)})),n<9&&9<=r&&(u=u.next(function(){var n;(n=t).objectStoreNames.contains("remoteDocumentChanges")&&n.deleteObjectStore("remoteDocumentChanges"),(n=e.objectStore(Ca.store)).createIndex(Ca.readTimeIndex,Ca.readTimeIndexPath,{unique:!1}),n.createIndex(Ca.collectionReadTimeIndex,Ca.collectionReadTimeIndexPath,{unique:!1})})),n<10&&10<=r&&(u=u.next(function(){return i.Xr(o)})),n<11&&11<=r?u.next(function(){t.createObjectStore(Fa.store,{keyPath:Fa.keyPath}),t.createObjectStore(qa.store,{keyPath:qa.keyPath})}):u},sh.prototype.Hr=function(t){var e=0;return t.store(Ca.store).hs(function(t,n){e+=Sc(n)}).next(function(){var n=new La(e);return t.store(La.store).put(La.key,n)})},sh.prototype.zr=function(t){var e=this,n=t.store(Da.store),r=t.store(Oa.store);return n.rs().next(function(n){return ra.forEach(n,function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.rs(Oa.userMutationsIndex,i).next(function(r){return ra.forEach(r,function(r){return Or(r.userId===n.userId),r=ic(e.Qt,r),Ac(t,n.userId,r).next(function(){})})})})})},sh.prototype.Jr=function(t){var e=t.store(Va.store),n=t.store(Ca.store);return t.store(Ma.store).get(Ma.key).next(function(t){var r=[];return n.hs(function(n,i){var o=new si(n);n=[0,Ta(o)];r.push(e.get(n).next(function(n){return n?ra.resolve():e.put(new Va(0,Ta(o),t.highestListenSequenceNumber))}))}).next(function(){return ra.Mn(r)})})},sh.prototype.Yr=function(t,e){function n(t){if(i.add(t)){var e=t.tt();t=t.X();return r.put({collectionId:e,parent:Ta(t)})}}t.createObjectStore(Ua.store,{keyPath:Ua.keyPath});var r=e.store(Ua.store),i=new pc;return e.store(Ca.store).hs({us:!0},function(t,e){return n((t=new si(t)).X())}).next(function(){return e.store(ka.store).hs({us:!0},function(t,e){t[0];var r=t[1];return n((r=(t[2],Aa(r))).X())})})},sh.prototype.Xr=function(t){var e=this,n=t.store(Ra.store);return n.hs(function(t,r){return r=oc(r),r=sc(e.Qt,r),n.put(r)})},sh);function sh(t){this.Qt=t}function uh(t){t.createObjectStore(Va.store,{keyPath:Va.keyPath}).createIndex(Va.documentTargetsIndex,Va.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Ra.store,{keyPath:Ra.keyPath}).createIndex(Ra.queryTargetsIndexName,Ra.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Ma.store)}var ah="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",ch=(hh.prototype.start=function(){var t=this;return this.To().then(function(){if(!t.isPrimary&&!t.allowTabSynchronization)throw new Fr(jr.FAILED_PRECONDITION,ah);return t.Io(),t.mo(),t.Ao(),t.runTransaction("getHighestListenSequenceNumber","readonly",function(e){return t._o.Ki(e)})}).then(function(e){t.so=new Wr(e,t.eo)}).then(function(){t.io=!0}).catch(function(e){return t.lo&&t.lo.close(),Promise.reject(e)})},hh.prototype.Ro=function(t){var e=this;return this.uo=function(n){return l(e,void 0,void 0,function(){return p(this,function(e){return this.Er?[2,t(n)]:[2]})})},t(this.isPrimary)},hh.prototype.Po=function(t){var e=this;this.lo.Xn(function(n){return l(e,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return null===n.newVersion?[4,t()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})})},hh.prototype.yo=function(t){var e=this;this.networkEnabled!==t&&(this.networkEnabled=t,this.Zr.Ps(function(){return l(e,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.Er?[4,this.To()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})}))},hh.prototype.To=function(){var t=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(e){return lh(e).put(new ja(t.clientId,Date.now(),t.networkEnabled,t.inForeground)).next(function(){if(t.isPrimary)return t.Vo(e).next(function(e){e||(t.isPrimary=!1,t.Zr.po(function(){return t.uo(!1)}))})}).next(function(){return t.bo(e)}).next(function(n){return t.isPrimary&&!n?t.vo(e).next(function(){return!1}):!!n&&t.So(e).next(function(){return!0})})}).catch(function(e){if(pa(e))return Nr("IndexedDbPersistence","Failed to extend owner lease: ",e),t.isPrimary;if(!t.allowTabSynchronization)throw e;return Nr("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(function(e){t.isPrimary!==e&&t.Zr.po(function(){return t.uo(e)}),t.isPrimary=e})},hh.prototype.Vo=function(t){var e=this;return fh(t).get(Sa.key).next(function(t){return ra.resolve(e.Do(t))})},hh.prototype.Co=function(t){return lh(t).delete(this.clientId)},hh.prototype.xo=function(){return l(this,void 0,void 0,function(){var t,e,n,r,i=this;return p(this,function(o){switch(o.label){case 0:return!this.isPrimary||this.No(this.ao,18e5)?[3,2]:(this.ao=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(t){var e=Qa(t,ja.store);return e.rs().next(function(t){var n=i.$o(t,18e5),r=t.filter(function(t){return-1===n.indexOf(t)});return ra.forEach(r,function(t){return e.delete(t.clientId)}).next(function(){return r})})}).catch(function(){return[]})]);case 1:if(t=o.sent(),this.Eo)for(e=0,n=t;e<n.length;e++)r=n[e],this.Eo.removeItem(this.Fo(r.clientId));o.label=2;case 2:return[2]}})})},hh.prototype.Ao=function(){var t=this;this.co=this.Zr.Tr("client_metadata_refresh",4e3,function(){return t.To().then(function(){return t.xo()}).then(function(){return t.Ao()})})},hh.prototype.Do=function(t){return!!t&&t.ownerId===this.clientId},hh.prototype.bo=function(t){var e=this;return this.no?ra.resolve(!0):fh(t).get(Sa.key).next(function(n){if(null!==n&&e.No(n.leaseTimestampMs,5e3)&&!e.Oo(n.ownerId)){if(e.Do(n)&&e.networkEnabled)return!0;if(!e.Do(n)){if(!n.allowTabSynchronization)throw new Fr(jr.FAILED_PRECONDITION,ah);return!1}}return!(!e.networkEnabled||!e.inForeground)||lh(t).rs().next(function(t){return void 0===e.$o(t,5e3).find(function(t){if(e.clientId!==t.clientId){var n=!e.networkEnabled&&t.networkEnabled,r=!e.inForeground&&t.inForeground;t=e.networkEnabled===t.networkEnabled;if(n||r&&t)return!0}return!1})})}).next(function(t){return e.isPrimary!==t&&Nr("IndexedDbPersistence","Client "+(t?"is":"is not")+" eligible for a primary lease."),t})},hh.prototype.ko=function(){return l(this,void 0,void 0,function(){var t=this;return p(this,function(e){switch(e.label){case 0:return this.io=!1,this.Mo(),this.co&&(this.co.cancel(),this.co=null),this.Lo(),this.Bo(),[4,this.lo.runTransaction("shutdown","readwrite",[Sa.store,ja.store],function(e){var n=new za(e,Wr.q);return t.vo(n).next(function(){return t.Co(n)})})];case 1:return e.sent(),this.lo.close(),this.qo(),[2]}})})},hh.prototype.$o=function(t,e){var n=this;return t.filter(function(t){return n.No(t.updateTimeMs,e)&&!n.Oo(t.clientId)})},hh.prototype.Uo=function(){var t=this;return this.runTransaction("getActiveClients","readonly",function(e){return lh(e).rs().next(function(e){return t.$o(e,18e5).map(function(t){return t.clientId})})})},Object.defineProperty(hh.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),hh.prototype.Qo=function(t){return xc.mi(t,this.Qt,this.Ei,this.Ti)},hh.prototype.Sr=function(){return this._o},hh.prototype.$r=function(){return this.fo},hh.prototype.Ko=function(){return this.Ei},hh.prototype.Wo=function(){return this.wo},hh.prototype.runTransaction=function(t,e,n){var r=this;Nr("IndexedDbPersistence","Starting transaction:",t);var i,o="readonly"===e?"readonly":"readwrite";return this.lo.runTransaction(t,o,Ga,function(o){return i=new za(o,r.so?r.so.next():Wr.q),"readwrite-primary"===e?r.Vo(i).next(function(t){return!!t||r.bo(i)}).next(function(e){if(!e)throw Ar("Failed to obtain primary lease for action '"+t+"'."),r.isPrimary=!1,r.Zr.po(function(){return r.uo(!1)}),new Fr(jr.FAILED_PRECONDITION,Ea);return n(i)}).next(function(t){return r.So(i).next(function(){return t})}):r.jo(i).next(function(){return n(i)})}).then(function(t){return i.Vs(),t})},hh.prototype.jo=function(t){var e=this;return fh(t).get(Sa.key).next(function(t){if(null!==t&&e.No(t.leaseTimestampMs,5e3)&&!e.Oo(t.ownerId)&&!e.Do(t)&&!(e.no||e.allowTabSynchronization&&t.allowTabSynchronization))throw new Fr(jr.FAILED_PRECONDITION,ah)})},hh.prototype.So=function(t){var e=new Sa(this.clientId,this.allowTabSynchronization,Date.now());return fh(t).put(Sa.key,e)},hh.Kn=function(){return oa.Kn()},hh.prototype.vo=function(t){var e=this,n=fh(t);return n.get(Sa.key).next(function(t){return e.Do(t)?(Nr("IndexedDbPersistence","Releasing primary lease."),n.delete(Sa.key)):ra.resolve()})},hh.prototype.No=function(t,e){var n=Date.now();return!(t<n-e||n<t&&(Ar("Detected an update time that is in the future: "+t+" > "+n),1))},hh.prototype.Io=function(){var t=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.oo=function(){t.Zr.Ps(function(){return t.inForeground="visible"===t.document.visibilityState,t.To()})},this.document.addEventListener("visibilitychange",this.oo),this.inForeground="visible"===this.document.visibilityState)},hh.prototype.Lo=function(){this.oo&&(this.document.removeEventListener("visibilitychange",this.oo),this.oo=null)},hh.prototype.mo=function(){var t,e=this;"function"==typeof(null===(t=this.window)||void 0===t?void 0:t.addEventListener)&&(this.ro=function(){e.Mo(),e.Zr.Ps(function(){return e.ko()})},this.window.addEventListener("unload",this.ro))},hh.prototype.Bo=function(){this.ro&&(this.window.removeEventListener("unload",this.ro),this.ro=null)},hh.prototype.Oo=function(t){try{var e=null!==(null===(e=this.Eo)||void 0===e?void 0:e.getItem(this.Fo(t)));return Nr("IndexedDbPersistence","Client '"+t+"' "+(e?"is":"is not")+" zombied in LocalStorage"),e}catch(t){return Ar("IndexedDbPersistence","Failed to get zombied client id.",t),!1}},hh.prototype.Mo=function(){if(this.Eo)try{this.Eo.setItem(this.Fo(this.clientId),String(Date.now()))}catch(t){Ar("Failed to set zombie client id.",t)}},hh.prototype.qo=function(){if(this.Eo)try{this.Eo.removeItem(this.Fo(this.clientId))}catch(t){}},hh.prototype.Fo=function(t){return"firestore_zombie_"+this.persistenceKey+"_"+t},hh);function hh(t,e,n,r,i,o,s,u,a,c){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=n,this.Zr=i,this.window=o,this.document=s,this.eo=a,this.no=c,this.so=null,this.io=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ro=null,this.inForeground=!1,this.oo=null,this.co=null,this.ao=Number.NEGATIVE_INFINITY,this.uo=function(t){return Promise.resolve()},!hh.Kn())throw new Fr(jr.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.Ti=new Hc(this,r),this.ho=e+"main",this.Qt=new Xa(u),this.lo=new oa(this.ho,11,new oh(this.Qt)),this._o=new Rc(this.Ti,this.Qt),this.Ei=new dc,this.fo=(e=this.Qt,u=this.Ei,new Zc(e,u)),this.wo=new ac,this.window&&this.window.localStorage?this.Eo=this.window.localStorage:(this.Eo=null,!1===c&&Ar("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}function fh(t){return Qa(t,Sa.store)}function lh(t){return Qa(t,ja.store)}function ph(t,e){var n=t.projectId;return t.o||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var dh=(_h.prototype.Ho=function(t,e){var n=this;return this.zo.bi(t,e).next(function(r){return n.Jo(t,e,r)})},_h.prototype.Jo=function(t,e,n){return this.fo._i(t,e).next(function(t){for(var r=0,i=n;r<i.length;r++)t=i[r].Cs(e,t);return t})},_h.prototype.Yo=function(t,e,n){var r=nu;return e.forEach(function(t,e){for(var i=0,o=n;i<o.length;i++)e=o[i].Cs(t,e);r=r.zt(t,e)}),r},_h.prototype.Xo=function(t,e){var n=this;return this.fo.getEntries(t,e).next(function(e){return n.Zo(t,e)})},_h.prototype.Zo=function(t,e){var n=this;return this.zo.vi(t,e).next(function(r){r=n.Yo(t,e,r);var i=nu;return r.forEach(function(t,e){e=e||new Wi(t,oi.min()),i=i.zt(t,e)}),i})},_h.prototype.Kr=function(t,e,n){return r=e,ci.wt(r.path)&&null===r.collectionGroup&&0===r.filters.length?this.tc(t,e.path):zo(e)?this.ec(t,e,n):this.nc(t,e,n);var r},_h.prototype.tc=function(t,e){return this.Ho(t,new ci(e)).next(function(t){var e=ou;return t instanceof Xi?e.zt(t.key,t):e})},_h.prototype.ec=function(t,e,n){var r=this,i=e.collectionGroup,o=ou;return this.Ei.Us(t,i).next(function(s){return ra.forEach(s,function(s){var u=(u=e,s=s.child(i),new Mo(s,null,u.xt.slice(),u.filters.slice(),u.limit,u.limitType,u.startAt,u.endAt));return r.nc(t,u,n).next(function(t){t.forEach(function(t,e){o=o.zt(t,e)})})}).next(function(){return o})})},_h.prototype.nc=function(t,e,n){var r,i,o=this;return this.fo.Kr(t,e,n).next(function(n){return r=n,o.zo.Di(t,e)}).next(function(e){return i=e,o.sc(t,i,r).next(function(t){r=t;for(var e=0,n=i;e<n.length;e++)for(var o=n[e],s=0,u=o.mutations;s<u.length;s++){var a=(c=u[s]).key,c=Ns(c,r.get(a),o.vs);r=c instanceof Xi?r.zt(a,c):r.remove(a)}})}).next(function(){return r.forEach(function(t,n){Jo(e,n)||(r=r.remove(t))}),r})},_h.prototype.sc=function(t,e,n){for(var r=au(),i=0,o=e;i<o.length;i++)for(var s=0,u=o[i].mutations;s<u.length;s++){var a=u[s];a instanceof ks&&null===n.get(a.key)&&(r=r.add(a.key))}var c=n;return this.fo.getEntries(t,r).next(function(t){return t.forEach(function(t,e){null!==e&&e instanceof Xi&&(c=c.zt(t,e))}),c})},_h),yh=(wh.oc=function(t,e){for(var n=au(),r=au(),i=0,o=e.docChanges;i<o.length;i++){var s=o[i];switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}}return new wh(t,e.fromCache,n,r)},wh),vh=(bh.prototype.cc=function(t){this.ac=t},bh.prototype.Kr=function(t,n,r,i){var o=this;return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.xt.length||1===n.xt.length&&n.xt[0].field.ut())||r.isEqual(oi.min())?this.uc(t,n):this.ac.Xo(t,i).next(function(s){var u=o.hc(n,s);return(Fo(n)||qo(n))&&o.lc(n.limitType,u,i,r)?o.uc(t,n):(Tr()<=e.DEBUG&&Nr("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Wo(n)),o.ac.Kr(t,n,r).next(function(t){return u.forEach(function(e){t=t.zt(e.key,e)}),t}))})},bh.prototype.hc=function(t,e){var n=new tu(Zo(t));return e.forEach(function(e,r){r instanceof Xi&&Jo(t,r)&&(n=n.add(r))}),n},bh.prototype.lc=function(t,e,n,r){return n.size!==e.size||!!(e="F"===t?e.last():e.first())&&(e.hasPendingWrites||0<e.version._(r))},bh.prototype.uc=function(t,n){return Tr()<=e.DEBUG&&Nr("QueryEngine","Using full collection scan to execute query:",Wo(n)),this.ac.Kr(t,n,oi.min())},bh),gh=(mh.prototype.Ir=function(t){var e=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(n){return t.Vr(n,e.fc)})},mh);function mh(t,e,n,r){this.persistence=t,this._c=e,this.Qt=r,this.fc=new Ys(Cr),this.dc=new Ic(ro,io),this.wc=oi.min(),this.zo=t.Qo(n),this.Ec=t.$r(),this._o=t.Sr(),this.Tc=new dh(this.Ec,this.zo,this.persistence.Ko()),this.wo=t.Wo(),this._c.cc(this.Tc)}function bh(){}function wh(t,e,n,r){this.targetId=t,this.fromCache=e,this.ic=n,this.rc=r}function _h(t,e,n){this.fo=t,this.zo=e,this.Ei=n}function Eh(t,e,n,r){return new gh(t,e,n,r)}function Ih(t,e){return l(this,void 0,void 0,function(){var n,r,i,o;return p(this,function(s){switch(s.label){case 0:return r=(n=t).zo,i=n.Tc,[4,n.persistence.runTransaction("Handle user change","readonly",function(t){var o;return n.zo.pi(t).next(function(s){return o=s,r=n.persistence.Qo(e),i=new dh(n.Ec,r,n.persistence.Ko()),r.pi(t)}).next(function(e){for(var n=[],r=[],s=au(),u=0,a=o;u<a.length;u++){var c=a[u];n.push(c.batchId);for(var h=0,f=c.mutations;h<f.length;h++){var l=f[h];s=s.add(l.key)}}for(var p=0,d=e;p<d.length;p++){var y=d[p];r.push(y.batchId);for(var v=0,g=y.mutations;v<g.length;v++){var m=g[v];s=s.add(m.key)}}return i.Xo(t,s).next(function(t){return{Ic:t,mc:n,Ac:r}})})})];case 1:return o=s.sent(),[2,(n.zo=r,n.Tc=i,n._c.cc(n.Tc),o)]}})})}function Th(t){var e=t;return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(t){return e._o.Qi(t)})}function Nh(t,e,n,r,i){var o=au();return n.forEach(function(t){return o=o.add(t)}),e.getEntries(t,o).next(function(t){var o=nu;return n.forEach(function(n,s){var u=t.get(n),a=(null==i?void 0:i.get(n))||r;s instanceof Wi&&s.version.isEqual(oi.min())?(e.li(n,a),o=o.zt(n,s)):null==u||0<s.version._(u.version)||0===s.version._(u.version)&&u.hasPendingWrites?(e.ai(s,a),o=o.zt(n,s)):Nr("LocalStore","Ignoring outdated watch update for ",n,". Current version:",u.version," Watch version:",s.version)}),o})}function Ah(t,e){var n=t;return n.persistence.runTransaction("Allocate target","readwrite",function(t){var r;return n._o.tr(t,e).next(function(i){return i?(r=i,ra.resolve(r)):n._o.Bi(t).next(function(i){return r=new $o(e,i,0,t.bs),n._o.ji(t,r).next(function(){return r})})})}).then(function(t){var r=n.fc.get(t.targetId);return(null===r||0<t.Ot._(r.Ot))&&(n.fc=n.fc.zt(t.targetId,t),n.dc.set(e,t.targetId)),t})}function Sh(t,e,n){return l(this,void 0,void 0,function(){var r,i,o;return p(this,function(s){switch(s.label){case 0:i=(r=t).fc.get(e),o=n?"readwrite":"readwrite-primary",s.label=1;case 1:return s.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,function(t){return r.persistence.Ti.removeTarget(t,i)})];case 2:s.sent(),s.label=3;case 3:return[3,5];case 4:if(!pa(o=s.sent()))throw o;return Nr("LocalStore","Failed to update sequence numbers for target "+e+": "+o),[3,5];case 5:return r.fc=r.fc.remove(e),r.dc.delete(i.target),[2]}})})}function xh(t,e,n){var r=t,i=oi.min(),o=au();return r.persistence.runTransaction("Execute query","readonly",function(t){return s=r,u=t,a=Qo(e),(void 0!==(s=(c=s).dc.get(a))?ra.resolve(c.fc.get(s)):c._o.tr(u,a)).next(function(e){if(e)return i=e.lastLimboFreeSnapshotVersion,r._o.rr(t,e.targetId).next(function(t){o=t})}).next(function(){return r._c.Kr(t,e,n?i:oi.min(),n?o:au())}).next(function(t){return{documents:t,Rc:o}});var s,u,a,c})}function Dh(t,e){var n=t,r=n._o;return(t=n.fc.get(e))?Promise.resolve(t.target):n.persistence.runTransaction("Get target data","readonly",function(t){return r.Sn(t,e).next(function(t){return t?t.target:null})})}function Oh(t){var e=t;return e.persistence.runTransaction("Get new document changes","readonly",function(t){return n=e.Ec,r=t,t=e.wc,i=n,o=nu,s=tc(t),t=rh(r),r=IDBKeyRange.lowerBound(s,!0),t.hs({index:Ca.readTimeIndex,range:r},function(t,e){var n=Za(i.Qt,e);o=o.zt(n.key,n),s=e.readTime}).next(function(){return{Go:o,readTime:ec(s)}});var n,r,i,o,s}).then(function(t){var n=t.Go;t=t.readTime;return e.wc=t,n})}var kh,Ph,Ch=(Zh.prototype.Os=function(t,e){return ra.resolve(this.Vc.get(e))},Zh.prototype.ks=function(t,e){return this.Vc.set(e.id,{id:e.id,version:e.version,createTime:Lu(e.createTime)}),ra.resolve()},Zh.prototype.Ms=function(t,e){return ra.resolve(this.bc.get(e))},Zh.prototype.Ls=function(t,e){return this.bc.set(e.name,{name:(e=e).name,query:uc(e.bundledQuery),readTime:Lu(e.readTime)}),ra.resolve()},Zh),Lh=(Jh.prototype.et=function(){return this.vc.et()},Jh.prototype.nr=function(t,e){e=new Rh(t,e),this.vc=this.vc.add(e),this.Dc=this.Dc.add(e)},Jh.prototype.xc=function(t,e){var n=this;t.forEach(function(t){return n.nr(t,e)})},Jh.prototype.ir=function(t,e){this.Nc(new Rh(t,e))},Jh.prototype.$c=function(t,e){var n=this;t.forEach(function(t){return n.ir(t,e)})},Jh.prototype.Fc=function(t){var e=this,n=new ci(new si([])),r=new Rh(n,t),i=(t=new Rh(n,t+1),[]);return this.Dc.me([r,t],function(t){e.Nc(t),i.push(t.key)}),i},Jh.prototype.Oc=function(){var t=this;this.vc.forEach(function(e){return t.Nc(e)})},Jh.prototype.Nc=function(t){this.vc=this.vc.delete(t),this.Dc=this.Dc.delete(t)},Jh.prototype.kc=function(t){var e=new ci(new si([])),n=new Rh(e,t),r=(t=new Rh(e,t+1),au());return this.Dc.me([n,t],function(t){r=r.add(t.key)}),r},Jh.prototype.Fi=function(t){var e=new Rh(t,0);return null!==(e=this.vc.Re(e))&&t.isEqual(e.key)},Jh),Rh=(Wh.Sc=function(t,e){return ci.H(t.key,e.key)||Cr(t.Mc,e.Mc)},Wh.Cc=function(t,e){return Cr(t.Mc,e.Mc)||ci.H(t.key,e.key)},Wh),Vh=(Xh.prototype.Ai=function(t){return ra.resolve(0===this.zo.length)},Xh.prototype.Ri=function(t,e,n,r){var i=this.Lc;this.Lc++,0<this.zo.length&&this.zo[this.zo.length-1],n=new Ya(i,e,n,r),this.zo.push(n);for(var o=0,s=r;o<s.length;o++){var u=s[o];this.Bc=this.Bc.add(new Rh(u.key,i)),this.Ei.qs(t,u.key.path.X())}return ra.resolve(n)},Xh.prototype.Pi=function(t,e){return ra.resolve(this.qc(e))},Xh.prototype.gi=function(t,e){return e+=1,e=(e=this.Uc(e))<0?0:e,ra.resolve(this.zo.length>e?this.zo[e]:null)},Xh.prototype.Vi=function(){return ra.resolve(0===this.zo.length?-1:this.Lc-1)},Xh.prototype.pi=function(t){return ra.resolve(this.zo.slice())},Xh.prototype.bi=function(t,e){var n=this,r=new Rh(e,0),i=(e=new Rh(e,Number.POSITIVE_INFINITY),[]);return this.Bc.me([r,e],function(t){t=n.qc(t.Mc),i.push(t)}),ra.resolve(i)},Xh.prototype.vi=function(t,e){var n=this,r=new tu(Cr);return e.forEach(function(t){var e=new Rh(t,0);t=new Rh(t,Number.POSITIVE_INFINITY);n.Bc.me([e,t],function(t){r=r.add(t.Mc)})}),ra.resolve(this.Qc(r))},Xh.prototype.Di=function(t,e){var n=e.path,r=n.length+1;e=n;ci.wt(e)||(e=e.child(""));e=new Rh(new ci(e),0);var i=new tu(Cr);return this.Bc.Ae(function(t){var e=t.key.path;return!!n.nt(e)&&(e.length===r&&(i=i.add(t.Mc)),!0)},e),ra.resolve(this.Qc(i))},Xh.prototype.Qc=function(t){var e=this,n=[];return t.forEach(function(t){null!==(t=e.qc(t))&&n.push(t)}),n},Xh.prototype.Ci=function(t,e){var n=this;Or(0===this.Kc(e.batchId,"removed")),this.zo.shift();var r=this.Bc;return ra.forEach(e.mutations,function(i){var o=new Rh(i.key,e.batchId);return r=r.delete(o),n.Ti.Ni(t,i.key)}).next(function(){n.Bc=r})},Xh.prototype.xi=function(t){},Xh.prototype.Fi=function(t,e){var n=new Rh(e,0);n=this.Bc.Re(n);return ra.resolve(e.isEqual(n&&n.key))},Xh.prototype.$i=function(t){return this.zo.length,ra.resolve()},Xh.prototype.Kc=function(t,e){return this.Uc(t)},Xh.prototype.Uc=function(t){return 0===this.zo.length?0:t-this.zo[0].batchId},Xh.prototype.qc=function(t){return(t=this.Uc(t))<0||t>=this.zo.length?null:this.zo[t]},Xh),Mh=(Kh.prototype.ai=function(t,e,n){var r=e.key,i=(o=this.docs.get(r))?o.size:0,o=this.Wc(e);return this.docs=this.docs.zt(r,{hi:e,size:o,readTime:n}),this.size+=o-i,this.Ei.qs(t,r.path.X())},Kh.prototype.li=function(t){var e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)},Kh.prototype._i=function(t,e){return e=this.docs.get(e),ra.resolve(e?e.hi:null)},Kh.prototype.getEntries=function(t,e){var n=this,r=nu;return e.forEach(function(t){var e=n.docs.get(t);r=r.zt(t,e?e.hi:null)}),ra.resolve(r)},Kh.prototype.Kr=function(t,e,n){for(var r=ou,i=new ci(e.path.child("")),o=this.docs.ee(i);o.ce();){var s=(u=o.oe()).key,u=(a=u.value).hi,a=a.readTime;if(!e.path.nt(s.path))break;a._(n)<=0||u instanceof Xi&&Jo(e,u)&&(r=r.zt(u.key,u))}return ra.resolve(r)},Kh.prototype.jc=function(t,e){return ra.forEach(this.docs,function(t){return e(t)})},Kh.prototype.Nr=function(t){return new Uh(this)},Kh.prototype.Or=function(t){return ra.resolve(this.size)},Kh),Uh=(f(Yh,Ph=_e),Yh.prototype.wi=function(t){var e=this,n=[];return this.ri.forEach(function(r,i){i&&i.hi?n.push(e.jr.ai(t,i.hi,e.ci(r))):e.jr.li(r)}),ra.Mn(n)},Yh.prototype.fi=function(t,e){return this.jr._i(t,e)},Yh.prototype.di=function(t,e){return this.jr.getEntries(t,e)},Yh),jh=(Qh.prototype.In=function(t,e){return this.Gc.forEach(function(t,n){return e(n)}),ra.resolve()},Qh.prototype.Qi=function(t){return ra.resolve(this.lastRemoteSnapshotVersion)},Qh.prototype.Ki=function(t){return ra.resolve(this.zc)},Qh.prototype.Bi=function(t){return this.highestTargetId=this.Jc.next(),ra.resolve(this.highestTargetId)},Qh.prototype.Wi=function(t,e,n){return n&&(this.lastRemoteSnapshotVersion=n),e>this.zc&&(this.zc=e),ra.resolve()},Qh.prototype.Gi=function(t){this.Gc.set(t.target,t);var e=t.targetId;e>this.highestTargetId&&(this.Jc=new Lc(e),this.highestTargetId=e),t.sequenceNumber>this.zc&&(this.zc=t.sequenceNumber)},Qh.prototype.ji=function(t,e){return this.Gi(e),this.targetCount+=1,ra.resolve()},Qh.prototype.Hi=function(t,e){return this.Gi(e),ra.resolve()},Qh.prototype.Ji=function(t,e){return this.Gc.delete(e.target),this.Hc.Fc(e.targetId),--this.targetCount,ra.resolve()},Qh.prototype.Xi=function(t,e,n){var r=this,i=0,o=[];return this.Gc.forEach(function(s,u){u.sequenceNumber<=e&&null===n.get(u.targetId)&&(r.Gc.delete(s),o.push(r.Yi(t,u.targetId)),i++)}),ra.Mn(o).next(function(){return i})},Qh.prototype.Zi=function(t){return ra.resolve(this.targetCount)},Qh.prototype.tr=function(t,e){return e=this.Gc.get(e)||null,ra.resolve(e)},Qh.prototype.er=function(t,e,n){return this.Hc.xc(e,n),ra.resolve()},Qh.prototype.sr=function(t,e,n){this.Hc.$c(e,n);var r=this.persistence.Ti,i=[];return r&&e.forEach(function(e){i.push(r.Ni(t,e))}),ra.Mn(i)},Qh.prototype.Yi=function(t,e){return this.Hc.Fc(e),ra.resolve()},Qh.prototype.rr=function(t,e){return e=this.Hc.kc(e),ra.resolve(e)},Qh.prototype.Fi=function(t,e){return ra.resolve(this.Hc.Fi(e))},Qh),Fh=(Hh.prototype.start=function(){return Promise.resolve()},Hh.prototype.ko=function(){return this.io=!1,Promise.resolve()},Object.defineProperty(Hh.prototype,"Er",{get:function(){return this.io},enumerable:!1,configurable:!0}),Hh.prototype.Po=function(){},Hh.prototype.yo=function(){},Hh.prototype.Ko=function(){return this.Ei},Hh.prototype.Qo=function(t){var e=this.Yc[t.A()];return e||(e=new Vh(this.Ei,this.Ti),this.Yc[t.A()]=e),e},Hh.prototype.Sr=function(){return this._o},Hh.prototype.$r=function(){return this.fo},Hh.prototype.Wo=function(){return this.wo},Hh.prototype.runTransaction=function(t,e,n){var r=this;Nr("MemoryPersistence","Starting transaction:",t);var i=new qh(this.so.next());return this.Ti.Zc(),n(i).next(function(t){return r.Ti.ta(i).next(function(){return t})}).On().then(function(t){return i.Vs(),t})},Hh.prototype.ea=function(t,e){return ra.Ln(Object.values(this.Yc).map(function(n){return function(){return n.Fi(t,e)}}))},Hh),qh=(f(zh,kh=a),zh),Bh=(Gh.ia=function(t){return new Gh(t)},Object.defineProperty(Gh.prototype,"ra",{get:function(){if(this.sa)return this.sa;throw Dr()},enumerable:!1,configurable:!0}),Gh.prototype.nr=function(t,e,n){return this.na.nr(n,e),this.ra.delete(n.toString()),ra.resolve()},Gh.prototype.ir=function(t,e,n){return this.na.ir(n,e),this.ra.add(n.toString()),ra.resolve()},Gh.prototype.Ni=function(t,e){return this.ra.add(e.toString()),ra.resolve()},Gh.prototype.removeTarget=function(t,e){var n=this;this.na.Fc(e.targetId).forEach(function(t){return n.ra.add(t.toString())});var r=this.persistence.Sr();return r.rr(t,e.targetId).next(function(t){t.forEach(function(t){return n.ra.add(t.toString())})}).next(function(){return r.Ji(t,e)})},Gh.prototype.Zc=function(){this.sa=new Set},Gh.prototype.ta=function(t){var e=this,n=this.persistence.$r().Nr();return ra.forEach(this.ra,function(r){var i=ci._t(r);return e.oa(t,i).next(function(t){t||n.li(i)})}).next(function(){return e.sa=null,n.apply(t)})},Gh.prototype.Fr=function(t,e){var n=this;return this.oa(t,e).next(function(t){t?n.ra.delete(e.toString()):n.ra.add(e.toString())})},Gh.prototype.Xc=function(t){return 0},Gh.prototype.oa=function(t,e){var n=this;return ra.Ln([function(){return ra.resolve(n.na.Fi(e))},function(){return n.persistence.Sr().Fi(t,e)},function(){return n.persistence.ea(t,e)}])},Gh);function Gh(t){this.persistence=t,this.na=new Lh,this.sa=null}function zh(t){var e;return(e=kh.call(this)||this).bs=t,e}function Hh(t,e){var n=this;this.Yc={},this.so=new Wr(0),this.io=!1,this.io=!0,this.Ti=t(this),this._o=new jh(this),this.Ei=new lc,this.fo=(t=this.Ei,new Mh(t,function(t){return n.Ti.Xc(t)})),this.Qt=new Xa(e),this.wo=new Ch(this.Qt)}function Qh(t){this.persistence=t,this.Gc=new Ic(ro,io),this.lastRemoteSnapshotVersion=oi.min(),this.highestTargetId=0,this.zc=0,this.Hc=new Lh,this.targetCount=0,this.Jc=Lc.Mi()}function Yh(t){var e;return(e=Ph.call(this)||this).jr=t,e}function Kh(t,e){this.Ei=t,this.Wc=e,this.docs=new Ys(ci.H),this.size=0}function Xh(t,e){this.Ei=t,this.Ti=e,this.zo=[],this.Lc=1,this.Bc=new tu(Rh.Sc)}function Wh(t,e){this.key=t,this.Mc=e}function Jh(){this.vc=new tu(Rh.Sc),this.Dc=new tu(Rh.Cc)}function Zh(t){this.Qt=t,this.Vc=new Map,this.bc=new Map}function $h(t,e){return"firestore_clients_"+t+"_"+e}function tf(t,e,n){return n="firestore_mutations_"+t+"_"+n,e.m()&&(n+="_"+e.uid),n}function ef(t,e){return"firestore_targets_"+t+"_"+e}var nf,rf=(Sf.ca=function(t,e,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new Fr(i.error.code,i.error.message)),o?new Sf(t,e,i.state,r):(Ar("SharedClientState","Failed to parse mutation state for ID '"+e+"': "+n),null)},Sf.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Sf),of=(Af.ca=function(t,e){var n,r=JSON.parse(e),i="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return i&&r.error&&(i="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(n=new Fr(r.error.code,r.error.message)),i?new Af(t,r.state,n):(Ar("SharedClientState","Failed to parse target state for ID '"+t+"': "+e),null)},Af.prototype.aa=function(){var t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)},Af),sf=(Nf.ca=function(t,e){for(var n=JSON.parse(e),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=cu,o=0;r&&o<n.activeTargetIds.length;++o)r=Di(n.activeTargetIds[o]),i=i.add(n.activeTargetIds[o]);return r?new Nf(t,i):(Ar("SharedClientState","Failed to parse client data for instance '"+t+"': "+e),null)},Nf),uf=(Tf.ca=function(t){var e=JSON.parse(t);return"object"==typeof e&&-1!==["Unknown","Online","Offline"].indexOf(e.onlineState)&&"string"==typeof e.clientId?new Tf(e.clientId,e.onlineState):(Ar("SharedClientState","Failed to parse online state: "+t),null)},Tf),af=(If.prototype.ua=function(t){this.activeTargetIds=this.activeTargetIds.add(t)},If.prototype.ha=function(t){this.activeTargetIds=this.activeTargetIds.delete(t)},If.prototype.aa=function(){var t={activeTargetIds:this.activeTargetIds.it(),updateTimeMs:Date.now()};return JSON.stringify(t)},If),cf=(Ef.Kn=function(t){return!(!t||!t.localStorage)},Ef.prototype.start=function(){return l(this,void 0,void 0,function(){var t,e,n,r,i,o,s,u,a,c,h=this;return p(this,function(f){switch(f.label){case 0:return[4,this._a.Uo()];case 1:for(o=f.sent(),t=0,e=o;t<e.length;t++)(n=e[t])!==this.la&&(r=this.getItem($h(this.persistenceKey,n)))&&(i=sf.ca(n,r))&&(this.Ea=this.Ea.zt(i.clientId,i));for(this.Va(),(o=this.storage.getItem(this.ya))&&(s=this.pa(o))&&this.ba(s),u=0,a=this.Ta;u<a.length;u++)c=a[u],this.wa(c);return this.Ta=[],this.window.addEventListener("unload",function(){return h.ko()}),this.Er=!0,[2]}})})},Ef.prototype.B=function(t){this.setItem(this.ma,JSON.stringify(t))},Ef.prototype.va=function(){return this.Sa(this.Ea)},Ef.prototype.Da=function(t){var e=!1;return this.Ea.forEach(function(n,r){r.activeTargetIds.has(t)&&(e=!0)}),e},Ef.prototype.Ca=function(t){this.xa(t,"pending")},Ef.prototype.Na=function(t,e,n){this.xa(t,e,n),this.$a(t)},Ef.prototype.Fa=function(t){var e,n="not-current";return this.Da(t)&&(!(e=this.storage.getItem(ef(this.persistenceKey,t)))||(e=of.ca(t,e))&&(n=e.state)),this.Oa.ua(t),this.Va(),n},Ef.prototype.ka=function(t){this.Oa.ha(t),this.Va()},Ef.prototype.Ma=function(t){return this.Oa.activeTargetIds.has(t)},Ef.prototype.La=function(t){this.removeItem(ef(this.persistenceKey,t))},Ef.prototype.Ba=function(t,e,n){this.qa(t,e,n)},Ef.prototype.Ua=function(t,e,n){var r=this;e.forEach(function(t){r.$a(t)}),this.currentUser=t,n.forEach(function(t){r.Ca(t)})},Ef.prototype.Qa=function(t){this.Ka(t)},Ef.prototype.Wa=function(){this.ja()},Ef.prototype.ko=function(){this.Er&&(this.window.removeEventListener("storage",this.da),this.removeItem(this.Ia),this.Er=!1)},Ef.prototype.getItem=function(t){var e=this.storage.getItem(t);return Nr("SharedClientState","READ",t,e),e},Ef.prototype.setItem=function(t,e){Nr("SharedClientState","SET",t,e),this.storage.setItem(t,e)},Ef.prototype.removeItem=function(t){Nr("SharedClientState","REMOVE",t),this.storage.removeItem(t)},Ef.prototype.wa=function(t){var e=this,n=t;n.storageArea===this.storage&&(Nr("SharedClientState","EVENT",n.key,n.newValue),n.key!==this.Ia?this.Zr.po(function(){return l(e,void 0,void 0,function(){var t,e,r,i;return p(this,function(o){if(this.Er){if(null!==n.key)if(this.Aa.test(n.key)){if(null==n.newValue)return t=this.Ga(n.key),[2,this.za(t,null)];if(t=this.Ha(n.key,n.newValue))return[2,this.za(t.clientId,t)]}else if(this.Ra.test(n.key)){if(null!==n.newValue&&(e=this.Ja(n.key,n.newValue)))return[2,this.Ya(e)]}else if(this.Pa.test(n.key)){if(null!==n.newValue&&(r=this.Xa(n.key,n.newValue)))return[2,this.Za(r)]}else if(n.key===this.ya){if(null!==n.newValue&&(i=this.pa(n.newValue)))return[2,this.ba(i)]}else if(n.key===this.ma)(i=function(t){var e=Wr.q;if(null!=t)try{var n=JSON.parse(t);Or("number"==typeof n),e=n}catch(t){Ar("SharedClientState","Failed to read sequence number from WebStorage",t)}return e}(n.newValue))!==Wr.q&&this.k(i);else if(n.key===this.ga)return[2,this._a.tu()]}else this.Ta.push(n);return[2]})})}):Ar("Received WebStorage notification for local change. Another client might have garbage-collected our state"))},Object.defineProperty(Ef.prototype,"Oa",{get:function(){return this.Ea.get(this.la)},enumerable:!1,configurable:!0}),Ef.prototype.Va=function(){this.setItem(this.Ia,this.Oa.aa())},Ef.prototype.xa=function(t,e,n){n=new rf(this.currentUser,t,e,n),t=tf(this.persistenceKey,this.currentUser,t),this.setItem(t,n.aa())},Ef.prototype.$a=function(t){t=tf(this.persistenceKey,this.currentUser,t),this.removeItem(t)},Ef.prototype.Ka=function(t){t={clientId:this.la,onlineState:t},this.storage.setItem(this.ya,JSON.stringify(t))},Ef.prototype.qa=function(t,e,n){var r=ef(this.persistenceKey,t);n=new of(t,e,n);this.setItem(r,n.aa())},Ef.prototype.ja=function(){this.setItem(this.ga,"value-not-used")},Ef.prototype.Ga=function(t){return(t=this.Aa.exec(t))?t[1]:null},Ef.prototype.Ha=function(t,e){return t=this.Ga(t),sf.ca(t,e)},Ef.prototype.Ja=function(t,e){var n=this.Ra.exec(t);t=Number(n[1]),n=void 0!==n[2]?n[2]:null;return rf.ca(new Br(n),t,e)},Ef.prototype.Xa=function(t,e){return t=this.Pa.exec(t),t=Number(t[1]),of.ca(t,e)},Ef.prototype.pa=function(t){return uf.ca(t)},Ef.prototype.Ya=function(t){return l(this,void 0,void 0,function(){return p(this,function(e){return t.user.uid===this.currentUser.uid?[2,this._a.eu(t.batchId,t.state,t.error)]:(Nr("SharedClientState","Ignoring mutation for non-active user "+t.user.uid),[2])})})},Ef.prototype.Za=function(t){return this._a.nu(t.targetId,t.state,t.error)},Ef.prototype.za=function(t,e){var n=this,r=e?this.Ea.zt(t,e):this.Ea.remove(t),i=this.Sa(this.Ea),o=this.Sa(r),s=[],u=[];return o.forEach(function(t){i.has(t)||s.push(t)}),i.forEach(function(t){o.has(t)||u.push(t)}),this._a.su(s,u).then(function(){n.Ea=r})},Ef.prototype.ba=function(t){this.Ea.get(t.clientId)&&this.fa(t.onlineState)},Ef.prototype.Sa=function(t){var e=cu;return t.forEach(function(t,n){e=e.Pe(n.activeTargetIds)}),e},Ef),hf=(_f.prototype.Ca=function(t){},_f.prototype.Na=function(t,e,n){},_f.prototype.Fa=function(t){return this.iu.ua(t),this.ru[t]||"not-current"},_f.prototype.Ba=function(t,e,n){this.ru[t]=e},_f.prototype.ka=function(t){this.iu.ha(t)},_f.prototype.Ma=function(t){return this.iu.activeTargetIds.has(t)},_f.prototype.La=function(t){delete this.ru[t]},_f.prototype.va=function(){return this.iu.activeTargetIds},_f.prototype.Da=function(t){return this.iu.activeTargetIds.has(t)},_f.prototype.start=function(){return this.iu=new af,Promise.resolve()},_f.prototype.Ua=function(t,e,n){},_f.prototype.Qa=function(t){},_f.prototype.ko=function(){},_f.prototype.B=function(t){},_f.prototype.Wa=function(){},_f),ff=(wf.prototype.ou=function(t){},wf.prototype.ko=function(){},wf),lf=(bf.prototype.ou=function(t){this.lu.push(t)},bf.prototype.ko=function(){window.removeEventListener("online",this.cu),window.removeEventListener("offline",this.uu)},bf.prototype._u=function(){window.addEventListener("online",this.cu),window.addEventListener("offline",this.uu)},bf.prototype.au=function(){Nr("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(0)},bf.prototype.hu=function(){Nr("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var t=0,e=this.lu;t<e.length;t++)(0,e[t])(1)},bf.Kn=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},bf),pf={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},df=(mf.prototype.wu=function(t){this.Eu=t},mf.prototype.Tu=function(t){this.Iu=t},mf.prototype.onMessage=function(t){this.mu=t},mf.prototype.close=function(){this.du()},mf.prototype.send=function(t){this.fu(t)},mf.prototype.Au=function(){this.Eu()},mf.prototype.Ru=function(t){this.Iu(t)},mf.prototype.Pu=function(t){this.mu(t)},mf),yf=(gf.prototype.pu=function(t,e,n,r){var i=this.bu(t,e);return Nr("RestConnection","Sending: ",i,n),e={},this.vu(e,r),this.Su(t,i,e,n).then(function(t){return Nr("RestConnection","Received: ",t),t},function(e){throw Sr("RestConnection",t+" failed with error: ",e,"url: ",i,"request:",n),e})},gf.prototype.Du=function(t,e,n,r){return this.pu(t,e,n,r)},gf.prototype.vu=function(t,e){if(t["X-Goog-Api-Client"]="gl-js/ fire/8.2.10",t["Content-Type"]="text/plain",e)for(var n in e.g)e.g.hasOwnProperty(n)&&(t[n]=e.g[n])},gf.prototype.bu=function(t,e){return t=pf[t],this.gu+"/v1/"+e+":"+t},f(vf,nf=gf),vf.prototype.Su=function(t,e,n,r){return new Promise(function(i,o){var s=new br;s.listenOnce(vr.COMPLETE,function(){try{switch(s.getLastErrorCode()){case yr.NO_ERROR:var e=s.getResponseJson();Nr("Connection","XHR received:",JSON.stringify(e)),i(e);break;case yr.TIMEOUT:Nr("Connection",'RPC "'+t+'" timed out'),o(new Fr(jr.DEADLINE_EXCEEDED,"Request time out"));break;case yr.HTTP_ERROR:var n=s.getStatus();Nr("Connection",'RPC "'+t+'" failed with status:',n,"response text:",s.getResponseText()),0<n?(e=s.getResponseJson().error)&&e.status&&e.message?(n=e.status.toLowerCase().replace(/_/g,"-"),n=0<=Object.values(jr).indexOf(n)?n:jr.UNKNOWN,o(new Fr(n,e.message))):o(new Fr(jr.UNKNOWN,"Server responded with status "+s.getStatus())):o(new Fr(jr.UNAVAILABLE,"Connection failed."));break;default:Dr()}}finally{Nr("Connection",'RPC "'+t+'" completed.')}});var u=JSON.stringify(r);s.send(e,"POST",u,n,15)})},vf.prototype.Cu=function(t,e){var n,r=[this.gu,"/","google.firestore.v1.Firestore","/",t,"/channel"],i=new cr,o=dr();t={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.t.projectId+"/databases/"+this.t.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.i};this.vu(t.initMessageHeaders,e),"undefined"!=typeof window&&(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(y())||"object"==typeof navigator&&"ReactNative"===navigator.product||0<=y().indexOf("Electron/")||0<=(n=y()).indexOf("MSIE ")||0<=n.indexOf("Trident/")||0<=y().indexOf("MSAppHost/")||"object"==typeof(n="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0)&&void 0!==n.id||(t.httpHeadersOverwriteParam="$httpHeaders"),Nr("Connection","Creating WebChannel: "+(r=r.join("")),t);var s=i.createWebChannel(r,t),u=!1,a=!1,c=new df({fu:function(t){a?Nr("Connection","Not sending because WebChannel is closed:",t):(u||(Nr("Connection","Opening WebChannel transport."),s.open(),u=!0),Nr("Connection","WebChannel sending:",t),s.send(t))},du:function(){return s.close()}});return(t=function(t,e,n){t.listen(e,function(t){try{n(t)}catch(t){setTimeout(function(){throw t},0)}})})(s,mr.EventType.OPEN,function(){a||Nr("Connection","WebChannel transport opened.")}),t(s,mr.EventType.CLOSE,function(){a||(a=!0,Nr("Connection","WebChannel transport closed"),c.Ru())}),t(s,mr.EventType.ERROR,function(t){a||(a=!0,Sr("Connection","WebChannel transport errored:",t),c.Ru(new Fr(jr.UNAVAILABLE,"The operation could not be completed")))}),t(s,mr.EventType.MESSAGE,function(t){var e,n,r,i;a||(Or(!!(e=t.data[0])),(n=e.error||(null===(i=e[0])||void 0===i?void 0:i.error))?(Nr("Connection","WebChannel received error:",n),r=n.status,t=function(){var t=Us[r];if(void 0!==t)return Qs(t)}(),i=n.message,void 0===t&&(t=jr.INTERNAL,i="Unknown error status: "+r+" with message "+n.message),a=!0,c.Ru(new Fr(t,i)),s.close()):(Nr("Connection","WebChannel received:",e),c.Pu(e)))}),t(o,gr.STAT_EVENT,function(t){10===t.stat?Nr("Connection","Detected buffering proxy"):11===t.stat&&Nr("Connection","Detected no buffering proxy")}),setTimeout(function(){c.Au()},0),c},vf);function vf(t){var e=this;return(e=nf.call(this,t)||this).forceLongPolling=t.forceLongPolling,e.i=t.i,e}function gf(t){this.yu=t,this.t=t.t;var e=t.ssl?"https":"http";this.gu=e+"://"+t.host,this.Vu="projects/"+this.t.projectId+"/databases/"+this.t.database+"/documents"}function mf(t){this.fu=t.fu,this.du=t.du}function bf(){var t=this;this.cu=function(){return t.au()},this.uu=function(){return t.hu()},this.lu=[],this._u()}function wf(){}function _f(){this.iu=new af,this.ru={},this.fa=null,this.k=null}function Ef(t,e,n,r,i){this.window=t,this.Zr=e,this.persistenceKey=n,this.la=r,this._a=null,this.fa=null,this.k=null,this.da=this.wa.bind(this),this.Ea=new Ys(Cr),this.Er=!1,this.Ta=[],n=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),this.storage=this.window.localStorage,this.currentUser=i,this.Ia=$h(this.persistenceKey,this.la),this.ma="firestore_sequence_number_"+this.persistenceKey,this.Ea=this.Ea.zt(this.la,new af),this.Aa=new RegExp("^firestore_clients_"+n+"_([^_]*)$"),this.Ra=new RegExp("^firestore_mutations_"+n+"_(\\d+)(?:_(.*))?$"),this.Pa=new RegExp("^firestore_targets_"+n+"_(\\d+)$"),this.ya="firestore_online_state_"+this.persistenceKey,this.ga="firestore_bundle_loaded_"+this.persistenceKey,this.window.addEventListener("storage",this.da)}function If(){this.activeTargetIds=cu}function Tf(t,e){this.clientId=t,this.onlineState=e}function Nf(t,e){this.clientId=t,this.activeTargetIds=e}function Af(t,e,n){this.targetId=t,this.state=e,this.error=n}function Sf(t,e,n,r){this.user=t,this.batchId=e,this.state=n,this.error=r}function xf(){return"undefined"!=typeof window?window:null}function Df(){return"undefined"!=typeof document?document:null}function Of(t){return new ku(t,!0)}var kf,Pf,Cf,Lf=(zf.prototype.reset=function(){this.Fu=0},zf.prototype.Mu=function(){this.Fu=this.$u},zf.prototype.Lu=function(t){var e=this;this.cancel();var n=Math.floor(this.Fu+this.Bu()),r=Math.max(0,Date.now()-this.ku),i=Math.max(0,n-r);0<i&&Nr("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.Fu+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ou=this.Zr.Tr(this.fs,i,function(){return e.ku=Date.now(),t()}),this.Fu*=this.Nu,this.Fu<this.xu&&(this.Fu=this.xu),this.Fu>this.$u&&(this.Fu=this.$u)},zf.prototype.qu=function(){null!==this.Ou&&(this.Ou.Rs(),this.Ou=null)},zf.prototype.cancel=function(){null!==this.Ou&&(this.Ou.cancel(),this.Ou=null)},zf.prototype.Bu=function(){return(Math.random()-.5)*this.Fu},zf),Rf=(_e=(Gf.prototype.zu=function(){return 1===this.state||2===this.state||4===this.state},Gf.prototype.Hu=function(){return 2===this.state},Gf.prototype.start=function(){3!==this.state?this.auth():this.Ju()},Gf.prototype.stop=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.zu()?[4,this.close(0)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},Gf.prototype.Yu=function(){this.state=0,this.Gu.reset()},Gf.prototype.Xu=function(){var t=this;this.Hu()&&null===this.ju&&(this.ju=this.Zr.Tr(this.Uu,6e4,function(){return t.Zu()}))},Gf.prototype.th=function(t){this.eh(),this.stream.send(t)},Gf.prototype.Zu=function(){return l(this,void 0,void 0,function(){return p(this,function(t){return this.Hu()?[2,this.close(0)]:[2]})})},Gf.prototype.eh=function(){this.ju&&(this.ju.cancel(),this.ju=null)},Gf.prototype.close=function(t,e){return l(this,void 0,void 0,function(){return p(this,function(n){switch(n.label){case 0:return this.eh(),this.Gu.cancel(),this.Wu++,3!==t?this.Gu.reset():e&&e.code===jr.RESOURCE_EXHAUSTED?(Ar(e.toString()),Ar("Using maximum backoff delay to prevent overloading the backend."),this.Gu.Mu()):e&&e.code===jr.UNAUTHENTICATED&&this.Ku.p(),null!==this.stream&&(this.nh(),this.stream.close(),this.stream=null),this.state=t,[4,this.listener.Tu(e)];case 1:return n.sent(),[2]}})})},Gf.prototype.nh=function(){},Gf.prototype.auth=function(){var t=this;this.state=1;var e=this.sh(this.Wu),n=this.Wu;this.Ku.getToken().then(function(e){t.Wu===n&&t.ih(e)},function(n){e(function(){var e=new Fr(jr.UNKNOWN,"Fetching auth token failed: "+n.message);return t.rh(e)})})},Gf.prototype.ih=function(t){var e=this,n=this.sh(this.Wu);this.stream=this.oh(t),this.stream.wu(function(){n(function(){return e.state=2,e.listener.wu()})}),this.stream.Tu(function(t){n(function(){return e.rh(t)})}),this.stream.onMessage(function(t){n(function(){return e.onMessage(t)})})},Gf.prototype.Ju=function(){var t=this;this.state=4,this.Gu.Lu(function(){return l(t,void 0,void 0,function(){return p(this,function(t){return this.state=0,this.start(),[2]})})})},Gf.prototype.rh=function(t){return Nr("PersistentStream","close with error: "+t),this.stream=null,this.close(3,t)},Gf.prototype.sh=function(t){var e=this;return function(n){e.Zr.Ps(function(){return e.Wu===t?n():(Nr("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},Gf),f(Bf,Cf=_e),Bf.prototype.oh=function(t){return this.Qu.Cu("Listen",t)},Bf.prototype.onMessage=function(t){this.Gu.reset();var e=function(t,e){if("targetChange"in e){e.targetChange;var n="NO_CHANGE"===(o=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===o?1:"REMOVE"===o?2:"CURRENT"===o?3:"RESET"===o?4:Dr(),r=e.targetChange.targetIds||[],i=(s=e.targetChange.resumeToken,t.Bt?(Or(void 0===s||"string"==typeof s),Vr.fromBase64String(s||"")):(Or(void 0===s||s instanceof Uint8Array),Vr.fromUint8Array(s||new Uint8Array))),o=(u=e.targetChange.cause)&&(a=void 0===(c=u).code?jr.UNKNOWN:Qs(c.code),new Fr(a,c.message||"")),s=new gu(n,r,i,o||null)}else if("documentChange"in e){e.documentChange,(n=e.documentChange).document,n.document.name,n.document.updateTime,r=Uu(t,n.document.name),i=Lu(n.document.updateTime);var u=new Bi({mapValue:{fields:n.document.fields}}),a=(o=new Xi(r,i,u,{}),n.targetIds||[]),c=n.removedTargetIds||[];s=new yu(a,c,o.key,o)}else if("documentDelete"in e)e.documentDelete,(n=e.documentDelete).document,r=Uu(t,n.document),i=n.readTime?Lu(n.readTime):oi.min(),u=new Wi(r,i),o=n.removedTargetIds||[],s=new yu([],o,u.key,u);else if("documentRemove"in e)e.documentRemove,(n=e.documentRemove).document,r=Uu(t,n.document),i=n.removedTargetIds||[],s=new yu([],i,r,null);else{if(!("filter"in e))return Dr();e.filter,(e=e.filter).targetId,r=new function(t){this.count=t}(n=e.count||0),i=e.targetId,s=new vu(i,r)}return s}(this.Qt,t);t=function(t){return"targetChange"in t?(t=t.targetChange).targetIds&&t.targetIds.length||!t.readTime?oi.min():Lu(t.readTime):oi.min()}(t);return this.listener.ah(e,t)},Bf.prototype.uh=function(t){var e,n,r,i,o={};o.database=qu(this.Qt),o.addTarget=(e=this.Qt,(r=oo(r=(n=t).target)?{documents:Yu(e,r)}:{query:Ku(e,r)}).targetId=n.targetId,0<n.resumeToken.l()?r.resumeToken=Cu(e,n.resumeToken):0<n.Ot._(oi.min())&&(r.readTime=Pu(e,n.Ot.j())),r),(t=(this.Qt,i=t,null==(t=function(){switch(i.Ft){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Dr()}}())?null:{"goog-listen-tags":t}))&&(o.labels=t),this.th(o)},Bf.prototype.hh=function(t){var e={};e.database=qu(this.Qt),e.removeTarget=t,this.th(e)},Bf),Vf=(f(qf,Pf=_e),Object.defineProperty(qf.prototype,"_h",{get:function(){return this.lh},enumerable:!1,configurable:!0}),qf.prototype.start=function(){this.lh=!1,this.lastStreamToken=void 0,Pf.prototype.start.call(this)},qf.prototype.nh=function(){this.lh&&this.fh([])},qf.prototype.oh=function(t){return this.Qu.Cu("Write",t)},qf.prototype.onMessage=function(t){if(Or(!!t.streamToken),this.lastStreamToken=t.streamToken,this.lh){this.Gu.reset();var e=(n=t.writeResults,r=t.commitTime,n&&0<n.length?(Or(void 0!==r),n.map(function(t){return n=r,(t=(e=t).updateTime?Lu(e.updateTime):Lu(n)).isEqual(oi.min())&&(t=Lu(n)),new function(t,e){this.version=t,this.transformResults=e}(t,e.transformResults||[]);var e,n})):[]),n=Lu(t.commitTime);return this.listener.dh(n,e)}var r;return Or(!t.writeResults||0===t.writeResults.length),this.lh=!0,this.listener.wh()},qf.prototype.Eh=function(){var t={};t.database=qu(this.Qt),this.th(t)},qf.prototype.fh=function(t){var e=this;t={streamToken:this.lastStreamToken,writes:t.map(function(t){return Hu(e.Qt,t)})};this.th(t)},qf),Mf=(f(Ff,kf=function(){}),Ff.prototype.Ih=function(){if(this.Th)throw new Fr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Ff.prototype.pu=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then(function(i){return r.Qu.pu(t,e,n,i)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&r.credentials.p(),t})},Ff.prototype.Du=function(t,e,n){var r=this;return this.Ih(),this.credentials.getToken().then(function(i){return r.Qu.Du(t,e,n,i)}).catch(function(t){throw t.code===jr.UNAUTHENTICATED&&r.credentials.p(),t})},Ff.prototype.terminate=function(){this.Th=!1},Ff),Uf=(jf.prototype.Ph=function(){var t=this;0===this.mh&&(this.yh("Unknown"),this.Ah=this._s.Tr("online_state_timeout",1e4,function(){return t.Ah=null,t.gh("Backend didn't respond within 10 seconds."),t.yh("Offline"),Promise.resolve()}))},jf.prototype.Vh=function(t){"Online"===this.state?this.yh("Unknown"):(this.mh++,1<=this.mh&&(this.ph(),this.gh("Connection failed 1 times. Most recent error: "+t.toString()),this.yh("Offline")))},jf.prototype.set=function(t){this.ph(),this.mh=0,"Online"===t&&(this.Rh=!1),this.yh(t)},jf.prototype.yh=function(t){t!==this.state&&(this.state=t,this.fa(t))},jf.prototype.gh=function(t){t="Could not reach Cloud Firestore backend. "+t+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.",this.Rh?(Ar(t),this.Rh=!1):Nr("OnlineStateTracker",t)},jf.prototype.ph=function(){null!==this.Ah&&(this.Ah.cancel(),this.Ah=null)},jf);function jf(t,e){this._s=t,this.fa=e,this.state="Unknown",this.mh=0,this.Ah=null,this.Rh=!0}function Ff(t,e,n){var r=this;return(r=kf.call(this)||this).credentials=t,r.Qu=e,r.Qt=n,r.Th=!1,r}function qf(t,e,n,r,i){var o=this;return(o=Pf.call(this,t,"write_stream_connection_backoff","write_stream_idle",e,n,i)||this).Qt=r,o.lh=!1,o}function Bf(t,e,n,r,i){var o;return(o=Cf.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",e,n,i)||this).Qt=r,o}function Gf(t,e,n,r,i,o){this.Zr=t,this.Uu=n,this.Qu=r,this.Ku=i,this.listener=o,this.state=0,this.Wu=0,this.ju=null,this.stream=null,this.Gu=new Lf(t,e)}function zf(t,e,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Zr=t,this.fs=e,this.xu=n,this.Nu=r,this.$u=i,this.Fu=0,this.Ou=null,this.ku=Date.now(),this.reset()}function Hf(t){return l(this,void 0,void 0,function(){var e,n;return p(this,function(r){switch(r.label){case 0:if(!$f(t))return[3,4];e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Qf(t){return l(this,void 0,void 0,function(){var e,n;return p(this,function(r){switch(r.label){case 0:e=0,n=t.$h,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function Yf(t,e){t.xh.has(e.targetId)||(t.xh.set(e.targetId,e),Zf(t)?Jf(t):ul(t).Hu()&&Xf(t,e))}function Kf(t,e){var n=t;t=ul(n);n.xh.delete(e),t.Hu()&&Wf(n,e),0===n.xh.size&&(t.Hu()?t.Xu():$f(n)&&n.Oh.set("Unknown"))}function Xf(t,e){t.kh.on(e.targetId),ul(t).uh(e)}function Wf(t,e){t.kh.on(e),ul(t).hh(e)}function Jf(t){t.kh=new bu({vn:function(e){return t.Dh.vn(e)},Sn:function(e){return t.xh.get(e)||null}}),ul(t).start(),t.Oh.Ph()}function Zf(t){return $f(t)&&!ul(t).zu()&&0<t.xh.size}function $f(t){return 0===t.Nh.size}function tl(t){t.kh=void 0}function el(t,e,n){return l(this,void 0,void 0,function(){var r=this;return p(this,function(i){switch(i.label){case 0:if(!pa(e))throw e;return t.Nh.add(1),[4,Qf(t)];case 1:return i.sent(),t.Oh.set("Offline"),n=n||function(){return Th(t.bh)},t._s.po(function(){return l(r,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return Nr("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return e.sent(),t.Nh.delete(1),[4,Hf(t)];case 2:return e.sent(),[2]}})})}),[2]}})})}function nl(t,e){return e().catch(function(n){return el(t,n,e)})}function rl(t){return l(this,void 0,void 0,function(){var e,n,r,i;return p(this,function(o){switch(o.label){case 0:n=al(e=t),r=0<e.Ch.length?e.Ch[e.Ch.length-1].batchId:-1,o.label=1;case 1:if(!($f(e)&&e.Ch.length<10))return[3,7];o.label=2;case 2:return o.trys.push([2,4,,6]),[4,(s=e.bh,u=r,(a=s).persistence.runTransaction("Get next mutation batch","readonly",function(t){return void 0===u&&(u=-1),a.zo.gi(t,u)}))];case 3:return null===(i=o.sent())?(0===e.Ch.length&&n.Xu(),[3,7]):(r=i.batchId,function(t,e){t.Ch.push(e),(t=al(t)).Hu()&&t._h&&t.fh(e.mutations)}(e,i),[3,6]);case 4:return i=o.sent(),[4,el(e,i)];case 5:return o.sent(),[3,6];case 6:return[3,1];case 7:return il(e)&&ol(e),[2]}var s,u,a})})}function il(t){return $f(t)&&!al(t).zu()&&0<t.Ch.length}function ol(t){al(t).start()}function sl(t,e){return l(this,void 0,void 0,function(){var n;return p(this,function(r){switch(r.label){case 0:return n=t,e?(n.Nh.delete(2),[4,Hf(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Nh.add(2),[4,Qf(n)]);case 3:r.sent(),n.Oh.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function ul(t){var e,n,r,i=this;return t.Uh||(t.Uh=(e=t.Sh,n=t._s,r={wu:function(t){return l(this,void 0,void 0,function(){return p(this,function(e){return t.xh.forEach(function(e,n){Xf(t,e)}),[2]})})}.bind(null,t),Tu:function(t,e){return l(this,void 0,void 0,function(){return p(this,function(n){return tl(t),Zf(t)?(t.Oh.Vh(e),Jf(t)):t.Oh.set("Unknown"),[2]})})}.bind(null,t),ah:function(t,e,n){return l(this,void 0,void 0,function(){var r,i;return p(this,function(o){switch(o.label){case 0:if(t.Oh.set("Online"),!(e instanceof gu&&2===e.state&&e.cause))return[3,6];o.label=1;case 1:return o.trys.push([1,3,,5]),[4,function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o;return p(this,function(s){switch(s.label){case 0:n=e.cause,r=0,i=e.targetIds,s.label=1;case 1:return r<i.length?(o=i[r],t.xh.has(o)?[4,t.Dh.Mh(o,n)]:[3,3]):[3,5];case 2:s.sent(),t.xh.delete(o),t.kh.removeTarget(o),s.label=3;case 3:s.label=4;case 4:return r++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return o.sent(),[3,5];case 3:return r=o.sent(),Nr("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,el(t,r)];case 4:return o.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof yu?t.kh.dn(e):e instanceof vu?t.kh.Pn(e):t.kh.Tn(e),n.isEqual(oi.min()))return[3,13];o.label=7;case 7:return o.trys.push([7,11,,13]),[4,Th(t.bh)];case 8:return i=o.sent(),0<=n._(i)?[4,(u=n,(a=(s=t).kh.Vn(u)).$e.forEach(function(t,e){var n;0<t.resumeToken.l()&&(n=s.xh.get(e))&&s.xh.set(e,n.Mt(t.resumeToken,u))}),a.Fe.forEach(function(t){var e=s.xh.get(t);e&&(s.xh.set(t,e.Mt(Vr.T,e.Ot)),Wf(s,t),e=new $o(e.target,t,1,e.sequenceNumber),Xf(s,e))}),s.Dh.Lh(a))]:[3,10];case 9:o.sent(),o.label=10;case 10:return[3,13];case 11:return Nr("RemoteStore","Failed to raise snapshot:",i=o.sent()),[4,el(t,i)];case 12:return o.sent(),[3,13];case 13:return[2]}var s,u,a})})}.bind(null,t)},e.Ih(),new Rf(n,e.Qu,e.credentials,e.Qt,r)),t.$h.push(function(e){return l(i,void 0,void 0,function(){return p(this,function(n){switch(n.label){case 0:return e?(t.Uh.Yu(),Zf(t)?Jf(t):t.Oh.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Uh.stop()];case 2:n.sent(),tl(t),n.label=3;case 3:return[2]}})})})),t.Uh}function al(t){var e,n,r,i=this;return t.Qh||(t.Qh=(e=t.Sh,n=t._s,r={wu:function(t){return l(this,void 0,void 0,function(){return p(this,function(e){return al(t).Eh(),[2]})})}.bind(null,t),Tu:function(t,e){return l(this,void 0,void 0,function(){return p(this,function(n){switch(n.label){case 0:return e&&al(t)._h?[4,function(t,e){return l(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:return Hs(r=e.code)&&r!==jr.ABORTED?(n=t.Ch.shift(),al(t).Yu(),[4,nl(t,function(){return t.Dh.qh(n.batchId,e)})]):[3,3];case 1:return i.sent(),[4,rl(t)];case 2:i.sent(),i.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return il(t)&&ol(t),[2]}})})}.bind(null,t),wh:function(t){return l(this,void 0,void 0,function(){var e,n,r,i;return p(this,function(o){for(e=al(t),n=0,r=t.Ch;n<r.length;n++)i=r[n],e.fh(i.mutations);return[2]})})}.bind(null,t),dh:function(t,e,n){return l(this,void 0,void 0,function(){var r,i;return p(this,function(o){switch(o.label){case 0:return r=t.Ch.shift(),i=Ka.from(r,e,n),[4,nl(t,function(){return t.Dh.Bh(i)})];case 1:return o.sent(),[4,rl(t)];case 2:return o.sent(),[2]}})})}.bind(null,t)},e.Ih(),new Vf(n,e.Qu,e.credentials,e.Qt,r)),t.$h.push(function(e){return l(i,void 0,void 0,function(){return p(this,function(n){switch(n.label){case 0:return e?(t.Qh.Yu(),[4,rl(t)]):[3,2];case 1:return n.sent(),[3,4];case 2:return[4,t.Qh.stop()];case 3:n.sent(),0<t.Ch.length&&(Nr("RemoteStore","Stopping write stream with "+t.Ch.length+" pending writes"),t.Ch=[]),n.label=4;case 4:return[2]}})})})),t.Qh}var cl=function(){this.Kh=void 0,this.listeners=[]};function hl(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,s;return p(this,function(u){switch(u.label){case 0:if(n=t,r=e.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new cl),!i)return[3,4];u.label=1;case 1:return u.trys.push([1,3,,4]),s=o,[4,n.jh(r)];case 2:return s.Kh=u.sent(),[3,4];case 3:return s=_a(s=u.sent(),"Initialization of query '"+Wo(e.query)+"' failed"),[2,void e.onError(s)];case 4:return n.queries.set(r,o),o.listeners.push(e),e.Gh(n.onlineState),o.Kh&&e.zh(o.Kh)&&ll(n),[2]}})})}function fl(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,s;return p(this,function(u){return n=t,r=e.query,i=!1,(o=n.queries.get(r))&&0<=(s=o.listeners.indexOf(e))&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.Hh(r))]:[2]})})}function ll(t){t.Wh.forEach(function(t){t.next()})}var pl=(wl.prototype.zh=function(t){if(!this.options.includeMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&e.push(i)}t=new lu(t.query,t.docs,t.Se,e,t.De,t.fromCache,t.Ce,!0)}var o=!1;return this.Yh?this.Zh(t)&&(this.Jh.next(t),o=!0):this.tl(t,this.onlineState)&&(this.el(t),o=!0),this.Xh=t,o},wl.prototype.onError=function(t){this.Jh.error(t)},wl.prototype.Gh=function(t){this.onlineState=t;var e=!1;return this.Xh&&!this.Yh&&this.tl(this.Xh,t)&&(this.el(this.Xh),e=!0),e},wl.prototype.tl=function(t,e){if(!t.fromCache)return!0;var n="Offline"!==e;return!(this.options.nl&&n||t.docs.et()&&"Offline"!==e)},wl.prototype.Zh=function(t){if(0<t.docChanges.length)return!0;var e=this.Xh&&this.Xh.hasPendingWrites!==t.hasPendingWrites;return!(!t.Ce&&!e)&&!0===this.options.includeMetadataChanges},wl.prototype.el=function(t){t=lu.Ne(t.query,t.docs,t.De,t.fromCache),this.Yh=!0,this.Jh.next(t)},wl),dl=(bl.prototype.sl=function(){return"metadata"in this.payload},bl),yl=(ml.prototype.Pc=function(t){return Uu(this.Qt,t)},ml.prototype.yc=function(t){return t.metadata.exists?zu(this.Qt,t.document,!1):new Wi(this.Pc(t.metadata.name),this.gc(t.metadata.readTime))},ml.prototype.gc=Lu,ml),vl=(gl.prototype.rl=function(t){this.progress.bytesLoaded+=t.byteLength;var e=this.progress.documentsLoaded;return t.payload.namedQuery?this.queries.push(t.payload.namedQuery):t.payload.documentMetadata?(this.documents.push({metadata:t.payload.documentMetadata}),t.payload.documentMetadata.exists||++e):t.payload.document&&(this.documents[this.documents.length-1].document=t.payload.document,++e),e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null},gl.prototype.ol=function(t){for(var e=new Map,n=new yl(this.Qt),r=0,i=t;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var s=n.Pc(o.metadata.name),u=0,a=o.metadata.queries;u<a.length;u++){var c=a[u],h=(e.get(c)||au()).add(s);e.set(c,h)}}return e},gl.prototype.complete=function(){return l(this,void 0,void 0,function(){var t,e,n,r;return p(this,function(i){switch(i.label){case 0:return[4,function(t,e,n,r){return l(this,void 0,void 0,function(){var i,o,s,u,a,c,h,f,l,d;return p(this,function(p){switch(p.label){case 0:for(i=t,o=au(),s=nu,u=su,a=0,c=n;a<c.length;a++)h=c[a],f=e.Pc(h.metadata.name),h.document&&(o=o.add(f)),s=s.zt(f,e.yc(h)),u=u.zt(f,e.gc(h.metadata.readTime));return l=i.Ec.Nr({Wr:!0}),[4,Ah(i,Qo(jo(si.ot("__bundle__/docs/"+r))))];case 1:return d=p.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",function(t){return Nh(t,l,s,oi.min(),u).next(function(e){return l.apply(t),e}).next(function(e){return i._o.Yi(t,d.targetId).next(function(){return i._o.er(t,o,d.targetId)}).next(function(){return i.Tc.Zo(t,e)})})})]}})})}(this.bh,new yl(this.Qt),this.documents,this.il.id)];case 1:t=i.sent(),e=this.ol(this.documents),n=0,r=this.queries,i.label=2;case 2:return n<r.length?(r=r[n],[4,function(t,e,n){return void 0===n&&(n=au()),l(this,void 0,void 0,function(){var r,i;return p(this,function(o){switch(o.label){case 0:return[4,Ah(t,Qo(uc(e.bundledQuery)))];case 1:return r=o.sent(),[2,(i=t).persistence.runTransaction("Save named query","readwrite",function(t){var o=Lu(e.readTime);return 0<=r.Ot._(o)?i.wo.Ls(t,e):(o=r.Mt(Vr.T,o),i.fc=i.fc.zt(o.targetId,o),i._o.Hi(t,o).next(function(){return i._o.Yi(t,r.targetId)}).next(function(){return i._o.er(t,n,r.targetId)}).next(function(){return i.wo.Ls(t,e)}))})]}})})}(this.bh,r,e.get(r.name))]):[3,5];case 3:i.sent(),i.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new function(t,e){this.progress=t,this.Go=e}(Object.assign({},this.progress),t))]}})})},gl);function gl(t,e,n){this.il=t,this.bh=e,this.Qt=n,this.queries=[],this.documents=[],this.progress=_l(t)}function ml(t){this.Qt=t}function bl(t,e){this.payload=t,this.byteLength=e}function wl(t,e,n){this.query=t,this.Jh=e,this.Yh=!1,this.Xh=null,this.onlineState="Unknown",this.options=n||{}}function _l(t){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:t.totalDocuments,totalBytes:t.totalBytes}}var El=function(t){this.key=t},Il=function(t){this.key=t},Tl=(Object.defineProperty(Dl.prototype,"_l",{get:function(){return this.cl},enumerable:!1,configurable:!0}),Dl.prototype.fl=function(t,e){var n=this,r=e?e.dl:new fu,i=(e||this).ll,o=(e||this).De,s=i,u=!1,a=Fo(this.query)&&i.size===this.query.limit?i.last():null,c=qo(this.query)&&i.size===this.query.limit?i.first():null;if(t.Xt(function(t,e){var h=i.get(t),f=(f=e instanceof Xi?e:null)&&(Jo(n.query,f)?f:null),l=!!h&&n.De.has(h.key),p=!!f&&(f.Vt||n.De.has(f.key)&&f.hasCommittedMutations);e=!1;h&&f?h.data().isEqual(f.data())?l!==p&&(r.track({type:3,doc:f}),e=!0):n.wl(h,f)||(r.track({type:2,doc:f}),e=!0,(a&&0<n.hl(f,a)||c&&n.hl(f,c)<0)&&(u=!0)):!h&&f?(r.track({type:0,doc:f}),e=!0):h&&!f&&(r.track({type:1,doc:h}),e=!0,(a||c)&&(u=!0)),e&&(o=f?(s=s.add(f),p?o.add(t):o.delete(t)):(s=s.delete(t),o.delete(t)))}),Fo(this.query)||qo(this.query))for(;s.size>this.query.limit;){var h=Fo(this.query)?s.last():s.first();s=s.delete(h.key),o=o.delete(h.key);r.track({type:1,doc:h})}return{ll:s,dl:r,lc:u,De:o}},Dl.prototype.wl=function(t,e){return t.Vt&&e.hasCommittedMutations&&!e.Vt},Dl.prototype.wi=function(t,e,n){var r=this,i=this.ll;this.ll=t.ll,this.De=t.De;var o=t.dl.ve();o.sort(function(t,e){return i=t.type,o=e.type,n(i)-n(o)||r.hl(t.doc,e.doc);function n(t){switch(t){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Dr()}}var i,o}),this.El(n);var s=e?this.Tl():[];e=(n=0===this.ul.size&&this.Be?1:0)!==this.al;return this.al=n,0!==o.length||e?{snapshot:new lu(this.query,t.ll,i,o,t.De,0==n,e,!1),Il:s}:{Il:s}},Dl.prototype.Gh=function(t){return this.Be&&"Offline"===t?(this.Be=!1,this.wi({ll:this.ll,dl:new fu,De:this.De,lc:!1},!1)):{Il:[]}},Dl.prototype.ml=function(t){return!this.cl.has(t)&&!!this.ll.has(t)&&!this.ll.get(t).Vt},Dl.prototype.El=function(t){var e=this;t&&(t.qe.forEach(function(t){return e.cl=e.cl.add(t)}),t.Ue.forEach(function(t){}),t.Qe.forEach(function(t){return e.cl=e.cl.delete(t)}),this.Be=t.Be)},Dl.prototype.Tl=function(){var t=this;if(!this.Be)return[];var e=this.ul;this.ul=au(),this.ll.forEach(function(e){t.ml(e.key)&&(t.ul=t.ul.add(e.key))});var n=[];return e.forEach(function(e){t.ul.has(e)||n.push(new Il(e))}),this.ul.forEach(function(t){e.has(t)||n.push(new El(t))}),n},Dl.prototype.Al=function(t){return this.cl=t.Rc,this.ul=au(),t=this.fl(t.documents),this.wi(t,!0)},Dl.prototype.Rl=function(){return lu.Ne(this.query,this.ll,this.De,0===this.al)},Dl),Nl=function(t,e,n){this.query=t,this.targetId=e,this.view=n},Al=function(t){this.key=t,this.Pl=!1},Sl=(Object.defineProperty(xl.prototype,"Ml",{get:function(){return!0===this.kl},enumerable:!1,configurable:!0}),xl);function xl(t,e,n,r,i,o){this.bh=t,this.yl=e,this.gl=n,this.Vl=r,this.currentUser=i,this.pl=o,this.bl={},this.vl=new Ic(Xo,Ko),this.Sl=new Map,this.Dl=new Set,this.Cl=new Ys(ci.H),this.xl=new Map,this.Nl=new Lh,this.$l={},this.Fl=new Map,this.Ol=Lc.Li(),this.onlineState="Unknown",this.kl=void 0}function Dl(t,e){this.query=t,this.cl=e,this.al=null,this.Be=!1,this.ul=au(),this.De=au(),this.hl=Zo(t),this.ll=new hu(this.hl)}function Ol(t,e,n,r){return l(this,void 0,void 0,function(){var i,o,s;return p(this,function(u){switch(u.label){case 0:return t.Ll=function(e,n,r){return function(t,e,n,r){return l(this,void 0,void 0,function(){var i,o;return p(this,function(s){switch(s.label){case 0:return(i=e.view.fl(n)).lc?[4,xh(t.bh,e.query,!1).then(function(t){return t=t.documents,e.view.fl(t,i)})]:[3,2];case 1:i=s.sent(),s.label=2;case 2:return o=r&&r.$e.get(e.targetId),o=e.view.wi(i,t.Ml,o),[2,(jl(t,e.targetId,o.Il),o.snapshot)]}})})}(t,e,n,r)},[4,xh(t.bh,e,!0)];case 1:return o=u.sent(),s=new Tl(e,o.Rc),i=s.fl(o.documents),o=du.Le(n,r&&"Offline"!==t.onlineState),o=s.wi(i,t.Ml,o),jl(t,n,o.Il),s=new Nl(e,n,s),[2,(t.vl.set(e,s),t.Sl.has(n)?t.Sl.get(n).push(e):t.Sl.set(n,[e]),o.snapshot)]}})})}function kl(t,e,n){return l(this,void 0,void 0,function(){var r,i;return p(this,function(o){switch(o.label){case 0:i=Hl(t),o.label=1;case 1:return o.trys.push([1,5,,6]),[4,(c=i.bh,h=e,l=c,p=ii.now(),d=h.reduce(function(t,e){return t.add(e.key)},au()),l.persistence.runTransaction("Locally write mutations","readwrite",function(t){return l.Tc.Xo(t,d).next(function(e){f=e;for(var n,r=[],i=0,o=h;i<o.length;i++){var s=o[i],u=(n=s,u=f.get(s.key),function(t,e){for(var n=null,r=0,i=t;r<i.length;r++){var o=i[r],s=e instanceof Xi?e.field(o.field):void 0;null!=(s=is(o.transform,s||null))&&(n=(null==n?new Gi:n).set(o.field,s))}return n?n.Pt():null}(n.fieldTransforms,u));null!=u&&r.push(new ks(s.key,u,function t(e){var n=[];return gi(e.fields||{},function(e,r){var i=new ai([e]);if(qi(r))if(0===(r=t(r.mapValue).fields).length)n.push(i);else for(var o=0,s=r;o<s.length;o++){var u=s[o];n.push(i.child(u))}else n.push(i)}),new bi(n)}(u.proto.mapValue),Es.exists(!0)))}return l.zo.Ri(t,p,r,h)})}).then(function(t){var e=t.xs(f);return{batchId:t.batchId,ri:e}}))];case 2:return r=o.sent(),i.Vl.Ca(r.batchId),s=i,u=r.batchId,a=n,c=(c=(c=s.$l[s.currentUser.A()])||new Ys(Cr)).zt(u,a),s.$l[s.currentUser.A()]=c,[4,ql(i,r.ri)];case 3:return o.sent(),[4,rl(i.yl)];case 4:return o.sent(),[3,6];case 5:return i=_a(i=o.sent(),"Failed to persist write"),n.reject(i),[3,6];case 6:return[2]}var s,u,a,c,h,f,l,p,d})})}function Pl(t,e){return l(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:n=t,i.label=1;case 1:return i.trys.push([1,4,,6]),[4,function(t,e){var n=t,r=e.Ot,i=n.fc;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(t){var o=n.Ec.Nr({Wr:!0});i=n.fc;var s=[];e.$e.forEach(function(e,o){var u,a,c,h=i.get(o);h&&(s.push(n._o.sr(t,e.Qe,o).next(function(){return n._o.er(t,e.qe,o)})),0<(c=e.resumeToken).l()&&(u=h.Mt(c,r).kt(t.bs),i=i.zt(o,u),a=h,c=e,Or(0<(h=u).resumeToken.l()),(0===a.resumeToken.l()||3e8<=h.Ot.W()-a.Ot.W()||0<c.qe.size+c.Ue.size+c.Qe.size)&&s.push(n._o.Hi(t,u))))});var u,a=nu;return e.Oe.forEach(function(r,i){e.ke.has(r)&&s.push(n.persistence.Ti.Fr(t,r))}),s.push(Nh(t,o,e.Oe,r,void 0).next(function(t){a=t})),r.isEqual(oi.min())||(u=n._o.Qi(t).next(function(e){return n._o.Wi(t,t.bs,r)}),s.push(u)),ra.Mn(s).next(function(){return o.apply(t)}).next(function(){return n.Tc.Zo(t,a)})}).then(function(t){return n.fc=i,t})}(n.bh,e)];case 2:return r=i.sent(),e.$e.forEach(function(t,e){(e=n.xl.get(e))&&(Or(t.qe.size+t.Ue.size+t.Qe.size<=1),0<t.qe.size?e.Pl=!0:0<t.Ue.size?Or(e.Pl):0<t.Qe.size&&(Or(e.Pl),e.Pl=!1))}),[4,ql(n,r,e)];case 3:return i.sent(),[3,6];case 4:return[4,Ec(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}})})}function Cl(t,e,n){var r;((t=t).Ml&&0===n||!t.Ml&&1===n)&&(r=[],t.vl.forEach(function(t,n){(n=n.view.Gh(e)).snapshot&&r.push(n.snapshot)}),function(t,e){t.onlineState=e;var n=!1;t.queries.forEach(function(t,r){for(var i=0,o=r.listeners;i<o.length;i++)o[i].Gh(e)&&(n=!0)}),n&&ll(t)}(t.gl,e),r.length&&t.bl.ah(r),t.onlineState=e,t.Ml&&t.Vl.Qa(e))}function Ll(t,e){return l(this,void 0,void 0,function(){var n,r,i;return p(this,function(o){switch(o.label){case 0:$f((n=t).yl)||Nr("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,(s=n.bh).persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(t){return s.zo.Vi(t)})];case 2:return-1===(r=o.sent())?[2,void e.resolve()]:((i=n.Fl.get(r)||[]).push(e),n.Fl.set(r,i),[3,4]);case 3:return i=_a(i=o.sent(),"Initialization of waitForPendingWrites() operation failed"),e.reject(i),[3,4];case 4:return[2]}var s})})}function Rl(t,e){(t.Fl.get(e)||[]).forEach(function(t){t.resolve()}),t.Fl.delete(e)}function Vl(t,e,n){var r=t,i=r.$l[r.currentUser.A()];i&&((t=i.get(e))&&(n?t.reject(n):t.resolve(),i=i.remove(e)),r.$l[r.currentUser.A()]=i)}function Ml(t,e,n){void 0===n&&(n=null),t.Vl.ka(e);for(var r=0,i=t.Sl.get(e);r<i.length;r++){var o=i[r];t.vl.delete(o),n&&t.bl.Bl(o,n)}t.Sl.delete(e),t.Ml&&t.Nl.Fc(e).forEach(function(e){t.Nl.Fi(e)||Ul(t,e)})}function Ul(t,e){t.Dl.delete(e.path.rt());var n=t.Cl.get(e);null!==n&&(Kf(t.yl,n),t.Cl=t.Cl.remove(e),t.xl.delete(n),Fl(t))}function jl(t,e,n){for(var r,i,o,s=0,u=n;s<u.length;s++){var a=u[s];a instanceof El?(t.Nl.nr(a.key,e),r=t,o=void 0,i=(o=(i=a).key).path.rt(),r.Cl.get(o)||r.Dl.has(i)||(Nr("SyncEngine","New document in limbo: "+o),r.Dl.add(i),Fl(r))):a instanceof Il?(Nr("SyncEngine","Document no longer in limbo: "+a.key),t.Nl.ir(a.key,e),t.Nl.Fi(a.key)||Ul(t,a.key)):Dr()}}function Fl(t){for(;0<t.Dl.size&&t.Cl.size<t.pl;){var e=t.Dl.values().next().value;t.Dl.delete(e);var n=new ci(si.ot(e));e=t.Ol.next();t.xl.set(e,new Al(n)),t.Cl=t.Cl.zt(n,e),Yf(t.yl,new $o(Qo(jo(n.path)),e,2,Wr.q))}}function ql(t,e,n){return l(this,void 0,void 0,function(){var r,i,o,s;return p(this,function(u){switch(u.label){case 0:return i=[],o=[],s=[],(r=t).vl.et()?[3,3]:(r.vl.forEach(function(t,u){s.push(r.Ll(u,e,n).then(function(t){t&&(r.Ml&&r.Vl.Ba(u.targetId,t.fromCache?"not-current":"current"),i.push(t),t=yh.oc(u.targetId,t),o.push(t))}))}),[4,Promise.all(s)]);case 1:return u.sent(),r.bl.ah(i),[4,function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,s,u,a;return p(this,function(c){switch(c.label){case 0:n=t,c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(t){return ra.forEach(e,function(e){return ra.forEach(e.ic,function(r){return n.persistence.Ti.nr(t,e.targetId,r)}).next(function(){return ra.forEach(e.rc,function(r){return n.persistence.Ti.ir(t,e.targetId,r)})})})})];case 2:return c.sent(),[3,4];case 3:if(!pa(r=c.sent()))throw r;return Nr("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=e;i<o.length;i++)a=o[i],s=a.targetId,a.fromCache||(u=n.fc.get(s),a=u.Ot,a=u.Lt(a),n.fc=n.fc.zt(s,a));return[2]}})})}(r.bh,o)];case 2:u.sent(),u.label=3;case 3:return[2]}})})}function Bl(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c,h,f,d,y;return p(this,function(v){switch(v.label){case 0:n=t,r=[],i=[],o=0,s=e,v.label=1;case 1:return o<s.length?(u=s[o],a=void 0,(c=n.Sl.get(u))&&0!==c.length?[4,Ah(n.bh,Qo(c[0]))]:[3,7]):[3,13];case 2:a=v.sent(),h=0,f=c,v.label=3;case 3:return h<f.length?(d=f[h],d=n.vl.get(d),[4,function(t,e){return l(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:return[4,xh((n=t).bh,e.query,!0)];case 1:return r=i.sent(),r=e.view.Al(r),[2,(n.Ml&&jl(n,e.targetId,r.Il),r)]}})})}(n,d)]):[3,6];case 4:(d=v.sent()).snapshot&&i.push(d.snapshot),v.label=5;case 5:return h++,[3,3];case 6:return[3,11];case 7:return[4,Dh(n.bh,u)];case 8:return y=v.sent(),[4,Ah(n.bh,y)];case 9:return a=v.sent(),[4,Ol(n,Gl(y),u,!1)];case 10:v.sent(),v.label=11;case 11:r.push(a),v.label=12;case 12:return o++,[3,1];case 13:return[2,(n.bl.ah(i),r)]}})})}function Gl(t){return Uo(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function zl(t){return t.yl.Dh.Lh=Pl.bind(null,t),t.yl.Dh.vn=function(t,e){var n=t;if((t=n.xl.get(e))&&t.Pl)return au().add(t.key);var r=au();if(!(e=n.Sl.get(e)))return r;for(var i=0,o=e;i<o.length;i++){var s=o[i];s=n.vl.get(s),r=r.Pe(s.view._l)}return r}.bind(null,t),t.yl.Dh.Mh=function(t,e,n){return l(this,void 0,void 0,function(){var r,i,o,s;return p(this,function(u){switch(u.label){case 0:return(r=t).Vl.Ba(e,"rejected",n),s=r.xl.get(e),(i=s&&s.key)?(o=(o=new Ys(ci.H)).zt(i,new Wi(i,oi.min())),s=au().add(i),s=new pu(oi.min(),new Map,new tu(Cr),o,s),[4,Pl(r,s)]):[3,2];case 1:return u.sent(),r.Cl=r.Cl.remove(i),r.xl.delete(e),Fl(r),[3,4];case 2:return[4,Sh(r.bh,e,!1).then(function(){return Ml(r,e,n)}).catch(Ec)];case 3:u.sent(),u.label=4;case 4:return[2]}})})}.bind(null,t),t.bl.ah=function(t,e){for(var n=t,r=!1,i=0,o=e;i<o.length;i++){var s=o[i],u=s.query;if(u=n.queries.get(u)){for(var a=0,c=u.listeners;a<c.length;a++)c[a].zh(s)&&(r=!0);u.Kh=s}}r&&ll(n)}.bind(null,t.gl),t.bl.Bl=function(t,e,n){var r=t;if(t=r.queries.get(e))for(var i=0,o=t.listeners;i<o.length;i++)o[i].onError(n);r.queries.delete(e)}.bind(null,t.gl),t}function Hl(t){return t.yl.Dh.Bh=function(t,e){return l(this,void 0,void 0,function(){var n,r,i;return p(this,function(o){switch(o.label){case 0:n=t,r=e.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(t,e){var n=t;return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(t){var r,i,o,s,u,a,c,h=e.batch.keys(),f=n.Ec.Nr({Wr:!0});return r=n,i=t,s=f,a=(u=(o=e).batch).keys(),c=ra.resolve(),a.forEach(function(t){c=c.next(function(){return s._i(i,t)}).next(function(e){var n=e;Or(null!==(e=o.$s.get(t))),(!n||n.version._(e)<0)&&(n=u.Ss(t,n,o))&&s.ai(n,o.Ns)})}),c.next(function(){return r.zo.Ci(i,u)}).next(function(){return f.apply(t)}).next(function(){return n.zo.$i(t)}).next(function(){return n.Tc.Xo(t,h)})})}(n.bh,e)];case 2:return i=o.sent(),Vl(n,r,null),Rl(n,r),n.Vl.Na(r,"acknowledged"),[4,ql(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ec(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}.bind(null,t),t.yl.Dh.qh=function(t,e,n){return l(this,void 0,void 0,function(){var r,i;return p(this,function(o){switch(o.label){case 0:r=t,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,(s=r.bh,u=e,(a=s).persistence.runTransaction("Reject batch","readwrite-primary",function(t){var e;return a.zo.Pi(t,u).next(function(n){return Or(null!==n),e=n.keys(),a.zo.Ci(t,n)}).next(function(){return a.zo.$i(t)}).next(function(){return a.Tc.Xo(t,e)})}))];case 2:return i=o.sent(),Vl(r,e,n),Rl(r,e),r.Vl.Na(e,"rejected",n),[4,ql(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Ec(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}var s,u,a})})}.bind(null,t),t}function Ql(t,e,n){var r=t;(function(t,e,n){return l(this,void 0,void 0,function(){var r,i,o,s,u;return p(this,function(a){switch(a.label){case 0:return a.trys.push([0,14,,15]),[4,e.getMetadata()];case 1:return r=a.sent(),[4,(f=t.bh,p=f,d=Lu((l=r).createTime),p.persistence.runTransaction("hasNewerBundle","readonly",function(t){return p.wo.Os(t,l.id)}).then(function(t){return!!t&&0<=t.createTime._(d)}))];case 2:return a.sent()?[4,e.close()]:[3,4];case 3:return[2,(a.sent(),void n.ql({taskState:"Success",documentsLoaded:r.totalDocuments,bytesLoaded:r.totalBytes,totalDocuments:r.totalDocuments,totalBytes:r.totalBytes}))];case 4:return n.Ul(_l(r)),i=new vl(r,t.bh,e.Qt),[4,e.Ql()];case 5:o=a.sent(),a.label=6;case 6:return o?[4,i.rl(o)]:[3,10];case 7:return(s=a.sent())&&n.Ul(s),[4,e.Ql()];case 8:o=a.sent(),a.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return u=a.sent(),[4,ql(t,u.Go,void 0)];case 12:return a.sent(),[4,(f=t.bh,c=r,(h=f).persistence.runTransaction("Save bundle","readwrite",function(t){return h.wo.ks(t,c)}))];case 13:return a.sent(),n.ql(u.progress),[3,15];case 14:return Sr("SyncEngine","Loading bundle failed with "+(u=a.sent())),n.Kl(u),[3,15];case 15:return[2]}var c,h,f,l,p,d})})})(r,e,n).then(function(){r.Vl.Wa()})}var Yl,Kl,Xl=(np.prototype.initialize=function(t){return l(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return this.Qt=Of(t.yu.t),this.Vl=this.Wl(t),this.persistence=this.jl(t),[4,this.persistence.start()];case 1:return e.sent(),this.Gl=this.zl(t),this.bh=this.Hl(t),[2]}})})},np.prototype.zl=function(t){return null},np.prototype.Hl=function(t){return Eh(this.persistence,new vh,t.Jl,this.Qt)},np.prototype.jl=function(t){return new Fh(Bh.ia,this.Qt)},np.prototype.Wl=function(t){return new hf},np.prototype.terminate=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return this.Gl&&this.Gl.stop(),[4,this.Vl.ko()];case 1:return t.sent(),[4,this.persistence.ko()];case 2:return t.sent(),[2]}})})},np),Wl=(f(ep,Kl=Xl),ep.prototype.initialize=function(t){return l(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,Kl.prototype.initialize.call(this,t)];case 1:return e.sent(),[4,function(t){return l(this,void 0,void 0,function(){var e;return p(this,function(n){return[2,(e=t).persistence.runTransaction("Synchronize last document change read time","readonly",function(t){return t=rh(t),e=oi.min(),t.hs({index:Ca.readTimeIndex,reverse:!0},function(t,n,r){n.readTime&&(e=ec(n.readTime)),r.done()}).next(function(){return e});var e}).then(function(t){e.wc=t})]})})}(this.bh)];case 2:return e.sent(),[4,this.Yl.initialize(this,t)];case 3:return e.sent(),[4,Hl(this.Yl._a)];case 4:return e.sent(),[4,rl(this.Yl.yl)];case 5:return e.sent(),[2]}})})},ep.prototype.Hl=function(t){return Eh(this.persistence,new vh,t.Jl,this.Qt)},ep.prototype.zl=function(t){var e=this.persistence.Ti.lr;return new Gc(e,t._s)},ep.prototype.jl=function(t){var e=ph(t.yu.t,t.yu.persistenceKey),n=void 0!==this.cacheSizeBytes?wc.Ys(this.cacheSizeBytes):wc.ti;return new ch(this.synchronizeTabs,e,t.clientId,n,t._s,xf(),Df(),this.Qt,this.Vl,!!this.forceOwnership)},ep.prototype.Wl=function(t){return new hf},ep),Jl=(f(tp,Yl=Wl),tp.prototype.initialize=function(t){return l(this,void 0,void 0,function(){var e,n=this;return p(this,function(r){switch(r.label){case 0:return[4,Yl.prototype.initialize.call(this,t)];case 1:return r.sent(),e=this.Yl._a,this.Vl instanceof cf?(this.Vl._a={eu:function(t,e,n,r){return l(this,void 0,void 0,function(){var i,o;return p(this,function(s){switch(s.label){case 0:return[4,(u=(i=t).bh,a=e,h=(c=u).zo,c.persistence.runTransaction("Lookup mutation documents","readonly",function(t){return h.yi(t,a).next(function(e){return e?c.Tc.Xo(t,e):ra.resolve(null)})}))];case 1:return null===(o=s.sent())?[3,6]:"pending"!==n?[3,3]:[4,rl(i.yl)];case 2:return s.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Vl(i,e,r||null),Rl(i,e),i.bh.zo.xi(e)):Dr(),s.label=4;case 4:return[4,ql(i,o)];case 5:return s.sent(),[3,7];case 6:Nr("SyncEngine","Cannot apply mutation batch with id: "+e),s.label=7;case 7:return[2]}var u,a,c,h})})}.bind(null,e),nu:function(t,e,n,r){return l(this,void 0,void 0,function(){var i,o,s;return p(this,function(u){switch(u.label){case 0:return(i=t).kl?(Nr("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Sl.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Oh(i.bh)];case 3:return o=u.sent(),s=pu.Me(e,"current"===n),[4,ql(i,o,s)];case 4:return u.sent(),[3,8];case 5:return[4,Sh(i.bh,e,!0)];case 6:return u.sent(),Ml(i,e,r),[3,8];case 7:Dr(),u.label=8;case 8:return[2]}})})}.bind(null,e),su:function(t,e,n){return l(this,void 0,void 0,function(){var r,i,o,s,u,a,c,h;return p(this,function(f){switch(f.label){case 0:if(!(r=zl(t)).kl)return[3,10];i=0,o=e,f.label=1;case 1:return i<o.length?(o=o[i],r.Sl.has(o)?(Nr("SyncEngine","Adding an already active target "+o),[3,5]):[4,Dh(r.bh,o)]):[3,6];case 2:return s=f.sent(),[4,Ah(r.bh,s)];case 3:return u=f.sent(),[4,Ol(r,Gl(s),u.targetId,!1)];case 4:f.sent(),Yf(r.yl,u),f.label=5;case 5:return i++,[3,1];case 6:a=function(t){return p(this,function(e){switch(e.label){case 0:return r.Sl.has(t)?[4,Sh(r.bh,t,!1).then(function(){Kf(r.yl,t),Ml(r,t)}).catch(Ec)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})},c=0,h=n,f.label=7;case 7:return c<h.length?(h=h[c],[5,a(h)]):[3,10];case 8:f.sent(),f.label=9;case 9:return c++,[3,7];case 10:return[2]}})})}.bind(null,e),Uo:function(t){return t.bh.persistence.Uo()}.bind(null,e),tu:function(t){return l(this,void 0,void 0,function(){var e;return p(this,function(n){return[2,Oh((e=t).bh).then(function(t){return ql(e,t)})]})})}.bind(null,e)},[4,this.Vl.start()]):[3,3];case 2:r.sent(),r.label=3;case 3:return[4,this.persistence.Ro(function(t){return l(n,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return[4,function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,s,u,a,c;return p(this,function(h){switch(h.label){case 0:return zl(n=t),Hl(n),!0!==e||!0===n.kl?[3,3]:(r=n.Vl.va(),[4,Bl(n,r.it())]);case 1:return i=h.sent(),n.kl=!0,[4,sl(n.yl,!0)];case 2:for(h.sent(),o=0,s=i;o<s.length;o++)u=s[o],Yf(n.yl,u);return[3,7];case 3:return!1!==e||!1===n.kl?[3,7]:(a=[],c=Promise.resolve(),n.Sl.forEach(function(t,e){n.Vl.Ma(e)?a.push(e):c=c.then(function(){return Ml(n,e),Sh(n.bh,e,!0)}),Kf(n.yl,e)}),[4,c]);case 4:return h.sent(),[4,Bl(n,a)];case 5:return h.sent(),(f=n).xl.forEach(function(t,e){Kf(f.yl,e)}),f.Nl.Oc(),f.xl=new Map,f.Cl=new Ys(ci.H),n.kl=!1,[4,sl(n.yl,!1)];case 6:h.sent(),h.label=7;case 7:return[2]}var f})})}(this.Yl._a,t)];case 1:return e.sent(),this.Gl&&(t&&!this.Gl.Er?this.Gl.start(this.bh):t||this.Gl.stop()),[2]}})})})];case 4:return r.sent(),[2]}})})},tp.prototype.Wl=function(t){var e=xf();if(!cf.Kn(e))throw new Fr(jr.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=ph(t.yu.t,t.yu.persistenceKey);return new cf(e,t._s,n,t.clientId,t.Jl)},tp),Zl=($l.prototype.initialize=function(t,e){return l(this,void 0,void 0,function(){var n=this;return p(this,function(r){switch(r.label){case 0:return this.bh?[3,2]:(this.bh=t.bh,this.Vl=t.Vl,this.Sh=this.Xl(e),this.yl=this.Zl(e),this.gl=this.t_(e),this._a=this.e_(e,!t.synchronizeTabs),this.Vl.fa=function(t){return Cl(n._a,t,1)},this.yl.Dh.n_=function(t,e){return l(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:return(n=t).currentUser.isEqual(e)?[3,3]:(Nr("SyncEngine","User change. New user:",e.A()),[4,Ih(n.bh,e)]);case 1:return r=i.sent(),n.currentUser=e,(o=n).Fl.forEach(function(t){t.forEach(function(t){t.reject(new Fr(jr.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),o.Fl.clear(),n.Vl.Ua(e,r.mc,r.Ac),[4,ql(n,r.Ic)];case 2:i.sent(),i.label=3;case 3:return[2]}var o})})}.bind(null,this._a),[4,sl(this.yl,this._a.Ml)]);case 1:r.sent(),r.label=2;case 2:return[2]}})})},$l.prototype.t_=function(t){return new function(){this.queries=new Ic(Xo,Ko),this.onlineState="Unknown",this.Wh=new Set}},$l.prototype.Xl=function(t){var e=Of(t.yu.t),n=(n=t.yu,new yf(n));return t=t.credentials,new Mf(t,n,e)},$l.prototype.Zl=function(t){var e=this;return new function(t,e,n,r,i){var o=this;this.bh=t,this.Sh=e,this._s=n,this.Dh={},this.Ch=[],this.xh=new Map,this.Nh=new Set,this.$h=[],this.Fh=i,this.Fh.ou(function(t){n.Ps(function(){return l(o,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return $f(this)?(Nr("RemoteStore","Restarting streams for network reachability change."),[4,function(t){return l(this,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return(e=t).Nh.add(4),[4,Qf(e)];case 1:return n.sent(),e.Oh.set("Unknown"),e.Nh.delete(4),[4,Hf(e)];case 2:return n.sent(),[2]}})})}(this)]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})})}),this.Oh=new Uf(n,r)}(this.bh,this.Sh,t._s,function(t){return Cl(e._a,t,0)},t=new(lf.Kn()?lf:ff))},$l.prototype.e_=function(t,e){return function(t,e,n,r,i,o,s){return o=new Sl(t,e,n,r,i,o),s&&(o.kl=!0),o}(this.bh,this.yl,this.gl,this.Vl,t.Jl,t.pl,e)},$l.prototype.terminate=function(){return function(t){return l(this,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return e=t,Nr("RemoteStore","RemoteStore shutting down."),e.Nh.add(5),[4,Qf(e)];case 1:return n.sent(),e.Fh.ko(),e.Oh.set("Unknown"),[2]}})})}(this.yl)},$l);function $l(){}function tp(t,e){var n=this;return(n=Yl.call(this,t,e,!1)||this).Yl=t,n.cacheSizeBytes=e,n.synchronizeTabs=!0,n}function ep(t,e,n){var r=this;return(r=Kl.call(this)||this).Yl=t,r.cacheSizeBytes=e,r.forceOwnership=n,r.synchronizeTabs=!1,r}function np(){this.synchronizeTabs=!1}function rp(t,e){void 0===e&&(e=10240);var n=0;return{read:function(){return l(this,void 0,void 0,function(){var r;return p(this,function(i){return n<t.byteLength?(r={value:t.slice(n,n+e),done:!1},[2,(n+=e,r)]):[2,{done:!0}]})})},cancel:function(){return l(this,void 0,void 0,function(){return p(this,function(t){return[2]})})},releaseLock:function(){}}}var ip=(fp.prototype.next=function(t){this.observer.next&&this.s_(this.observer.next,t)},fp.prototype.error=function(t){this.observer.error?this.s_(this.observer.error,t):console.error("Uncaught Error in snapshot listener:",t)},fp.prototype.i_=function(){this.muted=!0},fp.prototype.s_=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},fp),op=(hp.prototype.close=function(){return this.r_.cancel()},hp.prototype.getMetadata=function(){return l(this,void 0,void 0,function(){return p(this,function(t){return[2,this.metadata.promise]})})},hp.prototype.Ql=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.getMetadata()];case 1:return[2,(t.sent(),this.c_())]}})})},hp.prototype.c_=function(){return l(this,void 0,void 0,function(){var t,e,n;return p(this,function(r){switch(r.label){case 0:return[4,this.a_()];case 1:return null===(t=r.sent())?[2,null]:(n=this.o_.decode(t),e=Number(n),isNaN(e)&&this.u_("length string ("+n+") is not valid number"),[4,this.h_(e)]);case 2:return n=r.sent(),[2,new dl(JSON.parse(n),t.length+e)]}})})},hp.prototype.l_=function(){return this.buffer.findIndex(function(t){return t==="{".charCodeAt(0)})},hp.prototype.a_=function(){return l(this,void 0,void 0,function(){var t,e;return p(this,function(n){switch(n.label){case 0:return this.l_()<0?[4,this.__()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((t=this.l_())<0&&this.u_("Reached the end of bundle when a length string is expected."),e=this.buffer.slice(0,t),[2,(this.buffer=this.buffer.slice(t),e)])}})})},hp.prototype.h_=function(t){return l(this,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return this.buffer.length<t?[4,this.__()]:[3,3];case 1:n.sent()&&this.u_("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return e=this.o_.decode(this.buffer.slice(0,t)),[2,(this.buffer=this.buffer.slice(t),e)]}})})},hp.prototype.u_=function(t){throw this.r_.cancel(),new Error("Invalid bundle format: "+t)},hp.prototype.__=function(){return l(this,void 0,void 0,function(){var t,e;return p(this,function(n){switch(n.label){case 0:return[4,this.r_.read()];case 1:return(t=n.sent()).done||((e=new Uint8Array(this.buffer.length+t.value.length)).set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e),[2,t.done]}})})},hp),sp=(cp.prototype.isEqual=function(t){return this.f_.isEqual(t.f_)},cp),up=function(t){this._methodName=t},ap=function(t){this.d_=t};function cp(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=0;n<t.length;++n)if(0===t[n].length)throw new Fr(jr.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this.f_=new ai(t)}function hp(t,e){var n=this;this.r_=t,this.Qt=e,this.metadata=new na,this.buffer=new Uint8Array,this.o_=new TextDecoder("utf-8"),this.c_().then(function(t){t&&t.sl()?n.metadata.resolve(t.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==t?void 0:t.payload)))},function(t){return n.metadata.reject(t)})}function fp(t){this.observer=t,this.muted=!1}function lp(t,e,n){if(!n)throw new Fr(jr.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function pp(t,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new Fr(jr.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function dp(t,e,n,r){if(!0===e&&!0===r)throw new Fr(jr.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function yp(t){if(!ci.wt(t))throw new Fr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function vp(t){if(ci.wt(t))throw new Fr(jr.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function gp(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"==typeof t)return 20<t.length&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"==typeof t||"boolean"==typeof t)return""+t;if("object"!=typeof t)return"function"==typeof t?"a function":Dr();if(t instanceof Array)return"an array";var e=function(){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/.exec(t.constructor.toString());if(e&&1<e.length)return e[1]}return null}();return e?"a custom "+e+" object":"an object"}function mp(t,e){if((t="_delegate"in t?t.d_:t)instanceof e)return t;if(e.name===t.constructor.name)throw new Fr(jr.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");throw t=gp(t),new Fr(jr.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+t)}function bp(t,e){if(e<=0)throw new Fr(jr.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}var wp,_p=(kp.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties},kp),Ep=new Map,Ip=(Object.defineProperty(Op.prototype,"app",{get:function(){if(!this.A_)throw new Fr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.A_},enumerable:!1,configurable:!0}),Object.defineProperty(Op.prototype,"R_",{get:function(){return this.T_},enumerable:!1,configurable:!0}),Object.defineProperty(Op.prototype,"P_",{get:function(){return void 0!==this.y_},enumerable:!1,configurable:!0}),Op.prototype.g_=function(t){if(this.T_)throw new Fr(jr.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this.E_=new _p(t),void 0!==t.credentials&&(this.m_=function(t){if(!t)return new Qr;switch(t.type){case"gapi":var e=t.client;return Or(!("object"!=typeof e||null===e||!e.auth||!e.auth.getAuthHeaderValueForFirstParty)),new Xr(e,t.sessionIndex||"0");case"provider":return t.client;default:throw new Fr(jr.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(t.credentials))},Op.prototype.V_=function(){return this.E_},Op.prototype.p_=function(){return this.T_=!0,this.E_},Op.prototype._delete=function(){return this.y_||(this.y_=this.b_()),this.y_},Op.prototype.toJSON=function(){return{app:this.A_,t:this.I_,settings:this.E_}},Op.prototype.b_=function(){return(t=Ep.get(this))&&(Nr("ComponentProvider","Removing Datastore"),Ep.delete(this),t.terminate()),Promise.resolve();var t},Op),Tp=(Object.defineProperty(Dp.prototype,"D_",{get:function(){return this.S_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"path",{get:function(){return this.S_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(Dp.prototype,"parent",{get:function(){return new Ap(this.firestore,this.v_,this.S_.path.X())},enumerable:!1,configurable:!0}),Dp.prototype.withConverter=function(t){return new Dp(this.firestore,t,this.S_)},Dp),Np=(xp.prototype.withConverter=function(t){return new xp(this.firestore,t,this.C_)},xp),Ap=(f(Sp,wp=Np),Object.defineProperty(Sp.prototype,"id",{get:function(){return this.C_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"path",{get:function(){return this.C_.path.rt()},enumerable:!1,configurable:!0}),Object.defineProperty(Sp.prototype,"parent",{get:function(){var t=this.D_.X();return t.et()?null:new Tp(this.firestore,null,new ci(t))},enumerable:!1,configurable:!0}),Sp.prototype.withConverter=function(t){return new Sp(this.firestore,t,this.D_)},Sp);function Sp(t,e,n){var r=this;return(r=wp.call(this,t,e,jo(n))||this).firestore=t,r.D_=n,r.type="collection",r}function xp(t,e,n){this.v_=e,this.C_=n,this.type="query",this.firestore=t}function Dp(t,e,n){this.v_=e,this.S_=n,this.type="document",this.firestore=t}function Op(t,e){this.w_="(lite)",this.E_=new _p({}),this.T_=!1,t instanceof _r?(this.I_=t,this.m_=new Qr):(this.A_=t,this.I_=function(t){if(!Object.prototype.hasOwnProperty.apply(t.options,["projectId"]))throw new Fr(jr.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new _r(t.options.projectId)}(t),this.m_=new Yr(e))}function kp(t){var e;if(void 0===t.host){if(void 0!==t.ssl)throw new Fr(jr.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=null===(e=t.ssl)||void 0===e||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,void 0===t.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==t.cacheSizeBytes&&t.cacheSizeBytes<1048576)throw new Fr(jr.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,dp("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling)}function Pp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof ap&&(t=t.d_),lp("collection","path",e),t instanceof Ip)return vp(n=si.ot.apply(si,d([e],r))),new Ap(t,null,n);if(!(t instanceof Tp||t instanceof Ap))throw new Fr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return vp(n=si.ot.apply(si,d([t.path],r)).child(si.ot(e))),new Ap(t.firestore,null,n)}function Cp(t,e){for(var n,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];if(t instanceof ap&&(t=t.d_),lp("doc","path",e=1===arguments.length?kr.u():e),t instanceof Ip)return yp(n=si.ot.apply(si,d([e],r))),new Tp(t,null,new ci(n));if(!(t instanceof Tp||t instanceof Ap))throw new Fr(jr.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return yp(n=t.D_.child(si.ot.apply(si,d([e],r)))),new Tp(t.firestore,t instanceof Ap?t.v_:null,new ci(n))}function Lp(t,e){return t instanceof ap&&(t=t.d_),e instanceof ap&&(e=e.d_),(t instanceof Tp||t instanceof Ap)&&(e instanceof Tp||e instanceof Ap)&&t.firestore===e.firestore&&t.path===e.path&&t.v_===e.v_}function Rp(t,e){return t instanceof ap&&(t=t.d_),e instanceof ap&&(e=e.d_),t instanceof Np&&e instanceof Np&&t.firestore===e.firestore&&Ko(t.C_,e.C_)&&t.v_===e.v_}var Vp=(Object.defineProperty(Bp.prototype,"latitude",{get:function(){return this.x_},enumerable:!1,configurable:!0}),Object.defineProperty(Bp.prototype,"longitude",{get:function(){return this.N_},enumerable:!1,configurable:!0}),Bp.prototype.isEqual=function(t){return this.x_===t.x_&&this.N_===t.N_},Bp.prototype.toJSON=function(){return{latitude:this.x_,longitude:this.N_}},Bp.prototype.U=function(t){return Cr(this.x_,t.x_)||Cr(this.N_,t.N_)},Bp),Mp=/^__.*__$/,Up=(qp.prototype.F_=function(t,e){return null!==this.Gt?new ks(t,this.data,this.Gt,e,this.fieldTransforms):new Os(t,this.data,e,this.fieldTransforms)},qp),jp=(Fp.prototype.F_=function(t,e){return new ks(t,this.data,this.Gt,e,this.fieldTransforms)},Fp);function Fp(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function qp(t,e,n){this.data=t,this.Gt=e,this.fieldTransforms=n}function Bp(t,e){if(!isFinite(t)||t<-90||90<t)throw new Fr(jr.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||180<e)throw new Fr(jr.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this.x_=t,this.N_=e}function Gp(t){switch(t){case 0:case 2:case 1:return 1;case 3:case 4:return;default:throw Dr()}}var zp=(Object.defineProperty(Yp.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(Yp.prototype,"k_",{get:function(){return this.settings.k_},enumerable:!1,configurable:!0}),Yp.prototype.M_=function(t){return new Yp(Object.assign(Object.assign({},this.settings),t),this.t,this.Qt,this.ignoreUndefinedProperties,this.fieldTransforms,this.Gt)},Yp.prototype.L_=function(t){var e=null===(e=this.path)||void 0===e?void 0:e.child(t);return(e=this.M_({path:e,B_:!1})).q_(t),e},Yp.prototype.U_=function(t){var e;t=null===(e=this.path)||void 0===e?void 0:e.child(t);return(t=this.M_({path:t,B_:!1})).O_(),t},Yp.prototype.Q_=function(t){return this.M_({path:void 0,B_:!0})},Yp.prototype.K_=function(t){return Ed(t,this.settings.methodName,this.settings.W_||!1,this.path,this.settings.j_)},Yp.prototype.contains=function(t){return void 0!==this.Gt.find(function(e){return t.nt(e)})||void 0!==this.fieldTransforms.find(function(e){return t.nt(e.field)})},Yp.prototype.O_=function(){if(this.path)for(var t=0;t<this.path.length;t++)this.q_(this.path.get(t))},Yp.prototype.q_=function(t){if(0===t.length)throw this.K_("Document fields must not be empty");if(Gp(this.k_)&&Mp.test(t))throw this.K_('Document fields cannot begin and end with "__"')},Yp),Hp=(Qp.prototype.G_=function(t,e,n,r){return void 0===r&&(r=!1),new zp({k_:t,methodName:e,j_:n,path:ai.ct(),B_:!1,W_:r},this.t,this.Qt,this.ignoreUndefinedProperties)},Qp);function Qp(t,e,n){this.t=t,this.ignoreUndefinedProperties=e,this.Qt=n||Of(t)}function Yp(t,e,n,r,i,o){this.settings=t,this.t=e,this.Qt=n,this.ignoreUndefinedProperties=r,void 0===i&&this.O_(),this.fieldTransforms=i||[],this.Gt=o||[]}function Kp(t){var e=t.p_(),n=Of(t.I_);return new Hp(t.I_,!!e.ignoreUndefinedProperties,n)}function Xp(t,e,n,r,i,o){void 0===o&&(o={});var s=t.G_(o.merge||o.mergeFields?2:0,e,n,i);md("Data must be an object, but it was:",s,r);var u,a;r=vd(r,s);if(o.merge)u=new bi(s.Gt),a=s.fieldTransforms;else if(o.mergeFields){for(var c=[],h=0,f=o.mergeFields;h<f.length;h++){var l=bd(e,f[h],n);if(!s.contains(l))throw new Fr(jr.INVALID_ARGUMENT,"Field '"+l+"' is specified in your field mask but missing from your input data.");Id(c,l)||c.push(l)}u=new bi(c),a=s.fieldTransforms.filter(function(t){return u.Tt(t.field)})}else u=null,a=s.fieldTransforms;return new Up(new Bi(r),u,a)}var Wp,Jp=(f(Zp,Wp=up),Zp.prototype.z_=function(t){if(2!==t.k_)throw 1===t.k_?t.K_(this._methodName+"() can only appear at the top level of your update data"):t.K_(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return t.Gt.push(t.path),null},Zp.prototype.isEqual=function(t){return t instanceof Zp},Zp);function Zp(){return null!==Wp&&Wp.apply(this,arguments)||this}function $p(t,e,n){return new zp({k_:3,j_:e.settings.j_,methodName:t._methodName,B_:n},e.t,e.Qt,e.ignoreUndefinedProperties)}var td,ed,nd,rd,id=(f(fd,rd=up),fd.prototype.z_=function(t){return new _s(t.path,new us)},fd.prototype.isEqual=function(t){return t instanceof fd},fd),od=(f(hd,nd=up),hd.prototype.z_=function(t){var e=$p(this,t,!0),n=this.H_.map(function(t){return yd(t,e)});n=new as(n);return new _s(t.path,n)},hd.prototype.isEqual=function(t){return this===t},hd),sd=(f(cd,ed=up),cd.prototype.z_=function(t){var e=$p(this,t,!0),n=this.H_.map(function(t){return yd(t,e)});n=new ps(n);return new _s(t.path,n)},cd.prototype.isEqual=function(t){return this===t},cd),ud=(f(ad,td=up),ad.prototype.z_=function(t){var e=new gs(t.Qt,rs(t.Qt,this.J_));return new _s(t.path,e)},ad.prototype.isEqual=function(t){return this===t},ad);function ad(t,e){var n;return(n=td.call(this,t)||this).J_=e,n}function cd(t,e){var n;return(n=ed.call(this,t)||this).H_=e,n}function hd(t,e){var n;return(n=nd.call(this,t)||this).H_=e,n}function fd(){return null!==rd&&rd.apply(this,arguments)||this}function ld(t,e,n,r){var i=t.G_(1,e,n);md("Data must be an object, but it was:",i,r);var o=[],s=new Gi;return gi(r,function(t,r){var u=_d(e,t,n);r instanceof ap&&(r=r.d_),t=i.U_(u),r instanceof Jp?o.push(u):null!=(t=yd(r,t))&&(o.push(u),s.set(u,t))}),r=new bi(o),new jp(s.Pt(),r,i.fieldTransforms)}function pd(t,e,n,r,i,o){var s=t.G_(1,e,n),u=[bd(e,r,n)],a=[i];if(o.length%2!=0)throw new Fr(jr.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var c=0;c<o.length;c+=2)u.push(bd(e,o[c])),a.push(o[c+1]);for(var h,f,l,p=[],d=new Gi,y=u.length-1;0<=y;--y)Id(p,u[y])||(h=u[y],(f=a[y])instanceof ap&&(f=f.d_),l=s.U_(h),f instanceof Jp?p.push(h):null!=(l=yd(f,l))&&(p.push(h),d.set(h,l)));return i=new bi(p),new jp(d.Pt(),i,s.fieldTransforms)}function dd(t,e,n,r){return void 0===r&&(r=!1),yd(n,t.G_(r?4:3,e))}function yd(t,e){if(gd(t=t instanceof ap?t.d_:t))return md("Unsupported field value:",e,t),vd(t,e);if(t instanceof up)return function(t,e){if(!Gp(e.k_))throw e.K_(t._methodName+"() can only be used with update() and set()");if(!e.path)throw e.K_(t._methodName+"() is not currently supported inside arrays");(t=t.z_(e))&&e.fieldTransforms.push(t)}(t,e),null;if(void 0===t&&e.ignoreUndefinedProperties)return null;if(e.path&&e.Gt.push(e.path),t instanceof Array){if(e.settings.B_&&4!==e.k_)throw e.K_("Nested arrays are not supported");return function(e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var s=yd(o[i],e.Q_(r));null==s&&(s={nullValue:"NULL_VALUE"}),n.push(s),r++}return{arrayValue:{values:n}}}(e)}return function(t,e){if(null===(t=t instanceof ap?t.d_:t))return{nullValue:"NULL_VALUE"};if("number"==typeof t)return rs(e.Qt,t);if("boolean"==typeof t)return{booleanValue:t};if("string"==typeof t)return{stringValue:t};if(t instanceof Date){var n=ii.fromDate(t);return{timestampValue:Pu(e.Qt,n)}}if(t instanceof ii)return n=new ii(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)),{timestampValue:Pu(e.Qt,n)};if(t instanceof Vp)return{geoPointValue:{latitude:t.latitude,longitude:t.longitude}};if(t instanceof qr)return{bytesValue:Cu(e.Qt,t.I)};if(t instanceof Tp){n=e.t;var r=t.firestore.I_;if(!r.isEqual(n))throw e.K_("Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:Ru(t.firestore.I_||e.t,t.S_.path)}}throw e.K_("Unsupported field value: "+gp(t))}(t,e)}function vd(t,e){var n={};return mi(t)?e.path&&0<e.path.length&&e.Gt.push(e.path):gi(t,function(t,r){null!=(r=yd(r,e.L_(t)))&&(n[t]=r)}),{mapValue:{fields:n}}}function gd(t){return!("object"!=typeof t||null===t||t instanceof Array||t instanceof Date||t instanceof ii||t instanceof Vp||t instanceof qr||t instanceof Tp||t instanceof up)}function md(t,e,n){if(!gd(n)||"object"!=typeof(r=n)||null===r||Object.getPrototypeOf(r)!==Object.prototype&&null!==Object.getPrototypeOf(r))throw"an object"===(n=gp(n))?e.K_(t+" a custom object"):e.K_(t+" "+n);var r}function bd(t,e,n){if((e=e instanceof ap?e.d_:e)instanceof sp)return e.f_;if("string"==typeof e)return _d(t,e);throw Ed("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var wd=new RegExp("[~\\*/\\[\\]]");function _d(t,e,n){if(0<=e.search(wd))throw Ed("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return(new(sp.bind.apply(sp,d([void 0],e.split("."))))).f_}catch(r){throw Ed("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Ed(t,e,n,r,i){var o=r&&!r.et(),s=void 0!==i;e="Function "+e+"() called with invalid data";return n&&(e+=" (via `toFirestore()`)"),n="",(o||s)&&(n+=" (found",o&&(n+=" in field "+r),s&&(n+=" in document "+i),n+=")"),new Fr(jr.INVALID_ARGUMENT,(e+=". ")+t+n)}function Id(t,e){return t.some(function(t){return t.isEqual(e)})}var Td=(Dd.prototype.ef=function(t){return l(this,void 0,void 0,function(){var e,n=this;return p(this,function(r){switch(r.label){case 0:if(this.nf(),0<this.mutations.length)throw new Fr(jr.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,s;return p(this,function(u){switch(u.label){case 0:return r=qu((n=t).Qt)+"/documents",i={documents:e.map(function(t){return Mu(n.Qt,t)})},[4,n.Du("BatchGetDocuments",r,i)];case 1:return i=u.sent(),o=new Map,i.forEach(function(t){var e;e=n.Qt,t="found"in(t=t)?function(t,e){Or(!!e.found),e.found.name,e.found.updateTime;var n=Uu(t,e.found.name);t=Lu(e.found.updateTime),e=new Bi({mapValue:{fields:e.found.fields}});return new Xi(n,t,e,{})}(e,t):"missing"in t?function(t,e){return Or(!!e.missing),Or(!!e.readTime),t=Uu(t,e.missing),e=Lu(e.readTime),new Wi(t,e)}(e,t):Dr();o.set(t.key.toString(),t)}),s=[],[2,(e.forEach(function(t){Or(!!(t=o.get(t.toString()))),s.push(t)}),s)]}})})}(this.Sh,t)];case 1:return[2,((e=r.sent()).forEach(function(t){t instanceof Wi||t instanceof Xi?n.sf(t):Dr()}),e)]}})})},Dd.prototype.set=function(t,e){this.write(e.F_(t,this.jt(t))),this.tf.add(t.toString())},Dd.prototype.update=function(t,e){try{this.write(e.F_(t,this.rf(t)))}catch(t){this.Z_=t}this.tf.add(t.toString())},Dd.prototype.delete=function(t){this.write(new qs(t,this.jt(t))),this.tf.add(t.toString())},Dd.prototype.commit=function(){return l(this,void 0,void 0,function(){var t,e=this;return p(this,function(n){switch(n.label){case 0:if(this.nf(),this.Z_)throw this.Z_;return t=this.Y_,this.mutations.forEach(function(e){t.delete(e.key.toString())}),t.forEach(function(t,n){n=ci._t(n),e.mutations.push(new Bs(n,e.jt(n)))}),[4,function(t,e){return l(this,void 0,void 0,function(){var n,r,i;return p(this,function(o){switch(o.label){case 0:return r=qu((n=t).Qt)+"/documents",i={writes:e.map(function(t){return Hu(n.Qt,t)})},[4,n.pu("Commit",r,i)];case 1:return o.sent(),[2]}})})}(this.Sh,this.mutations)];case 1:return n.sent(),this.X_=!0,[2]}})})},Dd.prototype.sf=function(t){var e;if(t instanceof Xi)e=t.version;else{if(!(t instanceof Wi))throw Dr();e=oi.min()}var n=this.Y_.get(t.key.toString());if(n){if(!e.isEqual(n))throw new Fr(jr.ABORTED,"Document version changed between two reads.")}else this.Y_.set(t.key.toString(),e)},Dd.prototype.jt=function(t){var e=this.Y_.get(t.toString());return!this.tf.has(t.toString())&&e?Es.updateTime(e):Es.Kt()},Dd.prototype.rf=function(t){var e=this.Y_.get(t.toString());if(this.tf.has(t.toString())||!e)return Es.exists(!0);if(e.isEqual(oi.min()))throw new Fr(jr.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Es.updateTime(e)},Dd.prototype.write=function(t){this.nf(),this.mutations.push(t)},Dd.prototype.nf=function(){},Dd),Nd=(xd.prototype.run=function(){this.af()},xd.prototype.af=function(){var t=this;this.Gu.Lu(function(){return l(t,void 0,void 0,function(){var t,e,n=this;return p(this,function(r){return t=new Td(this.Sh),(e=this.uf(t))&&e.then(function(e){n._s.Ps(function(){return t.commit().then(function(){n.Es.resolve(e)}).catch(function(t){n.hf(t)})})}).catch(function(t){n.hf(t)}),[2]})})})},xd.prototype.uf=function(t){try{var e=this.updateFunction(t);return!Si(e)&&e.catch&&e.then?e:(this.Es.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.Es.reject(t),null}},xd.prototype.hf=function(t){var e=this;0<this.cf&&this.lf(t)?(--this.cf,this._s.Ps(function(){return e.af(),Promise.resolve()})):this.Es.reject(t)},xd.prototype.lf=function(t){return"FirebaseError"===t.name&&("aborted"===(t=t.code)||"failed-precondition"===t||!Hs(t))},xd),Ad=(Sd.prototype.getConfiguration=function(){return l(this,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,this.C.promise];case 1:return[2,(t.sent(),{_s:this._s,yu:this.yu,clientId:this.clientId,credentials:this.credentials,Jl:this.user,pl:100})]}})})},Sd.prototype.ff=function(t){var e=this;this._f=t,this.C.promise.then(function(){return e._f(e.user)})},Sd.prototype.df=function(){if(this._s.wf)throw new Fr(jr.FAILED_PRECONDITION,"The client has already been terminated.")},Sd.prototype.terminate=function(){var t=this;this._s.Ef();var e=new na;return this._s.Tf(function(){return l(t,void 0,void 0,function(){var t;return p(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),this.If?[4,this.If.terminate()]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.mf?[4,this.mf.terminate()]:[3,4];case 3:n.sent(),n.label=4;case 4:return this.credentials.S(),e.resolve(),[3,6];case 5:return t=_a(t=n.sent(),"Failed to shutdown persistence"),e.reject(t),[3,6];case 6:return[2]}})})}),e.promise},Sd);function Sd(t,e,n){var r=this;this.credentials=t,this._s=e,this.yu=n,this.user=Br.UNAUTHENTICATED,this.clientId=kr.u(),this._f=function(){},this.C=new na,this.credentials.v(function(t){Nr("FirestoreClient","Received user=",t.uid),r.user=t,r._f(t),r.C.resolve()})}function xd(t,e,n,r){this._s=t,this.Sh=e,this.updateFunction=n,this.Es=r,this.cf=5,this.Gu=new Lf(this._s,"transaction_retry")}function Dd(t){this.Sh=t,this.Y_=new Map,this.mutations=[],this.X_=!1,this.Z_=null,this.tf=new Set}function Od(t,e){return l(this,void 0,void 0,function(){var n,r,i=this;return p(this,function(o){switch(o.label){case 0:return t._s.Af(),Nr("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=o.sent(),[4,e.initialize(n)];case 2:return o.sent(),r=n.Jl,t.ff(function(n){r.isEqual(n)||(r=n,t._s.po(function(){return l(i,void 0,void 0,function(){return p(this,function(t){switch(t.label){case 0:return[4,Ih(e.bh,n)];case 1:return t.sent(),[2]}})})}))}),e.persistence.Po(function(){return t.terminate()}),t.mf=e,[2]}})})}function kd(t,e){return l(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:return t._s.Af(),[4,Pd(t)];case 1:return n=i.sent(),Nr("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=i.sent(),[4,e.initialize(n,r)];case 3:return i.sent(),t.ff(function(n){return t._s.po(function(){return function(t,e){return l(this,void 0,void 0,function(){var n,r;return p(this,function(i){switch(i.label){case 0:return(n=t)._s.Af(),Nr("RemoteStore","RemoteStore received new credentials"),r=$f(n),n.Nh.add(3),[4,Qf(n)];case 1:return i.sent(),r&&n.Oh.set("Unknown"),[4,n.Dh.n_(e)];case 2:return i.sent(),n.Nh.delete(3),[4,Hf(n)];case 3:return i.sent(),[2]}})})}(e.yl,n)})}),t.If=e,[2]}})})}function Pd(t){return l(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return t.mf?[3,2]:(Nr("FirestoreClient","Using default OfflineComponentProvider"),[4,Od(t,new Xl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.mf]}})})}function Cd(t){return l(this,void 0,void 0,function(){return p(this,function(e){switch(e.label){case 0:return t.If?[3,2]:(Nr("FirestoreClient","Using default OnlineComponentProvider"),[4,kd(t,new Zl)]);case 1:e.sent(),e.label=2;case 2:return[2,t.If]}})})}function Ld(t){return Pd(t).then(function(t){return t.persistence})}function Rd(t){return Pd(t).then(function(t){return t.bh})}function Vd(t){return Cd(t).then(function(t){return t.yl})}function Md(t){return Cd(t).then(function(t){return t._a})}function Ud(t){return l(this,void 0,void 0,function(){var e,n;return p(this,function(r){switch(r.label){case 0:return[4,Cd(t)];case 1:return e=r.sent(),[2,((n=e.gl).jh=function(t,e){return l(this,void 0,void 0,function(){var n,r,i,o,s;return p(this,function(u){switch(u.label){case 0:return n=zl(t),(s=n.vl.get(e))?(r=s.targetId,n.Vl.Fa(r),i=s.view.Rl(),[3,4]):[3,1];case 1:return[4,Ah(n.bh,Qo(e))];case 2:return o=u.sent(),s=n.Vl.Fa(o.targetId),r=o.targetId,[4,Ol(n,e,r,"current"===s)];case 3:i=u.sent(),n.Ml&&Yf(n.yl,o),u.label=4;case 4:return[2,i]}})})}.bind(null,e._a),n.Hh=function(t,e){return l(this,void 0,void 0,function(){var n,r,i;return p(this,function(o){switch(o.label){case 0:return r=(n=t).vl.get(e),1<(i=n.Sl.get(r.targetId)).length?[2,(n.Sl.set(r.targetId,i.filter(function(t){return!Ko(t,e)})),void n.vl.delete(e))]:n.Ml?(n.Vl.ka(r.targetId),n.Vl.Da(r.targetId)?[3,2]:[4,Sh(n.bh,r.targetId,!1).then(function(){n.Vl.La(r.targetId),Kf(n.yl,r.targetId),Ml(n,r.targetId)}).catch(Ec)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Ml(n,r.targetId),[4,Sh(n.bh,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}})})}.bind(null,e._a),n)]}})})}function jd(t,e,n){var r=this;void 0===n&&(n={});var i=new na;return t._s.Ps(function(){return l(r,void 0,void 0,function(){var r;return p(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new ip({next:function(o){e.Ps(function(){return fl(t,s)});var u=o.docs.has(n);!u&&o.fromCache?i.reject(new Fr(jr.UNAVAILABLE,"Failed to get document because the client is offline.")):u&&o.fromCache&&r&&"server"===r.source?i.reject(new Fr(jr.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(t){return i.reject(t)}}),s=new pl(jo(n.path),o,{includeMetadataChanges:!0,nl:!0});return hl(t,s)},[4,Ud(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}})})}),i.promise}function Fd(t,e,n){var r=this;void 0===n&&(n={});var i=new na;return t._s.Ps(function(){return l(r,void 0,void 0,function(){var r;return p(this,function(o){switch(o.label){case 0:return r=function(t,e,n,r,i){var o=new ip({next:function(n){e.Ps(function(){return fl(t,s)}),n.fromCache&&"server"===r.source?i.reject(new Fr(jr.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(t){return i.reject(t)}}),s=new pl(n,o,{includeMetadataChanges:!0,nl:!0});return hl(t,s)},[4,Ud(t)];case 1:return[2,r.apply(void 0,[o.sent(),t._s,e,n,i])]}})})}),i.promise}var qd=(Object.defineProperty(Bd.prototype,"wf",{get:function(){return this.yf},enumerable:!1,configurable:!0}),Bd.prototype.Ps=function(t){this.enqueue(t)},Bd.prototype.Tf=function(t){this.Sf(),this.Df(t)},Bd.prototype.Ef=function(){var t;this.yf||(this.yf=!0,(t=Df())&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.vf))},Bd.prototype.enqueue=function(t){return this.Sf(),this.yf?new Promise(function(t){}):this.Df(t)},Bd.prototype.po=function(t){var e=this;this.Ps(function(){return e.Pf.push(t),e.Cf()})},Bd.prototype.Cf=function(){return l(this,void 0,void 0,function(){var t,e=this;return p(this,function(n){switch(n.label){case 0:if(0===this.Pf.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.Pf[0]()];case 2:return n.sent(),this.Pf.shift(),this.Gu.reset(),[3,4];case 3:if(!pa(t=n.sent()))throw t;return Nr("AsyncQueue","Operation failed with retryable error: "+t),[3,4];case 4:0<this.Pf.length&&this.Gu.Lu(function(){return e.Cf()}),n.label=5;case 5:return[2]}})})},Bd.prototype.Df=function(t){var e=this,n=this.Rf.then(function(){return e.pf=!0,t().catch(function(t){throw e.Vf=t,e.pf=!1,Ar("INTERNAL UNHANDLED ERROR: ",(r=(n=t).message||"",r=n.stack?n.stack.includes(n.message)?n.stack:n.message+"\n"+n.stack:r)),t;var n,r}).then(function(t){return e.pf=!1,t})});return this.Rf=n},Bd.prototype.Tr=function(t,e,n){var r=this;return this.Sf(),-1<this.bf.indexOf(t)&&(e=0),n=ba.Ts(this,t,e,n,function(t){return r.xf(t)}),this.gf.push(n),n},Bd.prototype.Sf=function(){this.Vf&&Dr()},Bd.prototype.Af=function(){},Bd.prototype.Nf=function(){return l(this,void 0,void 0,function(){var t;return p(this,function(e){switch(e.label){case 0:return[4,t=this.Rf];case 1:e.sent(),e.label=2;case 2:if(t!==this.Rf)return[3,0];e.label=3;case 3:return[2]}})})},Bd.prototype.$f=function(t){for(var e=0,n=this.gf;e<n.length;e++)if(n[e].fs===t)return!0;return!1},Bd.prototype.Ff=function(t){var e=this;return this.Nf().then(function(){e.gf.sort(function(t,e){return t.ds-e.ds});for(var n=0,r=e.gf;n<r.length;n++){var i=r[n];if(i.Rs(),"all"!==t&&i.fs===t)break}return e.Nf()})},Bd.prototype.Of=function(t){this.bf.push(t)},Bd.prototype.xf=function(t){t=this.gf.indexOf(t),this.gf.splice(t,1)},Bd);function Bd(){var t=this;this.Rf=Promise.resolve(),this.Pf=[],this.yf=!1,this.gf=[],this.Vf=null,this.pf=!1,this.bf=[],this.Gu=new Lf(this,"async_queue_retry"),this.vf=function(){var e=Df();e&&Nr("AsyncQueue","Visibility state changed to "+e.visibilityState),t.Gu.qu()};var e=Df();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.vf)}function Gd(t){return function(){if("object"==typeof t&&null!==t)for(var e=t,n=0,r=["next","error","complete"];n<r.length;n++){var i=r[n];if(i in e&&"function"==typeof e[i])return 1}}()}var zd,Hd=(Kd.prototype.onProgress=function(t,e,n){this.kf={next:t,error:e,complete:n}},Kd.prototype.catch=function(t){return this.Mf.promise.catch(t)},Kd.prototype.then=function(t,e){return this.Mf.promise.then(t,e)},Kd.prototype.ql=function(t){this.Ul(t),this.kf.complete&&this.kf.complete(),this.Mf.resolve(t)},Kd.prototype.Kl=function(t){this.Lf.taskState="Error",this.kf.next&&this.kf.next(this.Lf),this.kf.error&&this.kf.error(t),this.Mf.reject(t)},Kd.prototype.Ul=function(t){this.Lf=t,this.kf.next&&this.kf.next(t)},Kd),Qd=(f(Yd,zd=Ip),Yd.prototype.b_=function(){return this.qf||Wd(this),this.qf.terminate()},Yd);function Yd(t,e){var n=this;return(n=zd.call(this,t,e)||this).Bf=new qd,n.w_="name"in t?t.name:"[DEFAULT]",n}function Kd(){this.kf={},this.Mf=new na,this.Lf={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}function Xd(t){return t.qf||Wd(t),t.qf.df(),t.qf}function Wd(t){var e,n,r=t.p_();e=t.I_,n=t.w_,r=new wr(e,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling);t.qf=new Ad(t.m_,t.Bf,r)}function Jd(t,e,n){var r=this,i=new na;return t._s.enqueue(function(){return l(r,void 0,void 0,function(){var r;return p(this,function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,Od(t,n)];case 1:return o.sent(),[4,kd(t,e)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!("FirebaseError"===(s=r=o.sent()).name?s.code===jr.FAILED_PRECONDITION||s.code===jr.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&s instanceof DOMException)||22===s.code||20===s.code||11===s.code))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}var s})})}).then(function(){return i.promise})}function Zd(t){if(t.R_||t.P_)throw new Fr(jr.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}iy.prototype.Uf=function(t,e){switch(void 0===e&&(e="none"),Oi(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Ii(t.integerValue||t.doubleValue);case 3:return this.Qf(t.timestampValue);case 4:return this.Kf(t,e);case 5:return t.stringValue;case 6:return this.Wf(Ti(t.bytesValue));case 7:return this.jf(t.referenceValue);case 8:return this.Gf(t.geoPointValue);case 9:return this.zf(t.arrayValue,e);case 10:return this.Hf(t.mapValue,e);default:throw Dr()}},iy.prototype.Hf=function(t,e){var n=this,r={};return gi(t.fields||{},function(t,i){r[t]=n.Uf(i,e)}),r},iy.prototype.Gf=function(t){return new Vp(Ii(t.latitude),Ii(t.longitude))},iy.prototype.zf=function(t,e){var n=this;return(t.values||[]).map(function(t){return n.Uf(t,e)})},iy.prototype.Kf=function(t,e){switch(e){case"previous":var n=function t(e){return Ni(e=e.mapValue.fields.__previous_value__)?t(e):e}(t);return null==n?null:this.Uf(n,e);case"estimate":return this.Qf(Ai(t));default:return null}},iy.prototype.Qf=function(t){return t=Ei(t),new ii(t.seconds,t.nanos)},iy.prototype.Jf=function(t,e){var n=si.ot(t);return Or(ta(n)),t=new _r(n.get(1),n.get(3)),n=new ci(n.Y(5)),t.isEqual(e)||Ar("Document "+n+" contains a document reference within a different database ("+t.projectId+"/"+t.database+") which is not supported. It will be treated as a reference in the current database ("+e.projectId+"/"+e.database+") instead."),n},a=iy;var $d,ty=(Object.defineProperty(ry.prototype,"id",{get:function(){return this.S_.path.tt()},enumerable:!1,configurable:!0}),Object.defineProperty(ry.prototype,"ref",{get:function(){return new Tp(this.Yf,this.v_,this.S_)},enumerable:!1,configurable:!0}),ry.prototype.exists=function(){return null!==this.Zf},ry.prototype.data=function(){if(this.Zf){if(this.v_){var t=new ey(this.Yf,this.Xf,this.S_,this.Zf,null);return this.v_.fromFirestore(t)}return this.Xf.Uf(this.Zf.bt())}},ry.prototype.get=function(t){if(this.Zf&&null!==(t=this.Zf.data().field(oy("DocumentSnapshot.get",t))))return this.Xf.Uf(t)},ry),ey=(f(ny,$d=ty),ny.prototype.data=function(){return $d.prototype.data.call(this)},ny);function ny(){return null!==$d&&$d.apply(this,arguments)||this}function ry(t,e,n,r,i){this.Yf=t,this.Xf=e,this.S_=n,this.Zf=r,this.v_=i}function iy(){}function oy(t,e){return"string"==typeof e?_d(t,e):(e instanceof ap?e.d_:e).f_}function sy(t){if(qo(t)&&0===t.xt.length)throw new Fr(jr.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}function uy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,i=e;r<i.length;r++)t=i[r].td(t);return t}var ay,cy,hy,fy,ly,py=(f(Ey,ly=_e=function(){}),Ey.prototype.td=function(t){var e=Kp(t.firestore);e=function(t,e,n,r,i,o){if(r.ut()){if("array-contains"===i||"array-contains-any"===i)throw new Fr(jr.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+i+"' queries on FieldPath.documentId().");if("in"===i||"not-in"===i){Ny(o,i);for(var s=[],u=0,a=o;u<a.length;u++){var c=a[u];s.push(Ty(n,t,c))}h={arrayValue:{values:s}}}else h=Ty(n,t,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||Ny(o,i),h=dd(e,"where",o,"in"===i||"not-in"===i);var h=uo.create(r,i,h);return function(t,e){if(e.Ct()){var n=Go(t);if(null!==n&&!n.isEqual(e.field))throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+e.field.toString()+"'");null!==(n=Bo(t))&&Ay(0,e.field,n)}if(null!==(t=function(t,e){for(var n=0,r=t.filters;n<r.length;n++){var i=r[n];if(0<=e.indexOf(i.op))return i.op}return null}(t,function(){switch(e.op){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}())))throw t===e.op?new Fr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+e.op.toString()+"' filter."):new Fr(jr.INVALID_ARGUMENT,"Invalid query. You cannot use '"+e.op.toString()+"' filters with '"+t.toString()+"' filters.")}(t,h),h}(t.C_,e,t.firestore.I_,this.ed,this.nd,this.sd);return new Np(t.firestore,t.v_,(e=(t=t.C_).filters.concat([e]),new Mo(t.path,t.collectionGroup,t.xt.slice(),e,t.limit,t.limitType,t.startAt,t.endAt)))},Ey),dy=(f(_y,fy=_e),_y.prototype.td=function(t){var e=function(t,e,n){if(null!==t.startAt)throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==t.endAt)throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Lo(e,n);return e=r,null!==Bo(n=t)||null!==(t=Go(n))&&Ay(0,t,e.field),r}(t.C_,this.ed,this.rd);return new Np(t.firestore,t.v_,(e=(t=t.C_).xt.concat([e]),new Mo(t.path,t.collectionGroup,e,t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt)))},_y),yy=(f(wy,hy=_e),wy.prototype.td=function(t){return new Np(t.firestore,t.v_,Yo(t.C_,this.od,this.ad))},wy),vy=(f(by,cy=_e),by.prototype.td=function(t){var e=Iy(t,this.type,this.ud,this.hd);return new Np(t.firestore,t.v_,(t=t.C_,e=e,new Mo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,e,t.endAt)))},by),gy=(f(my,ay=_e),my.prototype.td=function(t){var e=Iy(t,this.type,this.ud,this.hd);return new Np(t.firestore,t.v_,(t=t.C_,e=e,new Mo(t.path,t.collectionGroup,t.xt.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,e)))},my);function my(t,e,n){var r=this;return(r=ay.call(this)||this).type=t,r.ud=e,r.hd=n,r}function by(t,e,n){var r=this;return(r=cy.call(this)||this).type=t,r.ud=e,r.hd=n,r}function wy(t,e,n){var r=this;return(r=hy.call(this)||this).type=t,r.od=e,r.ad=n,r}function _y(t,e){var n=this;return(n=fy.call(this)||this).ed=t,n.rd=e,n.type="orderBy",n}function Ey(t,e,n){var r=this;return(r=ly.call(this)||this).ed=t,r.nd=e,r.sd=n,r.type="where",r}function Iy(t,e,n,r){if(n[0]instanceof ap&&(n[0]=n[0].d_),n[0]instanceof ty)return function(t,n,r,i){if(!r)throw new Fr(jr.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+e+"().");for(var o=[],s=0,u=Ho(t);s<u.length;s++){var a=u[s];if(a.field.ut())o.push(Vi(n,r.key));else{var c=r.field(a.field);if(Ni(c))throw new Fr(jr.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+a.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===c)throw a=a.field.rt(),new Fr(jr.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+a+"' (used as the orderBy) does not exist.");o.push(c)}}return new xo(o,i)}(t.C_,t.firestore.I_,n[0].Zf,r);var i=Kp(t.firestore);return function(t,e,n,r,i,o){var s=t.xt;if(i.length>s.length)throw new Fr(jr.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var u=[],a=0;a<i.length;a++){var c=i[a];if(s[a].field.ut()){if("string"!=typeof c)throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof c);if(!zo(t)&&-1!==c.indexOf("/"))throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+c+"' contains a slash.");var h=t.path.child(si.ot(c));if(!ci.wt(h))throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+h+"' is not because it contains an odd number of segments.");h=new ci(h),u.push(Vi(e,h))}else c=dd(n,r,c),u.push(c)}return new xo(u,o)}(t.C_,t.firestore.I_,i,e,n,r)}function Ty(t,e,n){if("string"==typeof(n=n instanceof ap?n.d_:n)){if(""===n)throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!zo(e)&&-1!==n.indexOf("/"))throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");if(e=e.path.child(si.ot(n)),!ci.wt(e))throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+e+"' is not because it has an odd number of segments ("+e.length+").");return Vi(t,new ci(e))}if(n instanceof Tp)return Vi(t,n.S_);throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+gp(n)+".")}function Ny(t,e){if(!Array.isArray(t)||0===t.length)throw new Fr(jr.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(10<t.length)throw new Fr(jr.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function Ay(t,e,n){if(!n.isEqual(e))throw new Fr(jr.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}function Sy(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var xy,Dy,Oy,ky=(f(Fy,Oy=a),Fy.prototype.Wf=function(t){return new qr(t)},Fy.prototype.jf=function(t){return t=this.Jf(t,this.firestore.I_),new Tp(this.firestore,null,t)},Fy),Py=(jy.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},jy),Cy=(f(Uy,Dy=ty),Uy.prototype.exists=function(){return Dy.prototype.exists.call(this)},Uy.prototype.data=function(t){if(void 0===t&&(t={}),this.Zf){if(this.v_){var e=new Ly(this.Yf,this.Xf,this.S_,this.Zf,this.metadata,null);return this.v_.fromFirestore(e,t)}return this.Xf.Uf(this.Zf.bt(),t.serverTimestamps)}},Uy.prototype.get=function(t,e){if(void 0===e&&(e={}),this.Zf&&null!==(t=this.Zf.data().field(oy("DocumentSnapshot.get",t))))return this.Xf.Uf(t,e.serverTimestamps)},Uy),Ly=(f(My,xy=Cy),My.prototype.data=function(t){return void 0===t&&(t={}),xy.prototype.data.call(this,t)},My),Ry=(Object.defineProperty(Vy.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!1,configurable:!0}),Object.defineProperty(Vy.prototype,"size",{get:function(){return this._d.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(Vy.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),Vy.prototype.forEach=function(t,e){var n=this;this._d.docs.forEach(function(r){t.call(e,new Ly(n.Yf,n.Xf,r.key,r,new Py(n._d.De.has(r.key),n._d.fromCache),n.query.v_))})},Vy.prototype.docChanges=function(t){if((t=!!(t=void 0===t?{}:t).includeMetadataChanges)&&this._d.xe)throw new Fr(jr.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this.fd&&this.dd===t||(this.fd=function(t,e){if(t._d.Se.et()){var n=0;return t._d.docChanges.map(function(e){var r=new Ly(t.Yf,t.Xf,e.doc.key,e.doc,new Py(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_);return e.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}})}var r=t._d.Se;return t._d.docChanges.filter(function(t){return e||3!==t.type}).map(function(e){var n=new Ly(t.Yf,t.Xf,e.doc.key,e.doc,new Py(t._d.De.has(e.doc.key),t._d.fromCache),t.query.v_),i=-1,o=-1;return 0!==e.type&&(i=r.indexOf(e.doc.key),r=r.delete(e.doc.key)),1!==e.type&&(o=(r=r.add(e.doc)).indexOf(e.doc.key)),{type:function(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Dr()}}(e.type),doc:n,oldIndex:i,newIndex:o}})}(this,t),this.dd=t),this.fd},Vy);function Vy(t,e,n,r){this.Yf=t,this.Xf=e,this._d=r,this.metadata=new Py(r.hasPendingWrites,r.fromCache),this.query=n}function My(){return null!==xy&&xy.apply(this,arguments)||this}function Uy(t,e,n,r,i,o){var s=this;return(s=Dy.call(this,t,e,n,r,o)||this).Yf=t,s.ld=t,s.metadata=i,s}function jy(t,e){this.hasPendingWrites=t,this.fromCache=e}function Fy(t){var e;return(e=Oy.call(this)||this).firestore=t,e}function qy(t,e){return t instanceof Cy&&e instanceof Cy?t.Yf===e.Yf&&t.S_.isEqual(e.S_)&&(null===t.Zf?null===e.Zf:t.Zf.isEqual(e.Zf))&&t.v_===e.v_:t instanceof Ry&&e instanceof Ry&&t.Yf===e.Yf&&Rp(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._d.isEqual(e._d)}var By,Gy=(f(zy,By=a),zy.prototype.Wf=function(t){return new qr(t)},zy.prototype.jf=function(t){return t=this.Jf(t,this.firestore.I_),new Tp(this.firestore,null,t)},zy);function zy(t){var e;return(e=By.call(this)||this).firestore=t,e}function Hy(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=mp((t=mp(t,Tp)).firestore,Qd),s=Kp(o);return Yy(o,[("string"==typeof(e=e instanceof ap?e.d_:e)||e instanceof sp?pd(s,"updateDoc",t.S_,e,n,r):ld(s,"updateDoc",t.S_,e)).F_(t.S_,Es.exists(!0))])}function Qy(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];t instanceof ap&&(t=t.d_);var r={includeMetadataChanges:!1},i=0;"object"!=typeof e[i]||Gd(e[i])||(r=e[i],i++);var o,s,u,a,c,h,f={includeMetadataChanges:r.includeMetadataChanges};return Gd(e[i])&&(o=e[i],e[i]=null===(r=o.next)||void 0===r?void 0:r.bind(o),e[i+1]=null===(r=o.error)||void 0===r?void 0:r.bind(o),e[i+2]=null===(r=o.complete)||void 0===r?void 0:r.bind(o)),t instanceof Tp?(u=mp(t.firestore,Qd),a=jo(t.S_.path),h={next:function(n){e[i]&&e[i](Ky(u,t,n))},error:e[i+1],complete:e[i+2]}):(s=mp(t,Np),u=mp(s.firestore,Qd),a=s.C_,c=new Gy(u),h={next:function(t){e[i]&&e[i](new Ry(u,c,s,t))},error:e[i+1],complete:e[i+2]},sy(t.C_)),function(t,e,n){var r=this,i=new ip(h),o=new pl(e,i,n);return t._s.Ps(function(){return l(r,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return e=hl,[4,Ud(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}})})}),function(){i.i_(),t._s.Ps(function(){return l(r,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return e=fl,[4,Ud(t)];case 1:return[2,e.apply(void 0,[n.sent(),o])]}})})})}}(Xd(u),a,f)}function Yy(t,e){return function(t,e){var n=this,r=new na;return t._s.Ps(function(){return l(n,void 0,void 0,function(){var n;return p(this,function(i){switch(i.label){case 0:return n=kl,[4,Md(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(Xd(t),e)}function Ky(t,e,n){var r=n.docs.get(e.S_),i=new Gy(t);return new Cy(t,i,e.S_,r,new Py(n.hasPendingWrites,n.fromCache),e.v_)}var Xy=(Wy.prototype.set=function(t,e,n){return this.md(),e=Sy((t=Jy(t,this.Yf)).v_,e,n),n=Xp(this.Id,"WriteBatch.set",t.S_,e,null!==t.v_,n),this.Ed.push(n.F_(t.S_,Es.Kt())),this},Wy.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return this.md(),t=Jy(t,this.Yf),e="string"==typeof(e=e instanceof ap?e.d_:e)||e instanceof sp?pd(this.Id,"WriteBatch.update",t.S_,e,n,r):ld(this.Id,"WriteBatch.update",t.S_,e),this.Ed.push(e.F_(t.S_,Es.exists(!0))),this},Wy.prototype.delete=function(t){return this.md(),t=Jy(t,this.Yf),this.Ed=this.Ed.concat(new qs(t.S_,Es.Kt())),this},Wy.prototype.commit=function(){return this.md(),this.Td=!0,0<this.Ed.length?this.wd(this.Ed):Promise.resolve()},Wy.prototype.md=function(){if(this.Td)throw new Fr(jr.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},Wy);function Wy(t,e){this.Yf=t,this.wd=e,this.Ed=[],this.Td=!1,this.Id=Kp(t)}function Jy(t,e){if((t=t instanceof ap?t.d_:t).firestore!==e)throw new Fr(jr.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}var Zy,$y=(ev.prototype.get=function(t){var e=this,n=Jy(t,this.Yf),r=new ky(this.Yf);return this.Ad.ef([n.S_]).then(function(t){if(!t||1!==t.length)return Dr();if((t=t[0])instanceof Wi)return new ty(e.Yf,r,n.S_,null,n.v_);if(t instanceof Xi)return new ty(e.Yf,r,t.key,t,n.v_);throw Dr()})},ev.prototype.set=function(t,e,n){return e=Sy((t=Jy(t,this.Yf)).v_,e,n),n=Xp(this.Id,"Transaction.set",t.S_,e,null!==t.v_,n),this.Ad.set(t.S_,n),this},ev.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];return t=Jy(t,this.Yf),e="string"==typeof(e=e instanceof ap?e.d_:e)||e instanceof sp?pd(this.Id,"Transaction.update",t.S_,e,n,r):ld(this.Id,"Transaction.update",t.S_,e),this.Ad.update(t.S_,e),this},ev.prototype.delete=function(t){return t=Jy(t,this.Yf),this.Ad.delete(t.S_),this},f(tv,Zy=ev),tv.prototype.get=function(t){var e=this,n=Jy(t,this.Yf),r=new Gy(this.Yf);return Zy.prototype.get.call(this,t).then(function(t){return new Cy(e.Yf,r,n.S_,t.Zf,new Py(!1,!1),n.v_)})},tv);function tv(t,e){var n;return(n=Zy.call(this,t,e)||this).Yf=t,n}function ev(t,e){this.Yf=t,this.Ad=e,this.Id=Kp(t)}function nv(){if("undefined"==typeof Uint8Array)throw new Fr(jr.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function rv(){if("undefined"==typeof atob)throw new Fr(jr.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var iv,ov,sv,uv=(f(dv,sv=ap),dv.fromBase64String=function(t){return rv(),new dv(qr.fromBase64String(t))},dv.fromUint8Array=function(t){return nv(),new dv(qr.fromUint8Array(t))},dv.prototype.toBase64=function(){return rv(),this.d_.toBase64()},dv.prototype.toUint8Array=function(){return nv(),this.d_.toUint8Array()},dv.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},dv.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},dv),av=(pv.prototype.enableIndexedDbPersistence=function(t,e){return function(t,e){Zd(t=mp(t,Qd));var n=Xd(t),r=t.p_();return Jd(n,t=new Zl,new Wl(t,r.cacheSizeBytes,null==e?void 0:e.forceOwnership))}(t.d_,{forceOwnership:e})},pv.prototype.enableMultiTabIndexedDbPersistence=function(t){return function(t){Zd(t=mp(t,Qd));var e=Xd(t),n=t.p_();return Jd(e,t=new Zl,new Jl(t,n.cacheSizeBytes))}(t.d_)},pv.prototype.clearIndexedDbPersistence=function(t){return function(t){var e=this;if(t.R_&&!t.P_)throw new Fr(jr.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new na;return t.Bf.Tf(function(){return l(e,void 0,void 0,function(){var e;return p(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(t){return l(this,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return oa.Kn()?(e=t+"main",[4,oa.delete(e)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}})})}(ph(t.I_,t.w_))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return e=r.sent(),n.reject(e),[3,3];case 3:return[2]}})})}),n.promise}(t.d_)},pv),cv=(f(lv,ov=ap),Object.defineProperty(lv.prototype,"I_",{get:function(){return this.d_.I_},enumerable:!1,configurable:!0}),lv.prototype.settings=function(t){t.merge&&delete(t=Object.assign(Object.assign({},this.d_.V_()),t)).merge,this.d_.g_(t)},lv.prototype.useEmulator=function(t,e){var n,r;r=t,t=e,"firestore.googleapis.com"!==(e=(n=mp(n=this.d_,Ip)).V_()).host&&e.host!==r&&Sr("Host has been set in both settings() and useEmulator(), emulator host will be used"),n.g_(Object.assign(Object.assign({},e),{host:r+":"+t,ssl:!1}))},lv.prototype.enableNetwork=function(){return function(t){var e=this;return t._s.enqueue(function(){return l(e,void 0,void 0,function(){var e,n;return p(this,function(r){switch(r.label){case 0:return[4,Ld(t)];case 1:return e=r.sent(),[4,Vd(t)];case 2:return n=r.sent(),[2,(e.yo(!0),(i=n).Nh.delete(0),Hf(i))]}var i})})})}(Xd(mp(this.d_,Qd)))},lv.prototype.disableNetwork=function(){return function(t){var e=this;return t._s.enqueue(function(){return l(e,void 0,void 0,function(){var e,n;return p(this,function(r){switch(r.label){case 0:return[4,Ld(t)];case 1:return e=r.sent(),[4,Vd(t)];case 2:return n=r.sent(),[2,(e.yo(!1),function(t){return l(this,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return(e=t).Nh.add(0),[4,Qf(e)];case 1:return n.sent(),e.Oh.set("Offline"),[2]}})})}(n))]}})})})}(Xd(mp(this.d_,Qd)))},lv.prototype.enablePersistence=function(t){var e=!1,n=!1;return t&&dp("synchronizeTabs",e=!!t.synchronizeTabs,"experimentalForceOwningTab",n=!!t.experimentalForceOwningTab),e?this.Rd.enableMultiTabIndexedDbPersistence(this):this.Rd.enableIndexedDbPersistence(this,n)},lv.prototype.clearPersistence=function(){return this.Rd.clearIndexedDbPersistence(this)},lv.prototype.terminate=function(){return this.Pd&&(this.Pd._removeServiceInstance("firestore"),this.Pd._removeServiceInstance("firestore-exp")),this.d_._delete()},lv.prototype.waitForPendingWrites=function(){return function(t){var e=this,n=new na;return t._s.Ps(function(){return l(e,void 0,void 0,function(){var e;return p(this,function(r){switch(r.label){case 0:return e=Ll,[4,Md(t)];case 1:return[2,e.apply(void 0,[r.sent(),n])]}})})}),n.promise}(Xd(mp(this.d_,Qd)))},lv.prototype.onSnapshotsInSync=function(t){return t=t,function(t,e){var n=this,r=new ip(e);return t._s.Ps(function(){return l(n,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return e=function(t,e){t.Wh.add(e),e.next()},[4,Ud(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})}),function(){r.i_(),t._s.Ps(function(){return l(n,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return e=function(t,e){t.Wh.delete(e)},[4,Ud(t)];case 1:return[2,e.apply(void 0,[n.sent(),r])]}})})})}}(Xd(mp(this.d_,Qd)),Gd(t)?t:{next:t})},Object.defineProperty(lv.prototype,"app",{get:function(){if(!this.Pd)throw new Fr(jr.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Pd},enumerable:!1,configurable:!0}),lv.prototype.collection=function(t){try{return new qv(this,Pp(this.d_,t))}catch(t){throw Sv(t,"collection()","Firestore.collection()")}},lv.prototype.doc=function(t){try{return new Nv(this,Cp(this.d_,t))}catch(t){throw Sv(t,"doc()","Firestore.doc()")}},lv.prototype.collectionGroup=function(t){try{return new Uv(this,function(t,e){if(t=mp(t,Ip),lp("collectionGroup","collection id",e),0<=e.indexOf("/"))throw new Fr(jr.INVALID_ARGUMENT,"Invalid collection ID '"+e+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Np(t,null,(e=e,new Mo(si.ct(),e)))}(this.d_,t))}catch(t){throw Sv(t,"collectionGroup()","Firestore.collectionGroup()")}},lv.prototype.runTransaction=function(t){var e,n=this;return function(t,e){var n=this,r=new na;return t._s.Ps(function(){return l(n,void 0,void 0,function(){var n;return p(this,function(i){switch(i.label){case 0:return[4,Cd(t).then(function(t){return t.Sh})];case 1:return n=i.sent(),new Nd(t._s,n,e,r).run(),[2]}})})}),r.promise}(Xd(e=this.d_),function(r){return r=new $y(e,r),t(new mv(n,r))})},lv.prototype.batch=function(){var t=this;return Xd(this.d_),new bv(new Xy(this.d_,function(e){return Yy(t.d_,e)}))},lv.prototype.loadBundle=function(t){throw new Fr(jr.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},lv.prototype.namedQuery=function(t){throw new Fr(jr.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},lv),hv=(f(fv,iv=a),fv.prototype.Wf=function(t){return new uv(new qr(t))},fv.prototype.jf=function(t){return t=this.Jf(t,this.firestore.I_),Nv.yd(t,this.firestore,null)},fv);function fv(t){var e;return(e=iv.call(this)||this).firestore=t,e}function lv(t,e,n){var r=this;return(r=ov.call(this,e)||this).Rd=n,r.INTERNAL={delete:function(){return r.terminate()}},t instanceof _r||(r.Pd=t),r}function pv(){}function dv(){return null!==sv&&sv.apply(this,arguments)||this}var yv,vv,gv,mv=(f(Iv,gv=ap),Iv.prototype.get=function(t){var e=this,n=Kv(t);return this.d_.get(n).then(function(t){return new Vv(e.Yf,new Cy(e.Yf.d_,e.Xf,t.S_,t.Zf,t.metadata,n.v_))})},Iv.prototype.set=function(t,e,n){return t=Kv(t),n?(pp("Transaction.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},Iv.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Kv(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,d([o,e,n],r)),this},Iv.prototype.delete=function(t){return t=Kv(t),this.d_.delete(t),this},Iv),bv=(f(Ev,vv=ap),Ev.prototype.set=function(t,e,n){return t=Kv(t),n?(pp("WriteBatch.set",n),this.d_.set(t,e,n)):this.d_.set(t,e),this},Ev.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o=Kv(t);return 2===arguments.length?this.d_.update(o,e):(t=this.d_).update.apply(t,d([o,e,n],r)),this},Ev.prototype.delete=function(t){return t=Kv(t),this.d_.delete(t),this},Ev.prototype.commit=function(){return this.d_.commit()},Ev),wv=(f(_v,yv=ap),_v.prototype.fromFirestore=function(t,e){return t=new Ly(this.Yf.d_,this.Xf,t.S_,t.Zf,t.metadata,null),this.d_.fromFirestore(new Mv(this.Yf,t),null!=e?e:{})},_v.prototype.toFirestore=function(t,e){return e?this.d_.toFirestore(t,e):this.d_.toFirestore(t)},_v.gd=function(t,e){var n=_v.Vd,r=n.get(t);return r||(r=new WeakMap,n.set(t,r)),(n=r.get(e))||(n=new _v(t,new hv(t),e),r.set(e,n)),n},_v);function _v(t,e,n){var r=this;return(r=yv.call(this,n)||this).Yf=t,r.Xf=e,r}function Ev(){return null!==vv&&vv.apply(this,arguments)||this}function Iv(t,e){var n=this;return(n=gv.call(this,e)||this).Yf=t,n.Xf=new hv(t),n}wv.Vd=new WeakMap;var Tv,Nv=(f(Av,Tv=ap),Av.pd=function(t,e,n){if(t.length%2!=0)throw new Fr(jr.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.rt()+" has "+t.length);return new Av(e,new Tp(e.d_,n,new ci(t)))},Av.yd=function(t,e,n){return new Av(e,new Tp(e.d_,n,t))},Object.defineProperty(Av.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Av.prototype,"parent",{get:function(){return new qv(this.firestore,this.d_.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(Av.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Av.prototype.collection=function(t){try{return new qv(this.firestore,Pp(this.d_,t))}catch(t){throw Sv(t,"collection()","DocumentReference.collection()")}},Av.prototype.isEqual=function(t){return(t=t instanceof ap?t.d_:t)instanceof Tp&&Lp(this.d_,t)},Av.prototype.set=function(t,e){e=pp("DocumentReference.set",e);try{return function(t,e,n){var r=mp((t=mp(t,Tp)).firestore,Qd);e=Sy(t.v_,e,n);return Yy(r,[Xp(Kp(r),"setDoc",t.S_,e,null!==t.v_,n).F_(t.S_,Es.Kt())])}(this.d_,t,e)}catch(t){throw Sv(t,"setDoc()","DocumentReference.set()")}},Av.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Hy(this.d_,t):Hy.apply(void 0,d([this.d_,t,e],n))}catch(t){throw Sv(t,"updateDoc()","DocumentReference.update()")}},Av.prototype.delete=function(){return Yy(mp((t=this.d_).firestore,Qd),[new qs(t.S_,Es.Kt())]);var t},Av.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=xv(e),i=Dv(e,function(e){return new Vv(t.firestore,new Cy(t.firestore.d_,t.Xf,e.S_,e.Zf,e.metadata,t.d_.v_))});return Qy(this.d_,r,i)},Av.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=mp((t=mp(t,Tp)).firestore,Qd),n=Xd(e),r=new Gy(e);return function(t,e){var n=this,r=new na;return t._s.Ps(function(){return l(n,void 0,void 0,function(){var n;return p(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return l(this,void 0,void 0,function(){var r,i;return p(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,(s=e,(u=t).persistence.runTransaction("read document","readonly",function(t){return u.Tc.Ho(t,s)}))];case 1:return(i=o.sent())instanceof Xi?n.resolve(i):i instanceof Wi?n.resolve(null):n.reject(new Fr(jr.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=_a(r,"Failed to get document '"+e+" from cache"),n.reject(i),[3,3];case 3:return[2]}var s,u})})},[4,Rd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.S_).then(function(n){return new Cy(e,r,t.S_,n,new Py(n instanceof Xi&&n.Vt,!0),t.v_)})}:"server"===(null==t?void 0:t.source)?function(t){var e=mp((t=mp(t,Tp)).firestore,Qd);return jd(Xd(e),t.S_,{source:"server"}).then(function(n){return Ky(e,t,n)})}:function(t){var e=mp((t=mp(t,Tp)).firestore,Qd);return jd(Xd(e),t.S_).then(function(n){return Ky(e,t,n)})})(this.d_).then(function(t){return new Vv(e.firestore,new Cy(e.firestore.d_,e.Xf,t.S_,t.Zf,t.metadata,e.d_.v_))})},Av.prototype.withConverter=function(t){return new Av(this.firestore,this.d_.withConverter(wv.gd(this.firestore,t)))},Av);function Av(t,e){var n=this;return(n=Tv.call(this,e)||this).firestore=t,n.Xf=new hv(t),n}function Sv(t,e,n){return t.message=t.message.replace(e,n),t}function xv(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if("object"==typeof r&&!Gd(r))return r}return{}}function Dv(t,e){var n;return{next:function(t){n.next&&n.next(e(t))},error:null===(t=(n=Gd(t[0])?t[0]:Gd(t[1])?t[1]:"function"==typeof t[0]?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)||void 0===t?void 0:t.bind(n),complete:null===(t=n.complete)||void 0===t?void 0:t.bind(n)}}var Ov,kv,Pv,Cv,Lv,Rv,Vv=(f(Yv,Rv=ap),Object.defineProperty(Yv.prototype,"ref",{get:function(){return new Nv(this.Yf,this.d_.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Yv.prototype,"exists",{get:function(){return this.d_.exists()},enumerable:!1,configurable:!0}),Yv.prototype.data=function(t){return this.d_.data(t)},Yv.prototype.get=function(t,e){return this.d_.get(t,e)},Yv.prototype.isEqual=function(t){return qy(this.d_,t.d_)},Yv),Mv=(f(Qv,Lv=Vv),Qv.prototype.data=function(t){return this.d_.data(t)},Qv),Uv=(f(Hv,Cv=ap),Hv.prototype.where=function(t,e,n){try{return new Hv(this.firestore,uy(this.d_,(r=n,i=e,o=oy("where",t),new py(o,i,r))))}catch(t){throw Sv(t,/(orderBy|where)\(\)/,"Query.$1()")}var r,i,o},Hv.prototype.orderBy=function(t,e){try{return new Hv(this.firestore,uy(this.d_,(n=void 0===e?"asc":e,r=oy("orderBy",t),new dy(r,n))))}catch(t){throw Sv(t,/(orderBy|where)\(\)/,"Query.$1()")}var n,r},Hv.prototype.limit=function(t){try{return new Hv(this.firestore,uy(this.d_,(bp("limit",e=t),new yy("limit",e,"F"))))}catch(t){throw Sv(t,"limit()","Query.limit()")}var e},Hv.prototype.limitToLast=function(t){try{return new Hv(this.firestore,uy(this.d_,(bp("limitToLast",e=t),new yy("limitToLast",e,"L"))))}catch(t){throw Sv(t,"limitToLast()","Query.limitToLast()")}var e},Hv.prototype.startAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,uy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vy("startAt",t,!0)}.apply(void 0,t)))}catch(t){throw Sv(t,"startAt()","Query.startAt()")}},Hv.prototype.startAfter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,uy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new vy("startAfter",t,!1)}.apply(void 0,t)))}catch(t){throw Sv(t,"startAfter()","Query.startAfter()")}},Hv.prototype.endBefore=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,uy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gy("endBefore",t,!0)}.apply(void 0,t)))}catch(t){throw Sv(t,"endBefore()","Query.endBefore()")}},Hv.prototype.endAt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];try{return new Hv(this.firestore,uy(this.d_,function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new gy("endAt",t,!1)}.apply(void 0,t)))}catch(t){throw Sv(t,"endAt()","Query.endAt()")}},Hv.prototype.isEqual=function(t){return Rp(this.d_,t.d_)},Hv.prototype.get=function(t){var e=this;return("cache"===(null==t?void 0:t.source)?function(t){var e=mp((t=mp(t,Np)).firestore,Qd),n=Xd(e),r=new Gy(e);return function(t,e){var n=this,r=new na;return t._s.Ps(function(){return l(n,void 0,void 0,function(){var n;return p(this,function(i){switch(i.label){case 0:return n=function(t,e,n){return l(this,void 0,void 0,function(){var r,i,o;return p(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,xh(t,e,!0)];case 1:return o=s.sent(),r=new Tl(e,o.Rc),i=r.fl(o.documents),i=r.wi(i,!1),n.resolve(i.snapshot),[3,3];case 2:return i=s.sent(),o=_a(i,"Failed to execute query '"+e+" against cache"),n.reject(o),[3,3];case 3:return[2]}})})},[4,Rd(t)];case 1:return[2,n.apply(void 0,[i.sent(),e,r])]}})})}),r.promise}(n,t.C_).then(function(n){return new Ry(e,r,t,n)})}:"server"===(null==t?void 0:t.source)?function(t){var e=mp((t=mp(t,Np)).firestore,Qd),n=Xd(e),r=new Gy(e);return Fd(n,t.C_,{source:"server"}).then(function(n){return new Ry(e,r,t,n)})}:function(t){var e=mp((t=mp(t,Np)).firestore,Qd),n=Xd(e),r=new Gy(e);return sy(t.C_),Fd(n,t.C_).then(function(n){return new Ry(e,r,t,n)})})(this.d_).then(function(t){return new Fv(e.firestore,new Ry(e.firestore.d_,e.Xf,e.d_,t._d))})},Hv.prototype.onSnapshot=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=xv(e),i=Dv(e,function(e){return new Fv(t.firestore,new Ry(t.firestore.d_,t.Xf,t.d_,e._d))});return Qy(this.d_,r,i)},Hv.prototype.withConverter=function(t){return new Hv(this.firestore,this.d_.withConverter(wv.gd(this.firestore,t)))},Hv),jv=(f(zv,Pv=ap),Object.defineProperty(zv.prototype,"type",{get:function(){return this.d_.type},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"doc",{get:function(){return new Mv(this.Yf,this.d_.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"oldIndex",{get:function(){return this.d_.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(zv.prototype,"newIndex",{get:function(){return this.d_.newIndex},enumerable:!1,configurable:!0}),zv),Fv=(f(Gv,kv=ap),Object.defineProperty(Gv.prototype,"query",{get:function(){return new Uv(this.Yf,this.d_.query)},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"metadata",{get:function(){return this.d_.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"size",{get:function(){return this.d_.size},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"empty",{get:function(){return this.d_.empty},enumerable:!1,configurable:!0}),Object.defineProperty(Gv.prototype,"docs",{get:function(){var t=this;return this.d_.docs.map(function(e){return new Mv(t.Yf,e)})},enumerable:!1,configurable:!0}),Gv.prototype.docChanges=function(t){var e=this;return this.d_.docChanges(t).map(function(t){return new jv(e.Yf,t)})},Gv.prototype.forEach=function(t,e){var n=this;this.d_.forEach(function(r){t.call(e,new Mv(n.Yf,r))})},Gv.prototype.isEqual=function(t){return qy(this.d_,t.d_)},Gv),qv=(f(Bv,Ov=Uv),Object.defineProperty(Bv.prototype,"id",{get:function(){return this.d_.id},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"path",{get:function(){return this.d_.path},enumerable:!1,configurable:!0}),Object.defineProperty(Bv.prototype,"parent",{get:function(){var t=this.d_.parent;return t?new Nv(this.firestore,t):null},enumerable:!1,configurable:!0}),Bv.prototype.doc=function(t){try{return new Nv(this.firestore,void 0===t?Cp(this.d_):Cp(this.d_,t))}catch(t){throw Sv(t,"doc()","CollectionReference.doc()")}},Bv.prototype.add=function(t){var e,n,r,i=this;return n=t,t=mp((e=this.d_).firestore,Qd),r=Cp(e),n=Sy(e.v_,n),Yy(t,[Xp(Kp(e.firestore),"addDoc",r.S_,n,null!==e.v_,{}).F_(r.S_,Es.exists(!1))]).then(function(){return r}).then(function(t){return new Nv(i.firestore,t)})},Bv.prototype.isEqual=function(t){return Lp(this.d_,t.d_)},Bv.prototype.withConverter=function(t){return new Bv(this.firestore,this.d_.withConverter(wv.gd(this.firestore,t)))},Bv);function Bv(t,e){var n=this;return(n=Ov.call(this,t,e)||this).firestore=t,n.d_=e,n}function Gv(t,e){var n;return(n=kv.call(this,e)||this).Yf=t,n}function zv(t,e){var n;return(n=Pv.call(this,e)||this).Yf=t,n}function Hv(t,e){var n=this;return(n=Cv.call(this,e)||this).firestore=t,n.Xf=new hv(t),n}function Qv(){return null!==Lv&&Lv.apply(this,arguments)||this}function Yv(t,e){var n;return(n=Rv.call(this,e)||this).Yf=t,n}function Kv(t){return mp(t=t instanceof ap?t.d_:t,Tp)}var Xv,Wv;f(Zv,Wv=ap),Zv.documentId=function(){return new Zv(ai.ht().rt())},Zv.prototype.isEqual=function(t){return(t=t instanceof ap?t.d_:t)instanceof sp&&this.d_.f_.isEqual(t.f_)},_e=Zv,f(Jv,Xv=ap),Jv.serverTimestamp=function(){var t=new id("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new Jv(t)},Jv.delete=function(){var t=new Jp("deleteField");return t._methodName="FieldValue.delete",new Jv(t)},Jv.arrayUnion=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new od("arrayUnion",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayUnion",new Jv(n)},Jv.arrayRemove=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new sd("arrayRemove",t)}.apply(void 0,t);return n._methodName="FieldValue.arrayRemove",new Jv(n)},Jv.increment=function(t){return(t=new ud("increment",t))._methodName="FieldValue.increment",new Jv(t)},Jv.prototype.isEqual=function(t){return this.d_.isEqual(t.d_)},a=Jv;function Jv(){return null!==Xv&&Xv.apply(this,arguments)||this}function Zv(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return Wv.call(this,new(sp.bind.apply(sp,d([void 0],t))))||this}var $v=(tg.prototype.setInstantiationMode=function(t){return this.instantiationMode=t,this},tg.prototype.setMultipleInstances=function(t){return this.multipleInstances=t,this},tg.prototype.setServiceProps=function(t){return this.serviceProps=t,this},tg);function tg(t,e,n){this.name=t,this.instanceFactory=e,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY"}var eg,ng,rg={Firestore:cv,GeoPoint:Vp,Timestamp:ii,Blob:uv,Transaction:mv,WriteBatch:bv,DocumentReference:Nv,DocumentSnapshot:Vv,Query:Uv,QueryDocumentSnapshot:Mv,QuerySnapshot:Fv,CollectionReference:qv,FieldPath:_e,FieldValue:a,setLogLevel:function(t){Er.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};(eg=n.default).INTERNAL.registerComponent(new $v("firestore",function(t){var e=t.getProvider("app").getImmediate();return e=e,t=t.getProvider("auth-internal"),new cv(e,new Qd(e,t),new av)},"PUBLIC").setServiceProps(Object.assign({},rg))),eg.registerVersion("@firebase/firestore","2.1.7"),(ng=cv).prototype.loadBundle=function(t){return e=this.d_,n=t,r=Xd(e=mp(e,Qd)),t=new Hd,function(t,e,r){var i,o=this,s=(i=n,e=Of(e),i=function(t){if(t instanceof Uint8Array)return rp(t,void 0);if(t instanceof ArrayBuffer)return rp(new Uint8Array(t),void 0);if(t instanceof ReadableStream)return t.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof i?(new TextEncoder).encode(i):i),new op(i,e));t._s.Ps(function(){return l(o,void 0,void 0,function(){var e;return p(this,function(n){switch(n.label){case 0:return e=Ql,[4,Md(t)];case 1:return e.apply(void 0,[n.sent(),s,r]),[2]}})})})}(r,e.I_,t),t;var e,n,r},ng.prototype.namedQuery=function(t){var e=this,n=this.d_;return t=t,function(t,e){var n=this;return t._s.enqueue(function(){return l(n,void 0,void 0,function(){var n;return p(this,function(r){switch(r.label){case 0:return n=function(t,e){var n=t;return n.persistence.runTransaction("Get named query","readonly",function(t){return n.wo.Ms(t,e)})},[4,Rd(t)];case 1:return[2,n.apply(void 0,[r.sent(),e])]}})})})}(Xd(n=mp(n,Qd)),t).then(function(t){return t?new Np(n,null,t.query):null}).then(function(t){return t?new Uv(e,t):null})}}).apply(this,arguments)}catch(t){throw console.error(t),new Error("Cannot instantiate firebase-firestore.js - be sure to load firebase-app.js first.")}});