const title=$("pgTitle"),usrAcctBtn=$("usrBtn"),loginDialog=$("loginDialog").MDCDialog,loginSpinner=q("#loginDialog #loginLoader > div").MDCCircularProgress,fUIAuthDiv=$("firebaseui-auth-container"),verifyEmailBtn=q("#verEmailMsg button");let fUI,maxHeight=250;function reCalcTitleAnim(){const e=(title.getBoundingClientRect().top-8)/maxHeight;if(scrollY>=maxHeight-8)return title.style.position="fixed",title.style.left="10px",title.style.top="10px",title.style.right="10px",title.style.zIndex="6",title.style.backgroundColor="rgba(0, 0, 0, 0.5)",title.style.borderRadius="7px",title.style.minWidth="unset",title.style.fontSize="1.75rem",void(title.style.lineHeight=title.style.fontSize);title.style.position="inherit",title.style.minWidth=`calc(${100*(1-e)}% - 20px)`,title.style.borderRadius=`${20*e+7}px`,title.style.fontSize=`${Math.min(3.75-2*(1-e),3.8)}rem`,title.style.lineHeight=title.style.fontSize,title.style.backgroundColor=`rgba(0, 0, 0, ${.5*(1-e)})`}function reCalcTotalHeight(){maxHeight=title.getBoundingClientRect().top+scrollY+15,reCalcTitleAnim()}function updateUsrInfo(e){q("#usrOps > h2").textContent=`Hello, ${e.displayName}`,q("#usrOps > img.profile-img").src=e.photoURL,$("usrName").textContent=`Name: ${e.displayName} `,$("usrEmail").textContent=`Email: ${e.email} `,$("verEmailMsg").style.display=e.emailVerified?"none":"block"}function showHideUserArea(){const e=$("usrOps");return cUser?(fUIAuthDiv.style.display="none",e.style.display="block",$("loginLoader").style.display="none",updateUsrInfo(cUser),!0):(fUIAuthDiv.style.display="block",e.style.display="none",$("loginLoader").style.display="block",loginSpinner.determinate=!1,!1)}function initFUI(){fUIAuthDiv.textContent="";const e={callbacks:{signInSuccessWithAuthResult:function(e,t){return showHideUserArea(),!1},uiShown:function(){setTimeout(()=>{document.getElementById("loginLoader").style.display="none",loginSpinner.determinate=!0,mdc.autoInit()},50)}},signInFlow:"popup",signInOptions:[firebase.auth.GoogleAuthProvider.PROVIDER_ID,firebase.auth.EmailAuthProvider.PROVIDER_ID],tosUrl:"#",privacyPolicyUrl:"#"};fUI.start(fUIAuthDiv,e)}function showAuthMsg(e){const t=$("authMsg"),i=q("#authMsg > div.mdc-card-wrapper__text-section");q("#authMsg button").onclick=(()=>t.classList.add("hidden")),i.textContent=e,t.classList.remove("hidden")}let fAuth=firebase.auth(),cUser=null;document.addEventListener("scroll",reCalcTitleAnim,{passive:!0}),window.onresize=reCalcTotalHeight,new IntersectionObserver(()=>{usrAcctBtn.classList.toggle("hidden-fab")},{threshold:0}).observe($("b")),usrAcctBtn.onclick=(()=>{loginDialog.isOpen?loginDialog.close():(showHideUserArea()||initFUI(),loginDialog.open())}),$("signOutBtn").onclick=(()=>{fAuth.signOut().then(()=>{initFUI()},e=>{showMsg("Error signing out. Please try again later."),console.error(e)})}),verifyEmailBtn.onclick=(e=>{verifyEmailBtn.disabled=!0,cUser.sendEmailVerification().then(function(){showMsg(`Sent a verification email to ${cUser.email}`),showAuthMsg("Reopen this dialog after clicking on the verification link to check your email verification status")}).catch(function(e){showMsg(`Failed to send the verification email. Error: ${e.message}`)})}),fAuth.onAuthStateChanged(function(e){e?(cUser=e,showMsg(`Signed in as ${e.displayName}`),window.history.replaceState({},document.title,window.location.pathname)):(showMsg("You are signed out"),"select"===new URLSearchParams(window.location.search).get("mode")&&(loginDialog.open(),initFUI()),cUser=null),showHideUserArea()});const elem=document.querySelector(".mason-cards");new Masonry(elem,{itemSelector:".mdc-card",fitWidth:!0,gutter:8}),reCalcTotalHeight(),reCalcTitleAnim(),fUI=new firebaseui.auth.AuthUI(firebase.auth());