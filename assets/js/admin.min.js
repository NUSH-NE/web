const spinner=$("editorLoading");spinner.MDCCircularProgress.determinate=!1;const storageRef=firebase.storage().ref(),fPickerElem=$("fileUpload"),db=firebase.firestore();let cUser=null;const fUIAuthDiv=$("firebaseui-auth-container"),loginSpinner=q("#loginDialog #loginLoader > div").MDCCircularProgress;let fUI;const loginDialog=$("loginDialog").MDCDialog;function showHideUserArea(){const e=$("usrOps");return cUser?(fUIAuthDiv.style.display="none",e.style.display="block",$("loginLoader").style.display="none",updateUsrInfo(cUser),!0):(fUIAuthDiv.style.display="block",e.style.display="none",$("loginLoader").style.display="block",loginSpinner.determinate=!1,!1)}function updateUsrInfo(e){q("#usrOps > h2").textContent=`Hello, ${e.displayName}`,q("#usrOps > img.profile-img").src=e.photoURL,$("usrName").textContent=`Name: ${e.displayName} `,$("usrEmail").textContent=`Email: ${e.email} `,$("verEmailMsg").style.display=e.emailVerified?"none":"block"}function initFUI(){fUIAuthDiv.textContent="";const e={callbacks:{signInSuccessWithAuthResult:function(e,t){return showHideUserArea(),!1},uiShown:function(){setTimeout(()=>{document.getElementById("loginLoader").style.display="none",loginSpinner.determinate=!0,mdc.autoInit()},50)}},signInFlow:"popup",signInOptions:[firebase.auth.GoogleAuthProvider.PROVIDER_ID,firebase.auth.EmailAuthProvider.PROVIDER_ID],tosUrl:"#",privacyPolicyUrl:"#"};fUI.start(fUIAuthDiv,e)}fUI=new firebaseui.auth.AuthUI(firebase.auth()),firebase.auth().onAuthStateChanged(function(e){e?showMsg("sin in"):(showMsg("STOPPP HACCERMAN STOPPPPP"),loginDialog.isOpen?loginDialog.close():(showHideUserArea()||initFUI(),loginDialog.open()))}),$("submitBtn").onclick=(()=>{tinyMCE.activeEditor.getContent();const e=storageRef.child(fPickerElem.files[0].name).put(fPickerElem.files[0]);e.on("state_changed",e=>{$("file-upload-progress").MDCLinearProgress.progress=e.bytesTransferred/e.totalBytes},e=>{console.error(e)},()=>{showMsg("Upload completed"),e.snapshot.ref.getDownloadURL().then(e=>{console.log("File available at",e);let t=$("resourceLink").value;db.collection("articles").add({content:tinyMCE.activeEditor.getContent(),link:e,resourceLink:t.split("\n").map(function(e){return e.trim()})}).then(e=>{console.log("Document written with ID: ",e.id)}).catch(e=>{console.error("Error adding document: ",e)})})})}),$("uploadBtn").onclick=(()=>{$("fileUpload").click()}),fPickerElem.onchange=(e=>{const t=new FileReader;t.onload=(e=>{$("testimg").src=e.target.result}),t.readAsDataURL($("fileUpload").files[0]),$("uploadFName").textContent=`Selected file(s): ${e.target.files[0].name}`}),tinymce.init({selector:"textarea#contentEditor",height:400,min_height:110,max_height:1e3,menubar:!1,plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount"],toolbar:"undo redo | formatselect | bold italic backcolor | alignleft aligncenter alignright alignjustify | bullist numlist outdent indent | removeformat | help",help_tabs:["shortcuts","keyboardnav"],skin:"oxide-dark",content_style:"body { font-family:Roboto,Helvetica,Arial,sans-serif; font-size:14px }",content_css:"dark"}).then(()=>{console.log("Loaded"),spinner.style.display="none",spinner.MDCCircularProgress.determinate=!0,document.querySelectorAll(".tox .tox-tbtn").forEach(e=>{e.classList.add("mdc-ripple-surface"),e.setAttribute("data-mdc-auto-init","MDCRipple")}),mdc.autoInit()});