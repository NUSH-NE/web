const articleTable=$("articlesTable"),db=firebase.firestore(),delBtn=$("delete-article"),editBtn=$("edit-article"),addRow=(e,a)=>{const t=(e.likes/(e.likes+e.dislikes)*100).toFixed(1),l=document.createElement("tr");l.setAttribute("data-row-id",a),l.classList.add("mdc-data-table__row"),l.innerHTML=`\n    <td class="mdc-data-table__cell mdc-data-table__cell--checkbox">\n        <div class="mdc-checkbox mdc-data-table__row-checkbox">\n            <input type="checkbox" class="mdc-checkbox__native-control" aria-labelledby="${a}"/>\n            <div class="mdc-checkbox__background">\n                <svg class="mdc-checkbox__checkmark" viewBox="0 0 24 24">\n                    <path class="mdc-checkbox__checkmark-path" fill="none" d="M1.73,12.91 8.1,19.28 22.79,4.59" />\n                </svg>\n                <div class="mdc-checkbox__mixedmark"></div>\n            </div>\n            <div class="mdc-checkbox__ripple"></div>\n        </div>\n    </td>\n    <th class="mdc-data-table__cell" scope="row" id="${a}">${e.title}</th>\n    <th class="mdc-data-table__cell" scope="row" id="${a}">${a}</th>\n    <th class="mdc-data-table__cell" scope="row" id="${a}">${e.likes}:${e.dislikes} (${t}%)</th>`,articleTable.querySelector("tbody").appendChild(l),articleTable.MDCDataTable.layout()};articleTable.MDCDataTable.showProgress(),articleTable.MDCDataTable.listen("MDCDataTable:rowSelectionChanged",()=>updateBtnState()),articleTable.MDCDataTable.listen("MDCDataTable:selectedAll",()=>updateBtnState()),articleTable.MDCDataTable.listen("MDCDataTable:unselectedAll",()=>updateBtnState());const updateBtnState=()=>{const e=articleTable.MDCDataTable.getSelectedRowIds();delBtn.disabled=0===e.length,editBtn.disabled=1!==e.length};delBtn.onclick=(()=>{$("del-dialog").MDCDialog.open()}),$("del-dialog").MDCDialog.listen("MDCDialog:closed",e=>{if("delete"===e.detail.action){articleTable.MDCDataTable.getSelectedRowIds().forEach(e=>{db.collection("articles").doc(e).delete().then(()=>{showMsg("Deleted article with ID "+e)}).catch(e=>{console.error("Error deleting article: ",e)})})}}),db.collection("articles").onSnapshot(e=>{articleTable.MDCDataTable.hideProgress(),e.docChanges().forEach(e=>{"added"===e.type?addRow({title:e.doc.data().title,likes:10,dislikes:2},e.doc.id):"modified"===e.type||"removed"===e.type&&(q(`[data-row-id="${e.doc.id}"]`).remove(),articleTable.MDCDataTable.layout())})}),updateBtnState();